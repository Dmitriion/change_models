<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>56 Моделей Управления Изменениями: От Классических к Современным (2025)</title>
    <style>
        :root {
  /* Primitive Color Tokens */
  --color-white: rgba(255, 255, 255, 1);
  --color-black: rgba(0, 0, 0, 1);
  --color-cream-50: rgba(252, 252, 249, 1);
  --color-cream-100: rgba(255, 255, 253, 1);
  --color-gray-200: rgba(245, 245, 245, 1);
  --color-gray-300: rgba(167, 169, 169, 1);
  --color-gray-400: rgba(119, 124, 124, 1);
  --color-slate-500: rgba(98, 108, 113, 1);
  --color-brown-600: rgba(94, 82, 64, 1);
  --color-charcoal-700: rgba(31, 33, 33, 1);
  --color-charcoal-800: rgba(38, 40, 40, 1);
  --color-slate-900: rgba(19, 52, 59, 1);
  --color-teal-300: rgba(50, 184, 198, 1);
  --color-teal-400: rgba(45, 166, 178, 1);
  --color-teal-500: rgba(33, 128, 141, 1);
  --color-teal-600: rgba(29, 116, 128, 1);
  --color-teal-700: rgba(26, 104, 115, 1);
  --color-teal-800: rgba(41, 150, 161, 1);
  --color-red-400: rgba(255, 84, 89, 1);
  --color-red-500: rgba(192, 21, 47, 1);
  --color-orange-400: rgba(230, 129, 97, 1);
  --color-orange-500: rgba(168, 75, 47, 1);

  --color-brown-600-rgb: 94, 82, 64;
  --color-teal-500-rgb: 33, 128, 141;
  --color-slate-900-rgb: 19, 52, 59;
  --color-slate-500-rgb: 98, 108, 113;
  --color-red-500-rgb: 192, 21, 47;
  --color-red-400-rgb: 255, 84, 89;
  --color-orange-500-rgb: 168, 75, 47;
  --color-orange-400-rgb: 230, 129, 97;

  --color-bg-1: rgba(59, 130, 246, 0.08);
  --color-bg-2: rgba(245, 158, 11, 0.08);
  --color-bg-3: rgba(34, 197, 94, 0.08);
  --color-bg-4: rgba(239, 68, 68, 0.08);
  --color-bg-5: rgba(147, 51, 234, 0.08);
  --color-bg-6: rgba(249, 115, 22, 0.08);
  --color-bg-7: rgba(236, 72, 153, 0.08);
  --color-bg-8: rgba(6, 182, 212, 0.08);

  --color-background: var(--color-cream-50);
  --color-surface: var(--color-cream-100);
  --color-text: var(--color-slate-900);
  --color-text-secondary: var(--color-slate-500);
  --color-primary: var(--color-teal-500);
  --color-primary-hover: var(--color-teal-600);
  --color-primary-active: var(--color-teal-700);
  --color-secondary: rgba(var(--color-brown-600-rgb), 0.12);
  --color-secondary-hover: rgba(var(--color-brown-600-rgb), 0.2);
  --color-secondary-active: rgba(var(--color-brown-600-rgb), 0.25);
  --color-border: rgba(var(--color-brown-600-rgb), 0.2);
  --color-btn-primary-text: var(--color-cream-50);
  --color-card-border: rgba(var(--color-brown-600-rgb), 0.12);
  --color-card-border-inner: rgba(var(--color-brown-600-rgb), 0.12);
  --color-error: var(--color-red-500);
  --color-success: var(--color-teal-500);
  --color-warning: var(--color-orange-500);
  --color-info: var(--color-slate-500);
  --color-focus-ring: rgba(var(--color-teal-500-rgb), 0.4);
  --color-select-caret: rgba(var(--color-slate-900-rgb), 0.8);

  --focus-ring: 0 0 0 3px var(--color-focus-ring);
  --focus-outline: 2px solid var(--color-primary);
  --status-bg-opacity: 0.15;
  --status-border-opacity: 0.25;

  --font-family-base: "FKGroteskNeue", "Geist", "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  --font-family-mono: "Berkeley Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
  --font-size-xs: 11px;
  --font-size-sm: 12px;
  --font-size-base: 14px;
  --font-size-md: 14px;
  --font-size-lg: 16px;
  --font-size-xl: 18px;
  --font-size-2xl: 20px;
  --font-size-3xl: 24px;
  --font-size-4xl: 30px;
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 550;
  --font-weight-bold: 600;
  --line-height-tight: 1.2;
  --line-height-normal: 1.5;
  --letter-spacing-tight: -0.01em;

  --space-0: 0;
  --space-1: 1px;
  --space-2: 2px;
  --space-4: 4px;
  --space-6: 6px;
  --space-8: 8px;
  --space-10: 10px;
  --space-12: 12px;
  --space-16: 16px;
  --space-20: 20px;
  --space-24: 24px;
  --space-32: 32px;

  --radius-sm: 6px;
  --radius-base: 8px;
  --radius-md: 10px;
  --radius-lg: 12px;
  --radius-full: 9999px;

  --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.02);
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.02);
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.04), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.04), 0 4px 6px -2px rgba(0, 0, 0, 0.02);
  --shadow-inset-sm: inset 0 1px 0 rgba(255, 255, 255, 0.15), inset 0 -1px 0 rgba(0, 0, 0, 0.03);

  --duration-fast: 150ms;
  --duration-normal: 250ms;
  --ease-standard: cubic-bezier(0.16, 1, 0.3, 1);

  --container-sm: 640px;
  --container-md: 768px;
  --container-lg: 1024px;
  --container-xl: 1280px;

  /* Адаптивные размеры */
  --responsive-padding: clamp(1rem, 4vw, 2rem);
  --responsive-padding-lg: clamp(1.5rem, 6vw, 3rem);
  --responsive-text-sm: clamp(0.75rem, 2vw, 0.875rem);
  --responsive-text-base: clamp(0.875rem, 2.5vw, 1rem);
  --responsive-text-lg: clamp(1rem, 3vw, 1.25rem);
  --responsive-text-xl: clamp(1.25rem, 4vw, 1.5rem);
  --responsive-text-2xl: clamp(1.5rem, 5vw, 2rem);
  --responsive-text-3xl: clamp(1.75rem, 6vw, 2.5rem);
  --responsive-text-4xl: clamp(2rem, 8vw, 3rem);
  --responsive-gap-sm: clamp(0.5rem, 2vw, 0.75rem);
  --responsive-gap-md: clamp(0.75rem, 3vw, 1rem);
  --responsive-gap-lg: clamp(1rem, 4vw, 1.5rem);

  /* Новые брейкпоинты */
  --breakpoint-xs: 480px;
  --breakpoint-sm: 640px;
  --breakpoint-md: 768px;
  --breakpoint-lg: 1024px;
  --breakpoint-xl: 1280px;

  /* Presentation specific colors */
  --pres-primary: #1e3a8a;
  --pres-secondary: #0d9488;
  --pres-accent: #f59e0b;
  --pres-bg-light: #f3f4f6;
  --pres-text: #1f2937;
  --pres-contextual: #3b82f6;
  --pres-highlevel: #0d9488;
  --pres-actionable: #10b981;
  --pres-supporting: #f59e0b;

  /* Адаптивные размеры */
  --responsive-padding: clamp(1rem, 4vw, 2rem);
  --responsive-padding-lg: clamp(1.5rem, 6vw, 3rem);
  --responsive-text-sm: clamp(0.75rem, 2vw, 0.875rem);
  --responsive-text-base: clamp(0.875rem, 2.5vw, 1rem);
  --responsive-text-lg: clamp(1rem, 3vw, 1.25rem);
  --responsive-text-xl: clamp(1.25rem, 4vw, 1.5rem);
  --responsive-text-2xl: clamp(1.5rem, 5vw, 2rem);
  --responsive-text-3xl: clamp(1.75rem, 6vw, 2.5rem);
  --responsive-text-4xl: clamp(2rem, 8vw, 3rem);
  --responsive-gap-sm: clamp(0.5rem, 2vw, 0.75rem);
  --responsive-gap-md: clamp(0.75rem, 3vw, 1rem);
  --responsive-gap-lg: clamp(1rem, 4vw, 1.5rem);

  /* Новые брейкпоинты */
  --breakpoint-xs: 480px;
  --breakpoint-sm: 640px;
  --breakpoint-md: 768px;
  --breakpoint-lg: 1024px;
  --breakpoint-xl: 1280px;
}

@media (prefers-color-scheme: dark) {
  body:not(.theme-light) {
    --color-gray-400-rgb: 119, 124, 124;
    --color-teal-300-rgb: 50, 184, 198;
    --color-gray-300-rgb: 167, 169, 169;
    --color-gray-200-rgb: 245, 245, 245;
    --color-bg-1: rgba(29, 78, 216, 0.15);
    --color-bg-2: rgba(180, 83, 9, 0.15);
    --color-bg-3: rgba(21, 128, 61, 0.15);
    --color-bg-4: rgba(185, 28, 28, 0.15);
    --color-bg-5: rgba(107, 33, 168, 0.15);
    --color-bg-6: rgba(194, 65, 12, 0.15);
    --color-bg-7: rgba(190, 24, 93, 0.15);
    --color-bg-8: rgba(8, 145, 178, 0.15);
    --color-background: var(--color-charcoal-700);
    --color-surface: var(--color-charcoal-800);
    --color-text: var(--color-gray-200);
    --color-text-secondary: rgba(var(--color-gray-300-rgb), 0.7);
    --color-primary: var(--color-teal-300);
    --color-primary-hover: var(--color-teal-400);
    --color-primary-active: var(--color-teal-800);
    --color-secondary: rgba(var(--color-gray-400-rgb), 0.15);
    --color-secondary-hover: rgba(var(--color-gray-400-rgb), 0.25);
    --color-secondary-active: rgba(var(--color-gray-400-rgb), 0.3);
    --color-border: rgba(var(--color-gray-400-rgb), 0.3);
    --color-error: var(--color-red-400);
    --color-success: var(--color-teal-300);
    --color-warning: var(--color-orange-400);
    --color-info: var(--color-gray-300);
    --color-focus-ring: rgba(var(--color-teal-300-rgb), 0.4);
    --color-btn-primary-text: var(--color-slate-900);
    --color-card-border: rgba(var(--color-gray-400-rgb), 0.2);
    --color-card-border-inner: rgba(var(--color-gray-400-rgb), 0.15);
    --shadow-inset-sm: inset 0 1px 0 rgba(255, 255, 255, 0.1), inset 0 -1px 0 rgba(0, 0, 0, 0.15);
    --color-select-caret: rgba(var(--color-gray-200-rgb), 0.8);
    --pres-text: #e5e7eb;
    --pres-bg-light: #374151;
  }
}

body.theme-dark {
  --color-gray-400-rgb: 119, 124, 124;
  --color-teal-300-rgb: 50, 184, 198;
  --color-gray-300-rgb: 167, 169, 169;
  --color-gray-200-rgb: 245, 245, 245;
  --color-bg-1: rgba(29, 78, 216, 0.15);
  --color-bg-2: rgba(180, 83, 9, 0.15);
  --color-bg-3: rgba(21, 128, 61, 0.15);
  --color-bg-4: rgba(185, 28, 28, 0.15);
  --color-bg-5: rgba(107, 33, 168, 0.15);
  --color-bg-6: rgba(194, 65, 12, 0.15);
  --color-bg-7: rgba(190, 24, 93, 0.15);
  --color-bg-8: rgba(8, 145, 178, 0.15);
  --color-background: var(--color-charcoal-700);
  --color-surface: var(--color-charcoal-800);
  --color-text: var(--color-gray-200);
  --color-text-secondary: rgba(var(--color-gray-300-rgb), 0.7);
  --color-primary: var(--color-teal-300);
  --color-primary-hover: var(--color-teal-400);
  --color-primary-active: var(--color-teal-800);
  --color-secondary: rgba(var(--color-gray-400-rgb), 0.15);
  --color-secondary-hover: rgba(var(--color-gray-400-rgb), 0.25);
  --color-secondary-active: rgba(var(--color-gray-400-rgb), 0.3);
  --color-border: rgba(var(--color-gray-400-rgb), 0.3);
  --color-error: var(--color-red-400);
  --color-success: var(--color-teal-300);
  --color-warning: var(--color-orange-400);
  --color-info: var(--color-gray-300);
  --color-focus-ring: rgba(var(--color-teal-300-rgb), 0.4);
  --color-btn-primary-text: var(--color-slate-900);
  --color-card-border: rgba(var(--color-gray-400-rgb), 0.2);
  --color-card-border-inner: rgba(var(--color-gray-400-rgb), 0.15);
  --shadow-inset-sm: inset 0 1px 0 rgba(255, 255, 255, 0.1), inset 0 -1px 0 rgba(0, 0, 0, 0.15);
  --color-select-caret: rgba(var(--color-gray-200-rgb), 0.8);
  --pres-text: #e5e7eb;
  --pres-bg-light: #374151;
}

body.theme-light {
  --color-gray-400-rgb: 119, 124, 124;
  --color-teal-300-rgb: 50, 184, 198;
  --color-gray-300-rgb: 167, 169, 169;
  --color-gray-200-rgb: 245, 245, 245;
  --color-bg-1: rgba(59, 130, 246, 0.08);
  --color-bg-2: rgba(245, 158, 11, 0.08);
  --color-bg-3: rgba(34, 197, 94, 0.08);
  --color-bg-4: rgba(239, 68, 68, 0.08);
  --color-bg-5: rgba(147, 51, 234, 0.08);
  --color-bg-6: rgba(249, 115, 22, 0.08);
  --color-bg-7: rgba(236, 72, 153, 0.08);
  --color-bg-8: rgba(6, 182, 212, 0.08);
  --color-background: var(--color-cream-50);
  --color-surface: var(--color-cream-100);
  --color-text: var(--color-slate-900);
  --color-text-secondary: var(--color-slate-500);
  --color-primary: var(--color-teal-500);
  --color-primary-hover: var(--color-teal-600);
  --color-primary-active: var(--color-teal-700);
  --color-secondary: rgba(var(--color-brown-600-rgb), 0.12);
  --color-secondary-hover: rgba(var(--color-brown-600-rgb), 0.2);
  --color-secondary-active: rgba(var(--color-brown-600-rgb), 0.25);
  --color-border: rgba(var(--color-brown-600-rgb), 0.2);
  --color-error: var(--color-red-500);
  --color-success: var(--color-teal-500);
  --color-warning: var(--color-orange-500);
  --color-info: var(--color-slate-500);
  --color-focus-ring: rgba(var(--color-teal-500-rgb), 0.4);
  --color-btn-primary-text: var(--color-cream-50);
  --color-card-border: rgba(var(--color-brown-600-rgb), 0.12);
  --color-card-border-inner: rgba(var(--color-brown-600-rgb), 0.12);
  --shadow-inset-sm: inset 0 1px 0 rgba(255, 255, 255, 0.15), inset 0 -1px 0 rgba(0, 0, 0, 0.03);
  --color-select-caret: rgba(var(--color-slate-900-rgb), 0.8);
  --pres-text: #1f2937;
  --pres-bg-light: #f3f4f6;
}

@font-face {
  font-family: 'FKGroteskNeue';
  src: url('https://r2cdn.perplexity.ai/fonts/FKGroteskNeue.woff2') format('woff2');
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: var(--font-family-base);
  background-color: var(--color-background);
  color: var(--color-text);
  overflow: hidden;
}

.presentation {
  width: 100vw;
  height: 100vh;
  display: flex;
  flex-direction: column;
}

.slide-container {
  flex: 1;
  overflow: hidden;
  position: relative;
  padding-bottom: 80px; /* Отступ для фиксированного тулбара */
}

.slide {
  display: none;
  width: 100%;
  height: 100%;
  padding: var(--responsive-padding);
  overflow-y: auto;
  opacity: 0;
  transform: translateY(24px);
  transition: opacity 0.45s var(--ease-standard), transform 0.6s var(--ease-standard);
}

.slide.active {
  display: block;
  opacity: 1;
  transform: translateY(0);
  animation: slideFadeIn 0.6s var(--ease-standard);
}

@media (max-width: 640px) {
  .slide {
    padding: clamp(0.75rem, 3vw, 1rem);
  }
}

@media (max-width: 480px) {
  .slide {
    padding: clamp(0.5rem, 2vw, 0.75rem);
  }
}

@keyframes slideFadeIn {
  from {
    opacity: 0;
    transform: translateY(32px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.slide-header {
  text-align: center;
  margin-bottom: var(--space-32);
}

.slide-title {
  font-size: var(--responsive-text-4xl);
  font-weight: var(--font-weight-bold);
  color: var(--pres-primary);
  margin-bottom: var(--space-16);
  line-height: var(--line-height-tight);
}

.slide-subtitle {
  font-size: var(--responsive-text-xl);
  color: var(--color-text-secondary);
  margin-bottom: var(--space-24);
}

@media (max-width: 480px) {
  .slide-title {
    font-size: clamp(1.5rem, 6vw, 2rem);
  }

  .slide-subtitle {
    font-size: clamp(1rem, 3vw, 1.25rem);
  }
}

.stats-box {
  background: var(--color-bg-1);
  padding: var(--space-24);
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-border);
  margin-top: var(--space-32);
}

.stats-box ul {
  list-style: none;
  font-size: var(--font-size-lg);
  line-height: 1.8;
}

.stats-box li::before {
  content: "•";
  color: var(--pres-secondary);
  font-weight: bold;
  margin-right: var(--space-8);
}

.grid-2 {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: var(--space-24);
}

.grid-3 {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--space-20);
}

.grid-4 {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: var(--space-16);
}

@media (max-width: 640px) {
  .grid-2, .grid-3, .grid-4 {
    grid-template-columns: 1fr;
    gap: var(--responsive-gap-md);
  }
}

@media (min-width: 641px) and (max-width: 1024px) {
  .grid-3, .grid-4 {
    grid-template-columns: repeat(2, 1fr);
    gap: var(--responsive-gap-lg);
  }
}

.card {
  position: relative;
  background: var(--color-surface);
  padding: var(--space-24);
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-card-border);
  box-shadow: var(--shadow-sm);
  transition: transform 0.35s var(--ease-standard), box-shadow 0.35s var(--ease-standard), border-color 0.35s var(--ease-standard);
  overflow: hidden;
}

.card::after {
  content: "";
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, rgba(var(--color-teal-500-rgb), 0.08), rgba(var(--color-brown-600-rgb), 0.08));
  opacity: 0;
  transition: opacity 0.35s var(--ease-standard);
  pointer-events: none;
}

.card:hover {
  transform: translateY(-8px);
  box-shadow: 0 24px 40px rgba(var(--color-slate-900-rgb), 0.12);
  border-color: rgba(var(--color-teal-500-rgb), 0.35);
}

.card:hover::after {
  opacity: 1;
}

.card h3 {
  font-size: var(--font-size-xl);
  margin-bottom: var(--space-12);
  color: var(--pres-primary);
}

.card p {
  font-size: var(--font-size-base);
  line-height: 1.6;
  color: var(--color-text-secondary);
}

@media (max-width: 640px) {
  .card {
    padding: var(--responsive-padding);
  }

  .card h3 {
    font-size: var(--responsive-text-lg);
    margin-bottom: var(--space-8);
  }

  .card p {
    font-size: var(--responsive-text-sm);
  }
}

@media (hover: none) and (pointer: coarse) {
  .card:hover {
    transform: none;
  }

  .card:active {
    transform: scale(0.98);
  }
}

/* Уважение настроек пользователя */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Упрощенные анимации на мобильных */
@media (max-width: 640px) {
  .slide.active {
    animation-duration: 0.3s;
  }

  .card,
  .toolbar-btn,
  .filter-btn {
    transition-duration: 0.15s;
  }
}

.type-badge {
  display: inline-flex;
  align-items: center;
  gap: var(--space-6);
  padding: var(--space-4) var(--space-12);
  border-radius: var(--radius-full);
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  margin-bottom: var(--space-12);
  color: #ffffff !important;
  transition: transform 0.3s var(--ease-standard), box-shadow 0.3s var(--ease-standard);
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
}

.type-badge:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 20px rgba(0, 0, 0, 0.12);
}

.type-contextual {
  background: linear-gradient(135deg, #60a5fa, #2563eb) !important;
  color: #ffffff !important;
}

.type-highlevel {
  background: linear-gradient(135deg, #34d399, #059669) !important;
  color: #ffffff !important;
}

.type-actionable {
  background: linear-gradient(135deg, #f472b6, #ec4899) !important;
  color: #ffffff !important;
}

.type-supporting {
  background: linear-gradient(135deg, #fbbf24, #f59e0b) !important;
  color: #ffffff !important;
}

/* Русские названия типов моделей */
.type-контекстная {
  background: linear-gradient(135deg, #60a5fa, #2563eb) !important;
  color: #ffffff !important;
}

.type-высокоуровневая {
  background: linear-gradient(135deg, #34d399, #059669) !important;
  color: #ffffff !important;
}

.type-действенная {
  background: linear-gradient(135deg, #f472b6, #ec4899) !important;
  color: #ffffff !important;
}

.type-вспомогательная {
  background: linear-gradient(135deg, #fbbf24, #f59e0b) !important;
  color: #ffffff !important;
}

.timeline {
  display: flex;
  flex-direction: column;
  gap: var(--space-16);
}

.timeline-item {
  display: flex;
  gap: var(--space-16);
  padding: var(--space-16);
  background: var(--color-surface);
  border-left: 4px solid var(--pres-secondary);
  border-radius: var(--radius-base);
}

.timeline-year {
  font-weight: var(--font-weight-bold);
  color: var(--pres-primary);
  min-width: 120px;
  font-size: var(--font-size-lg);
}

.timeline-content {
  flex: 1;
  font-size: var(--font-size-base);
  line-height: 1.6;
}

.interactive-timeline {
  display: grid;
  grid-template-columns: minmax(0, 1fr) minmax(0, 1.1fr);
  gap: var(--space-32);
  align-items: flex-start;
}

.timeline-track {
  position: relative;
  padding-left: var(--space-32);
  border-left: 2px dashed rgba(var(--color-teal-500-rgb), 0.35);
  display: flex;
  flex-direction: column;
  gap: var(--space-16);
}

.timeline-node {
  position: relative;
  padding: var(--space-16);
  border-radius: var(--radius-base);
  background: rgba(var(--color-teal-500-rgb), 0.08);
  border: 1px solid transparent;
  text-align: left;
  cursor: pointer;
  transition: transform 0.3s var(--ease-standard), box-shadow 0.3s var(--ease-standard), border-color 0.3s var(--ease-standard);
}

.timeline-node::before {
  content: "";
  position: absolute;
  left: -36px;
  top: 22px;
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: var(--color-primary);
  box-shadow: 0 0 0 6px rgba(var(--color-teal-500-rgb), 0.2);
  transition: transform 0.3s var(--ease-standard), box-shadow 0.3s var(--ease-standard);
}

.timeline-node:hover {
  transform: translateX(4px);
  box-shadow: 0 16px 28px rgba(var(--color-slate-900-rgb), 0.18);
  border-color: rgba(var(--color-teal-500-rgb), 0.4);
}

.timeline-node.active {
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
  border-color: rgba(var(--color-teal-500-rgb), 0.7);
  box-shadow: 0 20px 36px rgba(var(--color-teal-500-rgb), 0.28);
}

.timeline-node.active::before {
  transform: scale(1.15);
  box-shadow: 0 0 0 8px rgba(var(--color-teal-500-rgb), 0.3);
}

.timeline-period {
  display: block;
  font-weight: var(--font-weight-semibold);
  margin-bottom: var(--space-8);
  color: inherit;
}

.timeline-headline {
  font-size: var(--font-size-base);
  color: inherit;
}

.timeline-details-card {
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  padding: var(--space-24);
  box-shadow: var(--shadow-md);
}

.timeline-details-card ul {
  margin-top: var(--space-16);
  padding-left: var(--space-16);
  color: var(--color-text-secondary);
  display: flex;
  flex-direction: column;
  gap: var(--space-8);
}

.timeline-details-card li {
  line-height: 1.6;
}

.model-slide {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-32);
}

.model-info h4 {
  font-size: var(--font-size-lg);
  color: var(--pres-primary);
  margin-bottom: var(--space-8);
  margin-top: var(--space-16);
}

.model-info ul {
  list-style: none;
  margin-left: var(--space-16);
}

.model-info li {
  margin-bottom: var(--space-8);
  line-height: 1.6;
}

.model-info li::before {
  content: "→";
  color: var(--pres-secondary);
  margin-right: var(--space-8);
}

.best-for {
  background: var(--color-bg-3);
  padding: var(--space-16);
  border-radius: var(--radius-base);
  margin-top: var(--space-24);
  border: 1px solid var(--color-border);
}

.navigation {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 16px;
  background: var(--color-surface);
  border-top: 1px solid var(--color-border);
  animation: fadeInUp 0.6s var(--ease-standard);
  animation-delay: 0.15s;
  animation-fill-mode: both;
  gap: var(--space-8);
  flex-wrap: wrap;
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 100;
  box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.1);
  height: auto;
  max-height: 60px;
}

.nav-buttons {
  display: flex;
  gap: var(--space-12);
}

.btn {
  padding: 6px 12px;
  border: none;
  border-radius: var(--radius-base);
  font-size: 12px;
  font-weight: var(--font-weight-medium);
  cursor: pointer;
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
  transition: all var(--duration-fast) var(--ease-standard);
  box-shadow: 0 4px 12px rgba(var(--color-teal-500-rgb), 0.15);
  min-height: 32px;
  transform: translateY(0);
}

.btn:hover {
  background: var(--color-primary-hover);
  transform: translateY(-2px);
  box-shadow: 0 12px 24px rgba(var(--color-teal-500-rgb), 0.25);
}

.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.btn-secondary {
  background: var(--color-secondary);
  color: var(--color-text);
  box-shadow: 0 6px 16px rgba(var(--color-brown-600-rgb), 0.15);
}

.btn-secondary:hover {
  background: var(--color-secondary-hover);
  box-shadow: 0 12px 20px rgba(var(--color-brown-600-rgb), 0.12);
}

.slide-counter {
  font-size: 12px;
  font-weight: var(--font-weight-medium);
  color: var(--color-text-secondary);
}

.model-selector {
  padding: 4px 8px;
  border: 1px solid var(--color-border);
  border-radius: var(--radius-base);
  background: var(--color-surface);
  color: var(--color-text);
  font-size: 11px;
  cursor: pointer;
  min-height: 28px;
}

.path-selector {
  padding: 4px 8px;
  border: 1px solid var(--color-border);
  border-radius: var(--radius-base);
  background: var(--color-surface);
  color: var(--color-text);
  font-size: 10px;
  cursor: pointer;
  transition: border-color var(--duration-fast) var(--ease-standard), box-shadow var(--duration-fast) var(--ease-standard);
  min-height: 28px;
}

.path-selector:focus {
  outline: none;
  border-color: rgba(var(--color-teal-500-rgb), 0.6);
  box-shadow: 0 0 0 3px rgba(var(--color-teal-500-rgb), 0.2);
}

.path-meta {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.icon {
  width: 52px;
  height: 52px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, rgba(var(--color-teal-500-rgb), 0.18), rgba(var(--color-brown-600-rgb), 0.12));
  border-radius: var(--radius-lg);
  color: var(--color-primary);
  border: 1px solid rgba(var(--color-teal-500-rgb), 0.25);
  margin-bottom: var(--space-12);
  transition: transform 0.3s var(--ease-standard), box-shadow 0.3s var(--ease-standard);
}

.icon svg {
  width: 26px;
  height: 26px;
  fill: none;
}

.icon svg path,
.icon svg circle,
.icon svg line,
.icon svg polyline,
.icon svg rect {
  stroke: currentColor;
  stroke-width: 1.6;
  stroke-linecap: round;
  stroke-linejoin: round;
}

.card:hover .icon {
  transform: scale(1.05);
  box-shadow: 0 12px 20px rgba(var(--color-teal-500-rgb), 0.2);
}

.nav-center {
  display: flex;
  align-items: center;
  gap: var(--space-8);
  flex-wrap: wrap;
  justify-content: center;
  flex-shrink: 1;
  min-width: 0;
}

.nav-actions {
  display: flex;
  align-items: center;
  gap: var(--space-12);
  flex-wrap: wrap;
}

.toolbar-btn {
  padding: 4px 8px;
  border-radius: var(--radius-base);
  border: 1px solid transparent;
  background: var(--color-secondary);
  color: var(--color-text);
  font-size: 11px;
  font-weight: var(--font-weight-medium);
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(var(--color-brown-600-rgb), 0.12);
  transition: transform 0.2s var(--ease-standard), box-shadow 0.2s var(--ease-standard), background 0.2s var(--ease-standard), border-color 0.2s var(--ease-standard), color 0.2s var(--ease-standard);
  white-space: nowrap;
  min-height: 28px;
}

.toolbar-btn:hover {
  transform: translateY(-2px);
  background: rgba(var(--color-brown-600-rgb), 0.22);
  box-shadow: 0 12px 22px rgba(var(--color-brown-600-rgb), 0.2);
}

.toolbar-btn.active {
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
  border-color: rgba(var(--color-teal-500-rgb), 0.35);
  box-shadow: 0 16px 28px rgba(var(--color-teal-500-rgb), 0.25);
}

.nav-actions {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-16);
  align-items: flex-start;
  width: 100%;
}

.nav-actions-group {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-12);
  align-items: center;
  justify-content: flex-end;
  flex: 1 1 auto;
}

.search-container {
  position: relative;
  flex: 1 1 280px;
  min-width: 220px;
}

.search-container input {
  width: 100%;
  padding: var(--space-8) var(--space-12);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-base);
  font-size: var(--font-size-base);
  transition: border-color var(--duration-fast) var(--ease-standard), box-shadow var(--duration-fast) var(--ease-standard);
  background: var(--color-surface);
  color: var(--color-text);
}

.search-container input::placeholder {
  color: rgba(var(--color-slate-500-rgb), 0.7);
}

.search-container input:focus {
  outline: none;
  border-color: rgba(var(--color-teal-500-rgb), 0.6);
  box-shadow: 0 0 0 3px rgba(var(--color-teal-500-rgb), 0.2);
}

.search-results {
  position: absolute;
  top: calc(100% + 6px);
  left: 0;
  right: 0;
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  box-shadow: 0 24px 40px rgba(var(--color-slate-900-rgb), 0.16);
  list-style: none;
  margin: 0;
  padding: var(--space-8) 0;
  max-height: 280px;
  overflow-y: auto;
  display: none;
  z-index: 1600;
}

.search-results.active {
  display: block;
}

.search-result-item {
  padding: var(--space-8) var(--space-16);
  cursor: pointer;
  display: flex;
  flex-direction: column;
  gap: var(--space-4);
  font-size: var(--font-size-sm);
}

.search-result-item strong {
  color: var(--pres-primary);
  font-weight: var(--font-weight-semibold);
}

.search-result-item span {
  color: var(--color-text-secondary);
}

.search-result-item:hover,
.search-result-item.active {
  background: rgba(var(--color-teal-500-rgb), 0.12);
}

.linkedin-link {
  display: inline-flex;
  align-items: center;
  gap: var(--space-4);
  color: var(--color-primary);
  text-decoration: none;
  font-weight: var(--font-weight-medium);
  transition: color 0.2s ease;
}

.linkedin-link:hover {
  color: var(--color-primary-hover);
  text-decoration: underline;
}

.circular-progress {
  position: fixed;
  top: 18px;
  left: 20px;
  width: 72px;
  height: 72px;
  background: var(--color-surface);
  border-radius: 20px;
  box-shadow: 0 20px 40px rgba(var(--color-slate-900-rgb), 0.16);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1002;
}

.circular-progress svg {
  width: 60px;
  height: 60px;
  transform: rotate(-90deg);
}

.progress-track {
  stroke: rgba(var(--color-slate-900-rgb), 0.12);
  stroke-width: 5;
  fill: none;
}

.progress-circle {
  stroke: var(--color-primary);
  stroke-width: 5;
  fill: none;
  stroke-linecap: round;
  stroke-dasharray: 157;
  stroke-dashoffset: 157;
  transition: stroke-dashoffset 0.4s var(--ease-standard);
}

.progress-count {
  position: absolute;
  font-size: 12px;
  font-weight: var(--font-weight-semibold);
  color: var(--color-text);
}

.bookmark-panel,
.notes-panel,
.history-panel {
  position: fixed;
  right: 24px;
  width: 320px;
  max-width: calc(100vw - 48px);
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  box-shadow: 0 24px 48px rgba(var(--color-slate-900-rgb), 0.18);
  padding: var(--space-24);
  transform: translateY(20px);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s var(--ease-standard), transform 0.3s var(--ease-standard);
  z-index: 1500;
}

.bookmark-panel {
  top: 120px;
}

.notes-panel {
  bottom: 120px;
}

.history-panel {
  top: 200px;
}

.bookmark-panel.active,
.notes-panel.active,
.history-panel.active {
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;
}

.panel-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: var(--space-12);
  margin-bottom: var(--space-16);
}

.panel-header h4 {
  margin: 0;
  font-size: var(--font-size-lg);
  color: var(--pres-primary);
}

.panel-close {
  border: none;
  background: rgba(var(--color-slate-900-rgb), 0.05);
  color: var(--color-text);
  border-radius: var(--radius-full);
  width: 28px;
  height: 28px;
  cursor: pointer;
  font-size: 18px;
  line-height: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background 0.2s var(--ease-standard), transform 0.2s var(--ease-standard);
}

.panel-close:hover {
  background: rgba(var(--color-slate-900-rgb), 0.12);
  transform: scale(1.05);
}

.panel-button {
  padding: 8px 16px;
  border-radius: var(--radius-base);
  border: none;
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
  font-weight: var(--font-weight-medium);
  cursor: pointer;
  transition: transform 0.3s var(--ease-standard), box-shadow 0.3s var(--ease-standard), background 0.3s var(--ease-standard);
  box-shadow: 0 12px 24px rgba(var(--color-teal-500-rgb), 0.25);
}

.panel-button:hover {
  transform: translateY(-1px);
  box-shadow: 0 16px 28px rgba(var(--color-teal-500-rgb), 0.3);
  background: var(--color-primary-hover);
}

.panel-button.secondary {
  background: rgba(var(--color-slate-900-rgb), 0.06);
  color: var(--color-text);
  box-shadow: none;
  border: 1px solid var(--color-border);
}

.panel-button.secondary:hover {
  background: rgba(var(--color-slate-900-rgb), 0.12);
  box-shadow: none;
}

.bookmark-empty {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
  margin-bottom: var(--space-16);
}

.bookmark-list {
  list-style: none;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  gap: var(--space-12);
  max-height: 260px;
  overflow-y: auto;
}

.bookmark-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: var(--space-12);
  padding: var(--space-12);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-base);
  background: rgba(var(--color-brown-600-rgb), 0.05);
  transition: transform 0.3s var(--ease-standard), box-shadow 0.3s var(--ease-standard), border-color 0.3s var(--ease-standard);
  cursor: pointer;
}

.bookmark-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 22px rgba(var(--color-slate-900-rgb), 0.15);
  border-color: rgba(var(--color-teal-500-rgb), 0.35);
}

.bookmark-item.active {
  border-color: rgba(var(--color-teal-500-rgb), 0.45);
  background: rgba(var(--color-teal-500-rgb), 0.18);
  color: var(--color-btn-primary-text);
  box-shadow: 0 16px 30px rgba(var(--color-teal-500-rgb), 0.25);
}

.search-highlight {
  background: rgba(var(--color-teal-500-rgb), 0.35);
  color: inherit;
  padding: 0 2px;
  border-radius: var(--radius-sm);
}

@media (prefers-color-scheme: dark) {
  body:not(.theme-light) .search-highlight {
    background: rgba(var(--color-teal-300-rgb), 0.4);
  }
}

body.theme-dark .search-highlight {
  background: rgba(var(--color-teal-300-rgb), 0.4);
}

.history-empty {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
  margin-bottom: var(--space-16);
}

.history-list {
  list-style: none;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  gap: var(--space-12);
  max-height: 260px;
  overflow-y: auto;
}

.history-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: var(--space-12);
  padding: var(--space-12);
  border-radius: var(--radius-base);
  border: 1px solid var(--color-border);
  background: rgba(var(--color-brown-600-rgb), 0.05);
  cursor: pointer;
  transition: transform 0.25s var(--ease-standard), box-shadow 0.25s var(--ease-standard), border-color 0.25s var(--ease-standard);
}

.history-item:hover {
  transform: translateY(-2px);
  border-color: rgba(var(--color-teal-500-rgb), 0.4);
  box-shadow: 0 12px 20px rgba(var(--color-slate-900-rgb), 0.15);
}

.history-item.active {
  border-color: rgba(var(--color-teal-500-rgb), 0.45);
  background: rgba(var(--color-teal-500-rgb), 0.18);
}

.bookmark-item span {
  display: block;
  font-size: 13px;
}

.bookmark-item strong {
  font-size: var(--font-size-sm);
  color: var(--pres-primary);
}

.notes-panel textarea {
  width: 100%;
  min-height: 160px;
  border: 1px solid var(--color-border);
  border-radius: var(--radius-base);
  padding: var(--space-12);
  font-family: var(--font-family-base);
  font-size: var(--font-size-base);
  resize: vertical;
  background: rgba(var(--color-brown-600-rgb), 0.04);
  transition: border-color 0.3s var(--ease-standard), box-shadow 0.3s var(--ease-standard);
}

.notes-panel textarea:focus {
  outline: none;
  border-color: rgba(var(--color-teal-500-rgb), 0.5);
  box-shadow: 0 0 0 3px rgba(var(--color-teal-500-rgb), 0.2);
}

.notes-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: var(--space-12);
}

.notes-status {
  font-size: 12px;
  color: var(--color-text-secondary);
}

.notes-actions {
  display: flex;
  gap: var(--space-8);
}

.achievement-modal {
  position: fixed;
  inset: 0;
  background: rgba(var(--color-slate-900-rgb), 0.55);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--space-24);
  z-index: 2000;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s var(--ease-standard);
}

.achievement-modal.active {
  opacity: 1;
  pointer-events: auto;
}

.achievement-content {
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  padding: 36px 42px;
  text-align: center;
  box-shadow: 0 30px 60px rgba(var(--color-slate-900-rgb), 0.25);
  max-width: 420px;
  width: 100%;
  animation: popIn 0.4s var(--ease-standard);
}

.achievement-icon {
  font-size: 52px;
  margin-bottom: var(--space-16);
}

.achievement-content h3 {
  margin-bottom: var(--space-10);
  color: var(--pres-primary);
}

.achievement-content p {
  margin-bottom: var(--space-20);
  color: var(--color-text-secondary);
}

@keyframes popIn {
  0% {
    transform: scale(0.9);
    opacity: 0;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

.quiz-container {
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-md);
  padding: var(--space-24);
}

.quiz-header h3 {
  margin-bottom: var(--space-8);
  color: var(--pres-primary);
}

.quiz-header p {
  margin: 0;
  color: var(--color-text-secondary);
  font-size: var(--font-size-base);
}

.quiz-body {
  margin-top: var(--space-20);
  display: flex;
  flex-direction: column;
  gap: var(--space-16);
}

.quiz-step {
  display: flex;
  flex-direction: column;
  gap: var(--space-16);
}

.quiz-step-title {
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-semibold);
  color: var(--color-text);
}

.quiz-options {
  display: grid;
  gap: var(--space-12);
}

.quiz-option {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: var(--space-12);
  padding: var(--space-16);
  border-radius: var(--radius-base);
  border: 1px solid var(--color-border);
  background: rgba(var(--color-teal-500-rgb), 0.06);
  cursor: pointer;
  transition: transform 0.25s var(--ease-standard), box-shadow 0.25s var(--ease-standard), border-color 0.25s var(--ease-standard), background 0.25s var(--ease-standard);
}

.quiz-option:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 22px rgba(var(--color-teal-500-rgb), 0.2);
  border-color: rgba(var(--color-teal-500-rgb), 0.45);
}

.quiz-option strong {
  font-size: var(--font-size-base);
  color: var(--pres-primary);
}

.quiz-option span {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.quiz-option.selected {
  background: var(--color-primary);
  border-color: rgba(var(--color-teal-500-rgb), 0.8);
  color: var(--color-btn-primary-text);
  box-shadow: 0 16px 30px rgba(var(--color-teal-500-rgb), 0.35);
}

.quiz-progress {
  margin-top: var(--space-16);
  font-size: 13px;
  color: var(--color-text-secondary);
}

.quiz-result {
  margin-top: var(--space-24);
  background: rgba(var(--color-teal-500-rgb), 0.08);
  border-radius: var(--radius-lg);
  padding: var(--space-24);
  border: 1px solid rgba(var(--color-teal-500-rgb), 0.25);
  text-align: left;
}

.quiz-result h4 {
  margin-bottom: var(--space-12);
  color: var(--pres-primary);
}

.quiz-result p {
  margin-bottom: var(--space-16);
  color: var(--color-text-secondary);
}

.quiz-tags {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-8);
}

.quiz-tag {
  padding: 6px 12px;
  border-radius: var(--radius-full);
  background: rgba(var(--color-teal-500-rgb), 0.12);
  color: var(--pres-secondary);
  font-size: 12px;
  font-weight: var(--font-weight-medium);
}

.quiz-actions {
  margin-top: var(--space-20);
  display: flex;
  gap: var(--space-12);
  flex-wrap: wrap;
}

.quiz-actions .panel-button {
  background: var(--pres-primary);
  box-shadow: 0 16px 32px rgba(var(--color-slate-900-rgb), 0.2);
}


.chart-container {
  background: var(--color-surface);
  padding: var(--space-24);
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-border);
  margin: var(--space-24) 0;
}

.bubble-chart-wrapper {
  position: relative;
  min-height: 420px;
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-border);
  background: var(--color-surface);
  padding: var(--space-16);
}

.chart-legend {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-16);
  justify-content: center;
  margin-top: var(--space-16);
}

.chart-legend-item {
  display: flex;
  align-items: center;
  gap: var(--space-8);
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.chart-legend-swatch {
  width: 14px;
  height: 14px;
  border-radius: var(--radius-full);
  border: 1px solid transparent;
  display: inline-block;
}

.chart-hint {
  margin-top: var(--space-12);
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
  text-align: center;
}

.matrix-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: var(--space-16);
}

.matrix-table th,
.matrix-table td {
  padding: var(--space-12);
  text-align: left;
  border-bottom: 1px solid var(--color-border);
}

.matrix-table th {
  background: var(--color-bg-1);
  font-weight: var(--font-weight-semibold);
  color: var(--pres-primary);
}

.highlight-box {
  background: var(--color-bg-2);
  padding: var(--space-20);
  border-radius: var(--radius-lg);
  border-left: 4px solid var(--pres-accent);
  margin: var(--space-24) 0;
}

.cta-wrapper {
  display: flex;
  flex-direction: column;
  gap: var(--space-24);
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-border);
  padding: var(--space-24);
  box-shadow: var(--shadow-md);
}

.cta-header h3 {
  margin-bottom: var(--space-8);
  color: var(--pres-primary);
}

.cta-header p {
  margin: 0;
  color: var(--color-text-secondary);
}

.cta-metrics {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  gap: var(--space-16);
}

.cta-metric {
  padding: var(--space-16);
  border-radius: var(--radius-base);
  background: rgba(var(--color-teal-500-rgb), 0.08);
  border: 1px solid rgba(var(--color-teal-500-rgb), 0.25);
  text-align: center;
  box-shadow: var(--shadow-sm);
}

.cta-metric-value {
  display: block;
  font-size: 30px;
  font-weight: var(--font-weight-bold);
  color: var(--pres-primary);
}

.cta-metric-label {
  display: block;
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
  margin-top: var(--space-6);
}

.cta-quiz-status {
  margin: 0;
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.cta-actions {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-12);
}

.cta-actions .panel-button,
.cta-actions .panel-button.secondary {
  flex: 1;
  min-width: 200px;
  text-align: center;
}

.cta-next-steps h4 {
  margin-bottom: var(--space-12);
  color: var(--pres-primary);
}

.cta-next-steps ul {
  margin: 0;
  padding-left: var(--space-16);
  display: flex;
  flex-direction: column;
  gap: var(--space-8);
  color: var(--color-text-secondary);
}

.two-col {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-24);
}

.content-list {
  list-style: none;
}

.content-list li {
  padding: var(--space-12);
  margin-bottom: var(--space-8);
  background: var(--color-surface);
  border-radius: var(--radius-base);
  border: 1px solid var(--color-border);
}

/* Progress Bar */
.progress-bar-container {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: rgba(0, 0, 0, 0.1);
  z-index: 1001;
}

.progress-bar {
  height: 100%;
  background: var(--color-primary);
  transition: width 0.3s ease;
  width: 0%;
}

/* Fullscreen Button */
.fullscreen-btn {
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 1000;
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-base);
  padding: 8px 12px;
  cursor: pointer;
  font-size: 18px;
  transition: all 0.2s;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.fullscreen-btn:hover {
  background: var(--color-secondary);
  transform: scale(1.05);
}

/* Export PDF Button */
.export-btn {
  position: fixed;
  top: 20px;
  right: 80px;
  z-index: 1000;
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
  border: none;
  border-radius: var(--radius-base);
  padding: 8px 16px;
  cursor: pointer;
  font-size: 14px;
  font-weight: 500;
  transition: all 0.2s;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.export-btn:hover {
  background: var(--color-primary-hover);
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

/* Interactive Matrix */
.matrix-row {
  cursor: pointer;
  transition: all 0.2s;
}

.matrix-row:hover {
  background: var(--color-secondary);
  transform: translateX(4px);
}

.matrix-row td {
  padding: 12px !important;
}

/* ========== PCT Tool Styles ========== */
.pct-tool {
  padding: var(--space-16);
  max-width: 100%;
}

.pct-intro {
  background: rgba(var(--color-teal-500-rgb), 0.08);
  padding: var(--space-16);
  border-radius: 8px;
  margin-bottom: var(--space-24);
  line-height: 1.6;
}

.pct-intro p {
  margin: var(--space-8) 0;
}

.pct-progress {
  margin-bottom: var(--space-24);
}

.pct-progress #pctProgressText {
  display: block;
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
  margin-bottom: var(--space-8);
}

.pct-progress-bar {
  height: 8px;
  background: var(--color-gray-200);
  border-radius: 4px;
  overflow: hidden;
  margin-top: var(--space-8);
}

.pct-progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--color-teal-500), var(--color-teal-400));
  transition: width 0.3s ease;
  width: 0%;
}

.pct-tabs {
  display: flex;
  gap: var(--space-8);
  margin-bottom: var(--space-24);
  flex-wrap: wrap;
}

.pct-tab {
  flex: 1;
  min-width: 140px;
  padding: var(--space-12) var(--space-16);
  border: 2px solid var(--color-border);
  background: var(--color-surface);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
}

.pct-tab:hover {
  border-color: var(--color-primary);
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(var(--color-slate-900-rgb), 0.1);
}

.pct-tab.active {
  background: var(--color-primary);
  color: var(--color-white);
  border-color: var(--color-primary);
}

.pct-content {
  margin-bottom: var(--space-32);
}

.pct-category {
  animation: fadeIn 0.3s ease;
}

.pct-category h3 {
  margin-bottom: var(--space-12);
  color: var(--pres-primary);
}

.pct-category-desc {
  color: var(--color-text-muted);
  margin-bottom: var(--space-20);
  font-style: italic;
}

.pct-factors {
  display: flex;
  flex-direction: column;
  gap: var(--space-12);
}

.pct-factor {
  background: var(--color-surface);
  padding: var(--space-16);
  border-radius: 8px;
  margin-bottom: var(--space-12);
  border: 1px solid var(--color-border);
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

.pct-factor:hover {
  border-color: var(--color-primary);
  box-shadow: 0 2px 8px rgba(var(--color-slate-900-rgb), 0.08);
}

.pct-factor-text {
  margin-bottom: var(--space-12);
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
  line-height: 1.5;
}

.pct-rating {
  display: flex;
  gap: var(--space-16);
  flex-wrap: wrap;
}

.pct-rating label {
  display: flex;
  align-items: center;
  gap: var(--space-8);
  cursor: pointer;
  padding: var(--space-8) var(--space-16);
  border-radius: 6px;
  transition: background 0.2s ease;
  user-select: none;
}

.pct-rating label:hover {
  background: rgba(var(--color-teal-500-rgb), 0.08);
}

.pct-rating input[type="radio"] {
  width: 20px;
  height: 20px;
  cursor: pointer;
  accent-color: var(--color-primary);
}

.pct-rating input[type="radio"]:checked + span {
  font-weight: var(--font-weight-semibold);
}

.pct-results {
  margin-top: var(--space-32);
  padding: var(--space-24);
  background: var(--color-surface);
  border-radius: 12px;
  border: 2px solid var(--color-border);
}

.pct-results h3 {
  margin-bottom: var(--space-20);
  color: var(--pres-primary);
  text-align: center;
}

.pct-scores {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--space-16);
  margin-bottom: var(--space-24);
}

.pct-score-item {
  padding: var(--space-16);
  border-radius: 8px;
  text-align: center;
  border: 2px solid var(--color-border);
  transition: all 0.3s ease;
}

.pct-score-item.excellent {
  background: rgba(45, 182, 125, 0.1);
  border-color: #2DB67D;
}

.pct-score-item.moderate {
  background: rgba(244, 161, 0, 0.1);
  border-color: #F4A100;
}

.pct-score-item.risk {
  background: rgba(224, 30, 90, 0.1);
  border-color: #E01E5A;
}

.pct-score-label {
  display: block;
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  color: var(--color-text-muted);
  margin-bottom: var(--space-8);
}

.pct-score-value {
  display: block;
  font-size: var(--font-size-3xl);
  font-weight: var(--font-weight-bold);
  margin-top: var(--space-8);
  color: var(--color-text);
}

.pct-visualization {
  margin: var(--space-24) 0;
  min-height: 300px;
  display: flex;
  justify-content: center;
  align-items: center;
  background: rgba(var(--color-slate-900-rgb), 0.02);
  border-radius: 8px;
  padding: var(--space-24);
}

.pct-visualization svg {
  max-width: 100%;
  height: auto;
}

.pct-recommendations {
  margin-top: var(--space-24);
  padding: var(--space-16);
  background: rgba(var(--color-teal-500-rgb), 0.05);
  border-radius: 8px;
  border-left: 4px solid var(--color-primary);
}

.pct-recommendations h4 {
  margin-bottom: var(--space-12);
  color: var(--pres-primary);
}

.pct-recommendations ul {
  list-style: none;
  padding: 0;
}

.pct-recommendations li {
  padding: var(--space-8) 0;
  padding-left: var(--space-24);
  position: relative;
}

.pct-recommendations li::before {
  content: "→";
  position: absolute;
  left: 0;
  color: var(--color-primary);
  font-weight: bold;
}

.pct-actions {
  display: flex;
  gap: var(--space-16);
  margin-top: var(--space-24);
  justify-content: center;
  flex-wrap: wrap;
}

.pct-actions .panel-button.secondary {
  background: var(--color-border);
  color: var(--color-text);
}

.pct-actions .panel-button.secondary:hover {
  background: var(--color-gray-300);
}

/* ========== Quiz Tool Styles ========== */
.quiz-tool {
  max-width: 800px;
  margin: 0 auto;
}

.quiz-intro {
  margin-bottom: var(--space-24);
  padding: var(--space-20);
  background: rgba(var(--color-teal-500-rgb), 0.05);
  border-radius: 8px;
  border-left: 4px solid var(--color-primary);
}

.quiz-intro p {
  margin: 0;
  line-height: 1.6;
  color: var(--color-text);
}

.quiz-progress {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-24);
  padding: var(--space-16);
  background: var(--color-surface);
  border-radius: 8px;
  border: 1px solid var(--color-border);
}

.quiz-progress-bar {
  flex: 1;
  height: 8px;
  background: var(--color-gray-200);
  border-radius: 4px;
  margin: 0 var(--space-16);
  overflow: hidden;
}

.quiz-progress-fill {
  height: 100%;
  background: var(--color-primary);
  border-radius: 4px;
  width: 0%;
  transition: width 0.3s ease;
}

.quiz-progress-text {
  font-weight: var(--font-weight-medium);
  color: var(--color-text-secondary);
  min-width: 100px;
  text-align: right;
}

.quiz-question {
  margin-bottom: var(--space-24);
}

.question-content h3 {
  margin-bottom: var(--space-20);
  color: var(--color-text);
  line-height: 1.5;
  font-size: 18px;
  font-weight: var(--font-weight-semibold);
  text-align: left;
  padding-bottom: var(--space-12);
  border-bottom: 2px solid var(--color-primary);
  margin-top: 0;
}

.question-options {
  display: flex;
  flex-direction: column;
  gap: var(--space-16);
  margin-bottom: var(--space-24);
}

.option-item {
  display: flex;
  align-items: flex-start;
  gap: var(--space-16);
  padding: var(--space-20);
  border: 2px solid var(--color-border);
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
  background: var(--color-surface);
  margin-bottom: var(--space-8);
  min-height: 60px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
}

.option-item:hover {
  border-color: var(--color-primary);
  background: rgba(var(--color-teal-500-rgb), 0.02);
}

.option-number {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 28px;
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
  border-radius: 50%;
  font-weight: var(--font-weight-bold);
  font-size: 14px;
  margin-right: var(--space-12);
  flex-shrink: 0;
}

.option-item:has(input:checked) .option-number {
  background: var(--color-primary);
  transform: scale(1.1);
  box-shadow: 0 2px 8px rgba(var(--color-teal-500-rgb), 0.3);
}

.option-item input[type="radio"] {
  width: 20px;
  height: 20px;
  margin-top: 3px;
  cursor: pointer;
  accent-color: var(--color-primary);
  flex-shrink: 0;
}

.option-text {
  flex: 1;
  line-height: 1.6;
  color: var(--color-text);
  font-size: 15px;
  font-weight: var(--font-weight-normal);
}

.option-item {
  position: relative;
}

.option-item:has(input:checked) {
  border-color: var(--color-primary);
  background: rgba(var(--color-teal-500-rgb), 0.08);
  box-shadow: 0 4px 12px rgba(var(--color-teal-500-rgb), 0.15);
  transform: translateY(-2px);
}

/* Адаптивность для мобильных устройств */
@media (max-width: 768px) {
  .question-options {
    gap: var(--space-12);
  }

  .option-item {
    padding: var(--space-16);
    min-height: 50px;
    gap: var(--space-12);
    margin-bottom: var(--space-6);
  }

  .option-text {
    font-size: 14px;
    line-height: 1.5;
  }

  .option-item input[type="radio"] {
    width: 18px;
    height: 18px;
    margin-top: 2px;
  }
}

@media (max-width: 640px) {
  .pct-tool, .roi-calculator, .quiz-tool {
    padding: var(--responsive-padding);
  }

  /* PCT вкладки */
  .pct-tabs {
    flex-direction: column;
    gap: var(--space-8);
  }

  .pct-tab {
    width: 100%;
    padding: var(--space-12);
    font-size: 14px;
  }

  /* ROI инпуты */
  .roi-input-group input {
    min-height: 44px;
    font-size: 16px; /* Предотвращает зум на iOS */
  }

  /* Quiz опции */
  .option-item {
    padding: var(--space-12);
    min-height: 60px;
    font-size: 14px;
  }

  /* Результаты в виде карточек */
  .pct-results-table,
  .roi-results-table {
    display: none;
  }

  .pct-results-cards,
  .roi-results-cards {
    display: flex;
    flex-direction: column;
    gap: var(--space-12);
  }

  .result-card {
    background: rgba(var(--color-teal-500-rgb), 0.05);
    border: 1px solid var(--color-border);
    border-radius: 8px;
    padding: var(--space-16);
  }

  .result-card-header {
    display: flex;
    justify-content: space-between;
    margin-bottom: var(--space-8);
  }

  .result-card-title {
    font-weight: var(--font-weight-semibold);
    color: var(--color-text);
  }

  .result-card-value {
    font-size: var(--responsive-text-lg);
    color: var(--color-teal-700);
    font-weight: var(--font-weight-bold);
  }
}

/* Анимация появления вариантов */
.question-options {
  animation: fadeInUp 0.6s ease-out;
}

.question-options .option-item {
  animation: slideInRight 0.4s ease-out;
  animation-fill-mode: both;
}

.question-options .option-item:nth-child(1) { animation-delay: 0.1s; }
.question-options .option-item:nth-child(2) { animation-delay: 0.2s; }
.question-options .option-item:nth-child(3) { animation-delay: 0.3s; }
.question-options .option-item:nth-child(4) { animation-delay: 0.4s; }
.question-options .option-item:nth-child(5) { animation-delay: 0.5s; }

@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(30px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.quiz-navigation {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: var(--space-16);
}

.quiz-nav-btn {
  padding: 10px 20px;
  border-radius: 6px;
  font-weight: var(--font-weight-medium);
  cursor: pointer;
  transition: all 0.2s ease;
  min-width: 120px;
}

.quiz-nav-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.quiz-nav-btn:not(.secondary) {
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
  border: none;
}

.quiz-nav-btn:not(.secondary):hover:not(:disabled) {
  background: var(--color-primary-hover);
  transform: translateY(-1px);
}

.quiz-nav-btn.secondary {
  background: var(--color-surface);
  color: var(--color-text);
  border: 1px solid var(--color-border);
}

.quiz-nav-btn.secondary:hover {
  background: var(--color-gray-200);
}

.quiz-results {
  margin-top: var(--space-32);
}

.quiz-profile-card {
  background: rgba(var(--color-teal-500-rgb), 0.08);
  padding: var(--space-24);
  border-radius: 8px;
  border-left: 4px solid var(--color-primary);
  margin-bottom: var(--space-24);
}

.quiz-profile-card h4 {
  margin: 0 0 var(--space-8) 0;
  color: var(--color-primary);
  font-size: 18px;
}

.quiz-profile-card p {
  margin: 0;
  line-height: 1.6;
  color: var(--color-text);
}

.recommended-models {
  display: flex;
  flex-direction: column;
  gap: var(--space-12);
}

.model-recommendation {
  display: flex;
  align-items: flex-start;
  gap: var(--space-16);
  padding: var(--space-16);
  background: var(--color-surface);
  border-radius: 6px;
  border: 1px solid var(--color-border);
}

.model-number {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
  border-radius: 50%;
  font-weight: var(--font-weight-bold);
  font-size: 14px;
  flex-shrink: 0;
}

.model-info h5 {
  margin: 0 0 var(--space-4) 0;
  color: var(--color-text);
  font-size: 16px;
}

.model-info p {
  margin: 0;
  color: var(--color-text-secondary);
  font-size: 14px;
}

.quiz-actions {
  display: flex;
  gap: var(--space-12);
  margin-top: var(--space-24);
  flex-wrap: wrap;
}

/* ========== Action Plan Modal Styles ========== */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  padding: 20px;
}

.modal-content {
  background: white;
  border-radius: 12px;
  max-width: 900px;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
}

.action-plan-modal {
  width: 100%;
}

.modal-header {
  padding: 24px 32px;
  border-bottom: 1px solid #e0e0e0;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.modal-header h2 {
  margin: 0;
  color: #2DB67D;
}

.modal-close {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: #666;
  padding: 0;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.modal-close:hover {
  color: #333;
}

.modal-body {
  padding: 32px;
  max-height: 70vh;
  overflow-y: auto;
}

.modal-footer {
  padding: 24px 32px;
  border-top: 1px solid #e0e0e0;
  display: flex;
  justify-content: flex-end;
  gap: 16px;
}

.action-plan-section {
  margin-bottom: 32px;
}

.action-plan-section h3 {
  color: #2DB67D;
  margin-bottom: 16px;
  font-size: 18px;
}

.scores-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  margin: 20px 0;
}

.score-item {
  padding: 20px;
  border-radius: 8px;
  text-align: center;
  border: 2px solid;
}

.score-item.critical {
  background: rgba(224, 30, 90, 0.1);
  border-color: #E01E5A;
}

.score-item.warning {
  background: rgba(244, 161, 0, 0.1);
  border-color: #F4A100;
}

.score-item.good {
  background: rgba(45, 182, 125, 0.1);
  border-color: #2DB67D;
}

.score-label {
  font-weight: bold;
  margin-bottom: 8px;
  color: #333;
}

.score-value {
  font-size: 24px;
  font-weight: bold;
  color: #2DB67D;
  margin: 8px 0;
}

.score-status {
  font-size: 12px;
  color: #666;
}

.timeline-phase {
  margin: 24px 0;
}

.timeline-phase h4 {
  color: #F4A100;
  margin-bottom: 12px;
}

.phase-actions {
  margin-left: 20px;
}

.action-item {
  background: #f9f9f9;
  padding: 16px;
  margin: 12px 0;
  border-radius: 8px;
  border-left: 4px solid #2DB67D;
}

.action-item h5 {
  margin: 0 0 8px 0;
  color: #333;
}

.action-item p {
  margin: 8px 0;
  color: #666;
  line-height: 1.5;
}

.action-tools {
  font-size: 14px;
  color: #2DB67D;
  font-weight: 500;
}

.model-recommendation {
  background: #f0f8f0;
  padding: 16px;
  margin: 12px 0;
  border-radius: 8px;
  border-left: 4px solid #2DB67D;
}

.model-recommendation.high {
  border-left-color: #E01E5A;
  background: rgba(224, 30, 90, 0.05);
}

.model-name {
  font-weight: bold;
  color: #333;
  margin-bottom: 4px;
}

.model-reason {
  color: #666;
  font-size: 14px;
}

.checklist {
  margin: 20px 0;
}

.checklist-item {
  display: flex;
  align-items: flex-start;
  margin: 12px 0;
  cursor: pointer;
}

.checklist-item input[type="checkbox"] {
  display: none;
}

.checkmark {
  width: 20px;
  height: 20px;
  border: 2px solid #ddd;
  border-radius: 4px;
  margin-right: 12px;
  margin-top: 2px;
  position: relative;
  flex-shrink: 0;
}

.checklist-item input:checked + .checkmark {
  background: #2DB67D;
  border-color: #2DB67D;
}

.checklist-item input:checked + .checkmark::after {
  content: '✓';
  position: absolute;
  top: -2px;
  left: 2px;
  color: white;
  font-size: 14px;
  font-weight: bold;
}

.item-content {
  flex: 1;
}

.item-title {
  font-weight: 500;
  color: #333;
  margin-bottom: 4px;
}

.item-description {
  color: #666;
  font-size: 14px;
  line-height: 1.4;
  margin-bottom: 4px;
}

.item-phase {
  color: #F4A100;
  font-size: 12px;
  font-weight: 500;
}

.reminder {
  background: #fff3cd;
  border: 1px solid #f0c674;
  padding: 20px;
  border-radius: 8px;
  margin: 24px 0;
}

/* ========== ROI Calculator Styles ========== */
.roi-calculator {
  padding: var(--space-16);
  max-width: 100%;
}

.roi-intro {
  background: rgba(var(--color-teal-500-rgb), 0.08);
  padding: var(--space-16);
  border-radius: 8px;
  margin-bottom: var(--space-24);
  line-height: 1.6;
}

.roi-intro strong {
  color: var(--color-primary);
}

.roi-form h3 {
  color: var(--pres-primary);
  margin-bottom: var(--space-16);
  text-align: center;
}

.roi-inputs {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: var(--space-16);
  margin-bottom: var(--space-24);
}

.roi-input-group {
  display: flex;
  flex-direction: column;
}

.roi-input-group label {
  font-weight: var(--font-weight-medium);
  margin-bottom: var(--space-8);
  color: var(--color-text);
}

.roi-input-group input,
.roi-input-group select {
  padding: var(--space-12);
  border: 1px solid var(--color-border);
  border-radius: 6px;
  font-size: 16px;
  transition: border-color 0.2s ease;
}

.roi-input-group input:focus,
.roi-input-group select:focus {
  outline: none;
  border-color: var(--color-primary);
}

.roi-results {
  margin-top: var(--space-32);
  padding-top: var(--space-24);
  border-top: 2px solid var(--color-border);
}

.roi-results h3 {
  color: var(--pres-primary);
  margin-bottom: var(--space-24);
  text-align: center;
}

.roi-metrics {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--space-16);
  margin-bottom: var(--space-32);
}

.roi-metric {
  background: var(--color-surface);
  padding: var(--space-20);
  border-radius: 8px;
  text-align: center;
  border: 1px solid var(--color-border);
  transition: border-color 0.2s ease;
}

.roi-metric:hover {
  border-color: var(--color-primary);
}

.roi-metric-value {
  font-size: 28px;
  font-weight: var(--font-weight-bold);
  color: var(--color-primary);
  margin-bottom: var(--space-8);
  display: block;
}

.roi-metric-label {
  color: var(--color-text-muted);
  font-size: 14px;
}

.roi-comparison h4,
.roi-details h4,
.roi-recommendations h4 {
  color: var(--pres-primary);
  margin-bottom: var(--space-16);
  text-align: center;
}

.roi-chart-container {
  background: rgba(var(--color-slate-900-rgb), 0.02);
  border-radius: 8px;
  padding: var(--space-16);
  margin: var(--space-16) 0;
  max-width: 500px;
  margin-left: auto;
  margin-right: auto;
}

.roi-breakdown {
  background: var(--color-surface);
  border-radius: 8px;
  overflow: hidden;
  margin: var(--space-16) 0;
}

.roi-breakdown-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--space-12) var(--space-16);
  border-bottom: 1px solid var(--color-border);
}

.roi-breakdown-item:last-child {
  border-bottom: none;
}

.roi-breakdown-label {
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
}

.roi-breakdown-value {
  font-weight: var(--font-weight-bold);
  color: var(--color-primary);
}

.roi-recommendation {
  padding: var(--space-16);
  border-radius: 8px;
  margin: var(--space-16) 0;
  border-left: 4px solid;
}

.roi-recommendation.excellent {
  background: rgba(45, 182, 125, 0.1);
  border-left-color: #2DB67D;
}

.roi-recommendation.good {
  background: rgba(244, 161, 0, 0.1);
  border-left-color: #F4A100;
}

.roi-recommendation.moderate {
  background: rgba(255, 193, 7, 0.1);
  border-left-color: #FFC107;
}

.roi-recommendation.poor {
  background: rgba(224, 30, 90, 0.1);
  border-left-color: #E01E5A;
}

.roi-recommendation h5 {
  margin: 0 0 var(--space-8) 0;
  color: var(--color-text);
}

.roi-recommendation p {
  margin: 0;
  color: var(--color-text-muted);
  line-height: 1.5;
}

.roi-actions {
  display: flex;
  gap: var(--space-12);
  justify-content: center;
  margin-top: var(--space-24);
  flex-wrap: wrap;
}

/* ========== Readiness Assessment Styles ========== */
.readiness-assessment {
  padding: var(--space-16);
  max-width: 100%;
}

.readiness-intro {
  background: rgba(var(--color-teal-500-rgb), 0.08);
  padding: var(--space-16);
  border-radius: 8px;
  margin-bottom: var(--space-24);
  line-height: 1.6;
}

.readiness-intro strong {
  color: var(--color-primary);
}

.readiness-progress {
  margin-bottom: var(--space-24);
}

.readiness-progress-bar {
  width: 100%;
  height: 8px;
  background: var(--color-border);
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: var(--space-8);
}

.readiness-progress-fill {
  height: 100%;
  background: var(--color-primary);
  border-radius: 4px;
  transition: width 0.3s ease;
}

.readiness-progress-text {
  text-align: center;
  font-size: 14px;
  color: var(--color-text-muted);
}

.readiness-question {
  background: var(--color-surface);
  padding: var(--space-24);
  border-radius: 8px;
  border: 1px solid var(--color-border);
}

.readiness-category {
  display: inline-block;
  background: var(--color-primary);
  color: white;
  padding: 4px 12px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: var(--font-weight-medium);
  margin-bottom: var(--space-16);
}

.readiness-question-text {
  margin: 0 0 var(--space-24) 0;
  color: var(--color-text);
  line-height: 1.6;
  font-size: 16px;
  font-weight: var(--font-weight-medium);
}

.readiness-scale {
  margin-bottom: var(--space-32);
}

.readiness-scale-labels {
  display: flex;
  justify-content: space-between;
  margin-bottom: var(--space-12);
  font-size: 13px;
  color: var(--color-text-muted);
  text-align: center;
}

.readiness-scale-labels span {
  flex: 1;
}

.readiness-scale-inputs {
  display: flex;
  justify-content: space-between;
  gap: var(--space-16);
  padding: 0 var(--space-8);
}

.readiness-option {
  display: flex;
  flex-direction: column;
  align-items: center;
  cursor: pointer;
  transition: transform 0.2s ease;
}

.readiness-option:hover {
  transform: translateY(-2px);
}

.readiness-radio:hover {
  border-color: var(--color-primary);
  transform: scale(1.05);
}

.readiness-radio {
  width: 48px;
  height: 48px;
  border: 2px solid var(--color-border);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: var(--font-weight-medium);
  font-size: 16px;
  transition: all 0.2s ease;
  margin-bottom: var(--space-12);
  cursor: pointer;
}

.readiness-option input:checked + .readiness-radio {
  background: var(--color-primary);
  border-color: var(--color-primary);
  color: white;
}

.readiness-navigation {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.readiness-results h3 {
  color: var(--pres-primary);
  margin-bottom: var(--space-24);
  text-align: center;
}

.readiness-overall {
  background: var(--color-surface);
  padding: var(--space-24);
  border-radius: 8px;
  text-align: center;
  margin-bottom: var(--space-32);
  border: 1px solid var(--color-border);
}

.readiness-overall-score {
  font-size: 36px;
  font-weight: var(--font-weight-bold);
  color: var(--color-primary);
  margin-bottom: var(--space-8);
  display: block;
}

.readiness-overall-level {
  font-size: 20px;
  font-weight: var(--font-weight-semibold);
  color: var(--color-text);
  margin-bottom: var(--space-12);
}

.readiness-overall-description {
  color: var(--color-text-muted);
  line-height: 1.5;
}

.readiness-radar-container h4 {
  color: var(--pres-primary);
  margin-bottom: var(--space-16);
  text-align: center;
}

.readiness-details h4,
.readiness-recommendations h4 {
  color: var(--pres-primary);
  margin-bottom: var(--space-16);
  text-align: center;
}

.readiness-categories {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--space-16);
  margin-bottom: var(--space-24);
}

.readiness-category-result {
  background: var(--color-surface);
  padding: var(--space-16);
  border-radius: 8px;
  border: 1px solid var(--color-border);
}

.readiness-category-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--space-12);
}

.readiness-category-name {
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
}

.readiness-category-score {
  font-weight: var(--font-weight-bold);
  color: var(--color-primary);
}

.readiness-category-bar {
  width: 100%;
  height: 8px;
  background: var(--color-border);
  border-radius: 4px;
  overflow: hidden;
}

.readiness-category-fill {
  height: 100%;
  background: var(--color-primary);
  border-radius: 4px;
  transition: width 0.5s ease;
}

.readiness-recommendation {
  background: #f0f8f0;
  padding: var(--space-16);
  border-radius: 8px;
  margin-bottom: var(--space-16);
  border-left: 4px solid #2DB67D;
}

.readiness-recommendation.high {
  background: rgba(224, 30, 90, 0.05);
  border-left-color: #E01E5A;
}

.readiness-recommendation h5 {
  margin: 0 0 var(--space-12) 0;
  color: var(--color-text);
}

.readiness-recommendation ul {
  margin: 0;
  padding-left: var(--space-20);
}

.readiness-recommendation li {
  color: var(--color-text-muted);
  margin-bottom: var(--space-4);
  line-height: 1.4;
}

.readiness-recommendation li:last-child {
  margin-bottom: 0;
}

.readiness-actions {
  display: flex;
  gap: var(--space-12);
  justify-content: center;
  margin-top: var(--space-24);
  flex-wrap: wrap;
}

/* ========== Enhanced Readiness Recommendations Styles ========== */

.readiness-recommendation-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--space-12);
  flex-wrap: wrap;
  gap: var(--space-8);
}

.readiness-recommendation-meta {
  display: flex;
  gap: var(--space-8);
  flex-wrap: wrap;
}

.readiness-urgency-badge {
  padding: 2px 8px;
  border-radius: 12px;
  font-size: 10px;
  font-weight: var(--font-weight-medium);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.readiness-urgency-badge.critical {
  background: #DC2626;
  color: white;
}

.readiness-urgency-badge.high {
  background: #EA580C;
  color: white;
}

.readiness-urgency-badge.medium {
  background: #CA8A04;
  color: white;
}

.readiness-urgency-badge.low {
  background: #16A34A;
  color: white;
}

.readiness-complexity-icon,
.readiness-impact-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  font-size: 12px;
}

.readiness-complexity-icon.easy {
  background: #DCFCE7;
  color: #16A34A;
}

.readiness-complexity-icon.medium {
  background: #FEF3C7;
  color: #CA8A04;
}

.readiness-complexity-icon.hard {
  background: #FEE2E2;
  color: #DC2626;
}

.readiness-impact-icon.high {
  background: #DBEAFE;
  color: #2563EB;
}

.readiness-impact-icon.medium {
  background: #F3E8FF;
  color: #7C3AED;
}

.readiness-impact-icon.low {
  background: #F1F5F9;
  color: #64748B;
}

.readiness-timeframe {
  background: #F8FAFC;
  padding: 4px 8px;
  border-radius: 6px;
  font-size: 11px;
  color: #475569;
  border: 1px solid #E2E8F0;
}

.readiness-recommendation-content {
  margin-top: var(--space-16);
}

.readiness-recommendation-actions {
  margin-top: var(--space-16);
}

.readiness-recommendation-actions h6 {
  margin: 0 0 var(--space-8) 0;
  font-size: 14px;
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
}

.readiness-recommendation-actions ul {
  margin: 0;
  padding-left: var(--space-16);
}

.readiness-recommendation-actions li {
  margin-bottom: var(--space-6);
  line-height: 1.4;
  color: var(--color-text-muted);
  position: relative;
}

.readiness-recommendation-actions li:before {
  content: "•";
  color: var(--color-primary);
  font-weight: bold;
  position: absolute;
  left: -12px;
}

/* Updated recommendation priority colors */
.readiness-recommendation.critical {
  background: rgba(220, 38, 38, 0.05);
  border-left-color: #DC2626;
}

.readiness-recommendation.high {
  background: rgba(234, 88, 12, 0.05);
  border-left-color: #EA580C;
}

.readiness-recommendation.medium {
  background: rgba(202, 138, 4, 0.05);
  border-left-color: #CA8A04;
}

.readiness-recommendation.low {
  background: rgba(22, 163, 74, 0.05);
  border-left-color: #16A34A;
}

/* ========== Hero Intro Slide Styles ========== */

.hero-intro-slide {
  display: flex;
  flex-direction: column;
  gap: var(--space-32);
  max-width: 1000px;
  margin: 0 auto;
  padding: 0 var(--space-16);
}

.hero-hook {
  background: rgba(239, 68, 68, 0.05);
  padding: var(--space-24);
  border-radius: 12px;
  border-left: 4px solid #DC2626;
  text-align: center;
}

.hero-hook .hook-question {
  font-size: 28px;
  font-weight: var(--font-weight-bold);
  color: #DC2626;
  margin-bottom: var(--space-20);
  line-height: 1.2;
}

.hero-hook .hook-problems {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: var(--space-16);
}

.hero-hook .problem-item {
  background: white;
  padding: var(--space-16);
  border-radius: 8px;
  display: flex;
  align-items: center;
  gap: var(--space-12);
  box-shadow: var(--shadow-sm);
  transition: transform 0.3s ease;
}

.hero-hook .problem-item:hover {
  transform: translateY(-2px);
}

.hero-hook .problem-item .problem-icon {
  font-size: 32px;
  flex-shrink: 0;
}

.hero-hook .problem-item p {
  margin: 0;
  font-style: italic;
  color: var(--color-text-secondary);
  text-align: left;
}

.hero-value {
  background: rgba(34, 197, 94, 0.05);
  padding: var(--space-24);
  border-radius: 12px;
  border-left: 4px solid #22C55E;
  text-align: center;
}

.hero-value h2 {
  font-size: 24px;
  color: #16A34A;
  margin-bottom: var(--space-20);
}

.hero-value .value-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: var(--space-20);
}

.hero-value .value-card {
  background: white;
  padding: var(--space-20);
  border-radius: 8px;
  text-align: center;
  box-shadow: var(--shadow-sm);
  transition: transform 0.3s ease;
}

.hero-value .value-card:hover {
  transform: translateY(-2px);
}

.hero-value .value-card .card-icon {
  font-size: 40px;
  display: block;
  margin-bottom: var(--space-12);
}

.hero-value .value-card h3 {
  margin: 0 0 var(--space-8) 0;
  font-size: 18px;
  color: var(--color-text);
  font-weight: var(--font-weight-semibold);
}

.hero-value .value-card p {
  margin: 0;
  font-size: 14px;
  color: var(--color-text-secondary);
}

.hero-proof {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--space-16);
}

.hero-proof .stat-card-hero {
  background: var(--color-surface);
  padding: var(--space-20);
  border-radius: 8px;
  text-align: center;
  border: 2px solid var(--color-border);
  box-shadow: var(--shadow-sm);
  transition: transform 0.3s ease;
}

.hero-proof .stat-card-hero:hover {
  transform: translateY(-2px);
}

.hero-proof .stat-card-hero.highlight {
  background: var(--color-primary);
  color: white;
  border-color: var(--color-primary);
  box-shadow: 0 4px 12px rgba(33, 128, 141, 0.3);
}

.hero-proof .stat-card-hero .stat-number {
  display: block;
  font-size: 36px;
  font-weight: var(--font-weight-bold);
  color: var(--color-primary);
  margin-bottom: var(--space-8);
}

.hero-proof .stat-card-hero.highlight .stat-number {
  color: white;
}

.hero-proof .stat-card-hero p {
  margin: 0;
  font-size: 14px;
  line-height: 1.4;
}

.hero-proof .stat-card-hero.highlight p {
  color: rgba(255, 255, 255, 0.9);
}

.hero-cta-section {
  text-align: center;
  padding: var(--space-24) 0;
}

.hero-cta-section .cta-primary-hero {
  background: var(--color-primary);
  color: white;
  border: none;
  padding: 16px 48px;
  font-size: 20px;
  font-weight: var(--font-weight-bold);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(33, 128, 141, 0.3);
  display: block;
  margin: 0 auto var(--space-16) auto;
  max-width: 300px;
}

.hero-cta-section .cta-primary-hero:hover {
  background: var(--color-primary-hover);
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(33, 128, 141, 0.4);
}

.hero-cta-section .cta-secondary-hero {
  background: rgba(59, 130, 246, 0.1);
  color: #3B82F6;
  border: 2px solid #3B82F6;
  padding: 12px 32px;
  font-size: 16px;
  font-weight: var(--font-weight-medium);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  display: block;
  margin: 0 auto;
  max-width: 250px;
}

.hero-cta-section .cta-secondary-hero:hover {
  background: rgba(59, 130, 246, 0.2);
  transform: translateY(-2px);
}

.hero-cta-section .cta-hint-text {
  margin-top: var(--space-12);
  font-size: 14px;
  color: var(--color-text-secondary);
}

/* Mobile adaptations for hero slide */
@media (max-width: 768px) {
  .hero-intro-slide {
    gap: var(--space-24);
    padding: 0 var(--space-8);
  }

  .hero-hook .hook-question {
    font-size: 24px;
  }

  .hero-hook .hook-problems {
    grid-template-columns: 1fr;
  }

  .hero-value .value-cards {
    grid-template-columns: 1fr;
  }

  .hero-proof {
    grid-template-columns: 1fr;
  }

  .hero-cta-section .cta-primary-hero,
  .hero-cta-section .cta-secondary-hero {
    width: 100%;
    max-width: none;
  }
}

/* ========== Hybrid Model Constructor Styles ========== */
.hybrid-constructor {
  padding: var(--space-16);
  max-width: 100%;
}

.hybrid-intro {
  background: rgba(var(--color-teal-500-rgb), 0.08);
  padding: var(--space-16);
  border-radius: 8px;
  margin-bottom: var(--space-24);
  line-height: 1.6;
}

.hybrid-intro strong {
  color: var(--color-primary);
}

.hybrid-step {
  margin-bottom: var(--space-32);
}

.hybrid-step h3 {
  color: var(--pres-primary);
  margin-bottom: var(--space-16);
  text-align: center;
}

.hybrid-base-models {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: var(--space-16);
}

.hybrid-base-model {
  background: var(--color-surface);
  padding: var(--space-20);
  border-radius: 8px;
  border: 2px solid transparent;
  cursor: pointer;
  transition: all 0.2s ease;
}

.hybrid-base-model:hover {
  border-color: var(--color-primary);
  transform: translateY(-2px);
}

.hybrid-base-model.selected {
  border-color: var(--color-primary);
  background: rgba(var(--color-teal-500-rgb), 0.05);
}

.hybrid-model-header {
  display: flex;
  align-items: center;
  margin-bottom: var(--space-12);
}

.hybrid-model-icon {
  font-size: 24px;
  margin-right: var(--space-12);
}

.hybrid-model-header h4 {
  margin: 0;
  color: var(--color-text);
}

.hybrid-model-description {
  color: var(--color-text-muted);
  margin-bottom: var(--space-12);
  line-height: 1.5;
}

.hybrid-model-elements {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-8);
  margin-bottom: var(--space-12);
}

.hybrid-element-tag {
  background: rgba(var(--color-primary-rgb), 0.1);
  color: var(--color-primary);
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: var(--font-weight-medium);
}

.hybrid-model-pros {
  font-size: 14px;
  color: var(--color-text-muted);
  line-height: 1.4;
}

.hybrid-selected-base {
  background: rgba(var(--color-teal-500-rgb), 0.1);
  padding: var(--space-16);
  border-radius: 8px;
  margin-bottom: var(--space-24);
  border-left: 4px solid var(--color-primary);
}

.hybrid-selected-base h4 {
  color: var(--color-primary);
  margin: 0 0 var(--space-8) 0;
}

.hybrid-elements-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: var(--space-16);
}

.hybrid-element-option {
  display: block;
  cursor: pointer;
}

.hybrid-element-card {
  display: block;
  background: var(--color-surface);
  padding: var(--space-16);
  border-radius: 8px;
  border: 2px solid transparent;
  transition: all 0.2s ease;
  margin-bottom: var(--space-8);
}

.hybrid-element-option input:checked + .hybrid-element-card {
  border-color: var(--color-primary);
  background: rgba(var(--color-teal-500-rgb), 0.05);
}

.hybrid-element-card h5 {
  margin: 0 0 var(--space-8) 0;
  color: var(--color-text);
}

.hybrid-element-card p {
  margin: 0 0 var(--space-8) 0;
  color: var(--color-text-muted);
  font-size: 14px;
  line-height: 1.4;
}

.hybrid-element-source {
  color: var(--color-primary);
  font-size: 12px;
  font-weight: var(--font-weight-medium);
}

.hybrid-navigation {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: var(--space-32);
}

.hybrid-preview-header {
  margin-bottom: var(--space-24);
}

.hybrid-preview-header h4 {
  color: var(--pres-primary);
  margin-bottom: var(--space-16);
  text-align: center;
}

.hybrid-model-summary {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--space-16);
  margin-bottom: var(--space-24);
}

.hybrid-summary-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: var(--color-surface);
  padding: var(--space-12);
  border-radius: 6px;
  border: 1px solid var(--color-border);
}

.hybrid-summary-label {
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
}

.hybrid-summary-value {
  font-weight: var(--font-weight-bold);
  color: var(--color-primary);
}

.hybrid-model-visualization {
  background: rgba(var(--color-slate-900-rgb), 0.02);
  border-radius: 8px;
  padding: var(--space-16);
  margin: var(--space-24) 0;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 300px;
}

.hybrid-model-composition {
  background: var(--color-surface);
  padding: var(--space-20);
  border-radius: 8px;
  border: 1px solid var(--color-border);
}

.hybrid-model-composition h5 {
  color: var(--pres-primary);
  margin-bottom: var(--space-16);
}

.hybrid-composition-base,
.hybrid-composition-added {
  margin-bottom: var(--space-16);
}

.hybrid-composition-base ul,
.hybrid-composition-added ul {
  margin: var(--space-8) 0 0 0;
  padding-left: var(--space-20);
}

.hybrid-composition-base li,
.hybrid-composition-added li {
  color: var(--color-text-muted);
  margin-bottom: var(--space-4);
  line-height: 1.4;
}

.hybrid-plan h5 {
  color: var(--pres-primary);
  margin-bottom: var(--space-20);
  text-align: center;
}

.hybrid-plan-phases {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: var(--space-16);
  margin-bottom: var(--space-24);
}

.hybrid-plan-phase {
  background: #fff3cd;
  padding: var(--space-16);
  border-radius: 8px;
  border: 1px solid #f0c674;
}

.hybrid-plan-phase h6 {
  color: #F4A100;
  margin: 0 0 var(--space-12) 0;
  font-size: 16px;
}

.hybrid-plan-phase ul {
  margin: 0;
  padding-left: var(--space-16);
}

.hybrid-plan-phase li {
  color: var(--color-text);
  margin-bottom: var(--space-6);
  line-height: 1.4;
}

.hybrid-plan-notes {
  background: rgba(var(--color-slate-900-rgb), 0.05);
  padding: var(--space-16);
  border-radius: 8px;
  border-left: 4px solid var(--color-primary);
}

.hybrid-plan-notes h6 {
  color: var(--pres-primary);
  margin: 0 0 var(--space-12) 0;
}

.hybrid-plan-notes ul {
  margin: 0;
  padding-left: var(--space-20);
}

.hybrid-plan-notes li {
  color: var(--color-text-muted);
  margin-bottom: var(--space-6);
  line-height: 1.4;
}

.hybrid-actions {
  display: flex;
  gap: var(--space-12);
  justify-content: center;
  margin-top: var(--space-24);
  flex-wrap: wrap;
}

/* ========== Model Slide Styles ========== */

.model-slide {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-24);
  margin-bottom: var(--space-24);
}

.model-info {
  background: var(--color-surface);
  padding: var(--space-20);
  border-radius: 8px;
  border: 1px solid var(--color-border);
}

.model-navigation {
  margin-top: var(--space-24);
  text-align: center;
}

/* ========== Model Selector Tool Styles ========== */

.model-selector-tool {
  padding: var(--space-16);
  max-width: 100%;
  margin: 0 auto;
}

.selector-mode-tabs {
  display: flex;
  justify-content: center;
  margin-bottom: var(--space-24);
  border-bottom: 1px solid var(--color-border);
  background: var(--color-surface);
  border-radius: 12px 12px 0 0;
  overflow: hidden;
}

.mode-tab {
  flex: 1;
  padding: var(--space-12) var(--space-16);
  border: none;
  background: transparent;
  color: var(--color-text-secondary);
  font-weight: var(--font-weight-medium);
  cursor: pointer;
  transition: all 0.3s ease;
  border-bottom: 3px solid transparent;
  position: relative;
}

.mode-tab:hover {
  background: rgba(var(--color-teal-500-rgb), 0.05);
  color: var(--color-teal-600);
}

.mode-tab.active {
  background: var(--color-teal-50);
  color: var(--color-teal-700);
  border-bottom-color: var(--color-teal-500);
  font-weight: var(--font-weight-semibold);
  transform: translateY(-1px);
}

.selector-mode-content {
  animation: fadeIn 0.3s ease;
}

/* ========== Table Mode Styles ========== */

.table-filters {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-12);
  margin-bottom: var(--space-20);
  padding: var(--space-16);
  background: var(--color-surface);
  border-radius: 8px;
  border: 1px solid var(--color-border);
}

.table-filters input[type="search"] {
  flex: 1;
  min-width: 200px;
  padding: var(--space-8) var(--space-12);
  border: 1px solid var(--color-border);
  border-radius: 6px;
  font-size: 14px;
}

.table-filters input[type="search"]:focus {
  outline: none;
  border-color: var(--color-teal-500);
  box-shadow: 0 0 0 2px rgba(var(--color-teal-500-rgb), 0.1);
}

.filter-group {
  display: flex;
  gap: var(--space-8);
}

.filter-btn {
  padding: var(--space-8) var(--space-12);
  border: 1px solid var(--color-border);
  background: var(--color-surface);
  border-radius: 6px;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.filter-btn:hover {
  border-color: var(--color-teal-300);
  background: rgba(var(--color-teal-500-rgb), 0.08);
  transform: translateY(-1px);
  box-shadow: 0 2px 8px rgba(var(--color-teal-500-rgb), 0.1);
}

.filter-btn.active {
  background: var(--color-teal-500);
  color: white;
  border-color: var(--color-teal-500);
}

.reset-filters-btn {
  padding: var(--space-8) var(--space-12);
  border: 1px solid var(--color-red-300);
  background: var(--color-red-50);
  color: var(--color-red-700);
  border-radius: 6px;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.reset-filters-btn:hover {
  background: var(--color-red-100);
  border-color: var(--color-red-400);
}

.comparison-table-wrapper {
  max-height: 600px;
  overflow-y: auto;
  border: 1px solid var(--color-border);
  border-radius: 8px;
  background: var(--color-surface);
  margin-bottom: var(--space-20);
}

.model-comparison-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 14px;
}

.model-comparison-table thead th {
  position: sticky;
  top: 0;
  background: var(--color-surface);
  padding: var(--space-12);
  text-align: left;
  border-bottom: 2px solid var(--color-border);
  font-weight: var(--font-weight-semibold);
  color: var(--color-text);
  cursor: pointer;
  transition: background-color 0.2s ease;
  z-index: 10;
}

.model-comparison-table thead th:hover {
  background: rgba(var(--color-teal-500-rgb), 0.05);
}

.model-comparison-table thead th.sort-asc::after {
  content: ' ▲';
  color: var(--color-teal-500);
}

.model-comparison-table thead th.sort-desc::after {
  content: ' ▼';
  color: var(--color-teal-500);
}

.model-comparison-table tbody td {
  padding: var(--space-12);
  border-bottom: 1px solid var(--color-border);
  vertical-align: top;
}

.model-comparison-table tbody tr:hover {
  background: rgba(var(--color-teal-500-rgb), 0.05);
  transform: scale(1.01);
  transition: all 0.2s ease;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.model-comparison-table tbody tr.selected {
  background: rgba(var(--color-teal-500-rgb), 0.1);
  border-left: 3px solid var(--color-teal-500);
}

.model-name {
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
  margin-bottom: var(--space-4);
}

.model-type {
  display: inline-block;
  padding: 2px 6px;
  border-radius: 10px;
  font-size: 12px;
  font-weight: var(--font-weight-medium);
  text-transform: uppercase;
}

.model-type.Контекстные {
  background: rgba(99, 102, 241, 0.1);
  color: #4338CA;
}

.model-type.Высокоуровневые {
  background: rgba(14, 165, 233, 0.1);
  color: #0EA5E9;
}

.model-type.Действенные {
  background: rgba(16, 185, 129, 0.1);
  color: #059669;
}

.model-type.Вспомогательные {
  background: rgba(249, 115, 22, 0.1);
  color: #EA580C;
}

.complexity-badge, .scale-badge, .duration-badge {
  display: inline-block;
  padding: 2px 6px;
  border-radius: 10px;
  font-size: 12px;
  font-weight: var(--font-weight-medium);
  margin-right: var(--space-4);
}

.complexity-badge.Низкая {
  background: rgba(16, 185, 129, 0.1);
  color: #059669;
}

.complexity-badge.Средняя {
  background: rgba(245, 158, 11, 0.1);
  color: #D97706;
}

.complexity-badge.Высокая {
  background: rgba(239, 68, 68, 0.1);
  color: #DC2626;
}

.scale-badge.Малый {
  background: rgba(16, 185, 129, 0.1);
  color: #059669;
}

.scale-badge.Средний {
  background: rgba(245, 158, 11, 0.1);
  color: #D97706;
}

.scale-badge.Крупный {
  background: rgba(239, 68, 68, 0.1);
  color: #DC2626;
}

.duration-badge {
  background: rgba(99, 102, 241, 0.1);
  color: #4338CA;
}

.focus-badge {
  display: inline-block;
  padding: 2px 6px;
  border-radius: 10px;
  font-size: 12px;
  font-weight: var(--font-weight-medium);
  margin-right: var(--space-4);
}

.focus-badge.Люди {
  background: rgba(236, 72, 153, 0.1);
  color: #DB2777;
}

.focus-badge.Процессы {
  background: rgba(99, 102, 241, 0.1);
  color: #4338CA;
}

.focus-badge.Стратегия {
  background: rgba(14, 165, 233, 0.1);
  color: #0EA5E9;
}

.focus-badge.Культура {
  background: rgba(16, 185, 129, 0.1);
  color: #059669;
}

.model-select-checkbox {
  width: 18px;
  height: 18px;
  cursor: pointer;
}

/* ========== Selected Models Panel Styles ========== */

.selected-models-panel {
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: 8px;
  padding: var(--space-16);
  margin-bottom: var(--space-20);
  display: none;
}

.selected-models-panel.show {
  display: block;
  animation: slideDown 0.3s ease;
}

.selected-models-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--space-12);
  padding-bottom: var(--space-8);
  border-bottom: 1px solid var(--color-border);
}

.selected-models-header h4 {
  margin: 0;
  color: var(--color-text);
}

.clear-selection-btn {
  padding: var(--space-6) var(--space-12);
  border: 1px solid var(--color-red-300);
  background: var(--color-red-50);
  color: var(--color-red-700);
  border-radius: 6px;
  font-size: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.clear-selection-btn:hover {
  background: var(--color-red-100);
}

.selected-model-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--space-8);
  margin-bottom: var(--space-8);
  background: rgba(var(--color-teal-500-rgb), 0.05);
  border-radius: 6px;
  border-left: 3px solid var(--color-teal-500);
}

.selected-model-name {
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
  flex: 1;
}

.remove-model-btn {
  padding: 4px;
  border: none;
  background: transparent;
  color: var(--color-red-500);
  cursor: pointer;
  border-radius: 50%;
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background-color 0.2s ease;
}

.remove-model-btn:hover {
  background: rgba(239, 68, 68, 0.1);
}

.compare-models-btn {
  display: block;
  width: 100%;
  padding: var(--space-10) var(--space-16);
  background: var(--color-teal-500);
  color: white;
  border: none;
  border-radius: 6px;
  font-weight: var(--font-weight-medium);
  cursor: pointer;
  transition: background-color 0.2s ease;
  margin-top: var(--space-12);
}

.compare-models-btn:hover {
  background: var(--color-teal-600);
}

/* ========== Matrix Mode Styles ========== */

.selection-matrix {
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: 8px;
  padding: var(--space-24);
  margin-bottom: var(--space-24);
}

.matrix-step {
  margin-bottom: var(--space-32);
}

.matrix-step:last-child {
  margin-bottom: 0;
}

.matrix-step h4 {
  color: var(--color-text);
  margin-bottom: var(--space-16);
  text-align: center;
  font-size: 1.1rem;
}

.matrix-parameters {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--space-16);
}

.matrix-parameter {
  padding: var(--space-16);
  border: 2px solid var(--color-border);
  border-radius: 12px;
  background: var(--color-surface);
  cursor: pointer;
  transition: all 0.3s ease;
  text-align: center;
  position: relative;
}

.matrix-parameter:hover {
  border-color: var(--color-teal-300);
  transform: translateY(-4px) scale(1.02);
  box-shadow: 0 8px 25px rgba(var(--color-teal-500-rgb), 0.15);
}

.matrix-parameter:hover .matrix-parameter-icon {
  transform: scale(1.1);
  transition: transform 0.3s ease;
}

.matrix-parameter.selected {
  border-color: var(--color-teal-500);
  background: rgba(var(--color-teal-500-rgb), 0.05);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(var(--color-teal-500-rgb), 0.2);
}

.matrix-parameter-icon {
  font-size: 2rem;
  margin-bottom: var(--space-8);
  display: block;
}

.matrix-parameter-title {
  font-weight: var(--font-weight-semibold);
  color: var(--color-text);
  margin-bottom: var(--space-4);
}

.matrix-parameter-description {
  color: var(--color-text-secondary);
  font-size: 14px;
  line-height: 1.4;
}

/* ========== Recommendations Panel Styles ========== */

.recommendations-panel {
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: 8px;
  padding: var(--space-24);
}

.recommendations-header {
  text-align: center;
  margin-bottom: var(--space-24);
}

.recommendations-header h3 {
  color: var(--color-text);
  margin-bottom: var(--space-8);
}

.recommendations-header p {
  color: var(--color-text-secondary);
  font-size: 16px;
}

.recommended-models {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: var(--space-16);
  margin-bottom: var(--space-24);
}

.recommended-model {
  background: rgba(var(--color-teal-500-rgb), 0.05);
  border: 1px solid var(--color-teal-200);
  border-radius: 8px;
  padding: var(--space-16);
  transition: all 0.3s ease;
}

.recommended-model:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(var(--color-teal-500-rgb), 0.1);
  border-color: var(--color-teal-300);
}

.recommended-model h5 {
  color: var(--color-teal-700);
  margin: 0 0 var(--space-8) 0;
  font-size: 1rem;
}

.recommended-model p {
  color: var(--color-text-secondary);
  font-size: 14px;
  line-height: 1.4;
  margin: 0 0 var(--space-12) 0;
}

.recommended-model .model-type {
  margin-bottom: var(--space-8);
}

.goto-model-btn {
  display: block;
  width: 100%;
  padding: var(--space-8) var(--space-12);
  background: var(--color-teal-500);
  color: white;
  border: none;
  border-radius: 6px;
  font-size: 14px;
  font-weight: var(--font-weight-medium);
  cursor: pointer;
  transition: background-color 0.2s ease;
  text-align: center;
}

.goto-model-btn:hover {
  background: var(--color-teal-600);
}

.recommendations-actions {
  display: flex;
  gap: var(--space-12);
  justify-content: center;
  flex-wrap: wrap;
}

.restart-matrix-btn {
  padding: var(--space-10) var(--space-16);
  border: 1px solid var(--color-gray-300);
  background: var(--color-gray-50);
  color: var(--color-text-secondary);
  border-radius: 6px;
  font-weight: var(--font-weight-medium);
  cursor: pointer;
  transition: all 0.2s ease;
}

.restart-matrix-btn:hover {
  background: var(--color-gray-100);
  border-color: var(--color-gray-400);
}

/* ========== Animations ========== */

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ========== Responsive Design ========== */

@media (max-width: 768px) {
  .table-filters {
    flex-direction: column;
  }

  .table-filters input[type="search"] {
    min-width: auto;
  }

  .filter-group {
    justify-content: center;
  }

  .comparison-table-wrapper {
    max-height: 400px;
  }

  .model-comparison-table {
    font-size: 12px;
  }

  .model-comparison-table thead th,
  .model-comparison-table tbody td {
    padding: var(--space-8);
  }

  .matrix-parameters {
    grid-template-columns: 1fr;
  }

  .recommended-models {
    grid-template-columns: 1fr;
  }

  .selector-mode-tabs {
    flex-direction: column;
  }

  .recommendations-actions {
    flex-direction: column;
  }
}

/* ========== Mobile Cards for Model Selector ========== */

@media (max-width: 640px) {
  /* Скрыть таблицу */
  .comparison-table-wrapper {
    display: none;
  }

  /* Показать карточную версию */
  .comparison-cards-mobile {
    display: block;
  }

  .mobile-model-card {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 8px;
    padding: var(--space-16);
    margin-bottom: var(--space-12);
  }

  .mobile-model-card h4 {
    font-size: var(--responsive-text-lg);
    margin-bottom: var(--space-8);
    color: var(--color-teal-700);
  }

  .mobile-model-card-row {
    display: flex;
    justify-content: space-between;
    padding: var(--space-8) 0;
    border-bottom: 1px solid var(--color-border);
  }

  .mobile-model-card-row:last-child {
    border-bottom: none;
  }

  .mobile-model-card-label {
    font-weight: var(--font-weight-medium);
    color: var(--color-text-secondary);
    font-size: 12px;
  }

  .mobile-model-card-value {
    font-size: 12px;
    color: var(--color-text);
    text-align: right;
  }
}

@media (min-width: 641px) and (max-width: 1024px) {
  /* Таблицы с горизонтальной прокруткой на планшетах */
  .comparison-table-wrapper {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }

  .model-comparison-table {
    min-width: 700px;
  }
}

/* ========== Modal Styles ========== */

.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  animation: fadeIn 0.3s ease;
}

.modal-content {
  background: var(--color-surface);
  border-radius: 12px;
  max-width: 90vw;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
  animation: slideDown 0.3s ease;
}

.detailed-comparison-modal {
  width: 100%;
  max-width: 1200px;
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--space-20);
  border-bottom: 1px solid var(--color-border);
}

.modal-header h3 {
  margin: 0;
  color: var(--color-text);
}

.modal-close {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: var(--color-text-secondary);
  padding: var(--space-4);
  border-radius: 50%;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
}

.modal-close:hover {
  background: rgba(239, 68, 68, 0.1);
  color: var(--color-red-500);
}

.modal-body {
  padding: var(--space-24);
}

.comparison-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: var(--space-20);
}

.comparison-card {
  background: rgba(var(--color-teal-500-rgb), 0.05);
  border: 1px solid var(--color-teal-200);
  border-radius: 8px;
  padding: var(--space-16);
  transition: all 0.3s ease;
}

.comparison-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(var(--color-teal-500-rgb), 0.1);
  border-color: var(--color-teal-300);
}

.comparison-card h4 {
  color: var(--color-teal-700);
  margin: 0 0 var(--space-12) 0;
  font-size: 1.2rem;
}

.model-meta {
  display: flex;
  gap: var(--space-8);
  margin-bottom: var(--space-16);
  flex-wrap: wrap;
}

.model-details p {
  margin: var(--space-6) 0;
  font-size: 14px;
  line-height: 1.4;
}

.model-details p strong {
  color: var(--color-text);
}

/* ========== Quiz Recommendations Banner ========== */

.quiz-recommendations-banner {
  background: linear-gradient(135deg, rgba(var(--color-teal-500-rgb), 0.1), rgba(var(--color-blue-500-rgb), 0.1));
  border: 1px solid var(--color-teal-300);
  border-radius: 12px;
  padding: var(--space-16);
  margin-bottom: var(--space-24);
  position: relative;
  animation: slideDown 0.3s ease;
}

.banner-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--space-12);
}

.banner-header h4 {
  margin: 0;
  color: var(--color-teal-700);
  font-size: 1.1rem;
}

.banner-close {
  background: none;
  border: none;
  font-size: 20px;
  cursor: pointer;
  color: var(--color-text-secondary);
  padding: 4px;
  border-radius: 50%;
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
}

.banner-close:hover {
  background: rgba(239, 68, 68, 0.1);
  color: var(--color-red-500);
}

.banner-content p {
  margin: 0 0 var(--space-12) 0;
  color: var(--color-text-secondary);
  font-size: 14px;
}

.quiz-recommended-models {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--space-8);
  margin-bottom: var(--space-12);
}

.quiz-recommended-model {
  background: var(--color-surface);
  border: 1px solid var(--color-teal-200);
  border-radius: 8px;
  padding: var(--space-12);
  cursor: pointer;
  transition: all 0.3s ease;
  text-align: center;
}

.quiz-recommended-model:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(var(--color-teal-500-rgb), 0.2);
  border-color: var(--color-teal-400);
}

.quiz-recommended-model .model-name {
  font-weight: var(--font-weight-semibold);
  color: var(--color-teal-700);
  display: block;
  margin-bottom: var(--space-4);
}

.quiz-recommended-model .model-sources {
  font-size: 12px;
  color: var(--color-text-secondary);
  background: rgba(var(--color-teal-500-rgb), 0.1);
  padding: 2px 6px;
  border-radius: 10px;
}

/* ========== Responsive Modal ========== */

@media (max-width: 768px) {
  .modal-content {
    margin: var(--space-16);
    max-width: none;
    width: calc(100vw - 32px);
  }

  .comparison-grid {
    grid-template-columns: 1fr;
  }

  .modal-header {
    padding: var(--space-16);
  }

  .modal-body {
    padding: var(--space-16);
  }
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Print Styles */
@media print {
  @page {
    size: A4 landscape;
    margin: 10mm;
    /* Попытка скрыть стандартные колонтитулы браузера */
    margin-header: 0;
    margin-footer: 0;
  }
  
  /* Скрыть URL в некоторых браузерах */
  @page :first {
    margin-top: 0;
  }
  
  .navigation,
  .slide-counter,
  .fullscreen-btn,
  .export-btn,
  .progress-bar-container {
    display: none !important;
  }
  
  html, body {
    background: white !important;
    margin: 0 !important;
    padding: 0 !important;
    width: 100% !important;
    height: auto !important;
  }
  
  .presentation {
    padding: 0 !important;
    width: 100% !important;
    height: auto !important;
    display: block !important;
  }
  
  .slide-container {
    overflow: visible !important;
    position: static !important;
    height: auto !important;
    width: 100% !important;
  }
  
  .slide {
    page-break-after: always !important;
    page-break-inside: avoid !important;
    display: block !important;
    position: static !important;
    opacity: 1 !important;
    width: 100% !important;
    max-width: 277mm !important;
    height: auto !important;
    max-height: 190mm !important;
    padding: 15mm !important;
    margin: 0 auto !important;
    overflow: hidden !important;
    box-sizing: border-box !important;
  }
  
  .slide:last-child {
    page-break-after: auto !important;
  }
  
  /* Scale down content if needed */
  .slide-header {
    margin-bottom: 15px !important;
  }
  
  .slide-title {
    font-size: 24px !important;
    margin-bottom: 10px !important;
  }
  
  .slide-subtitle {
    font-size: 16px !important;
    margin-bottom: 15px !important;
  }
  
  .card, .grid-2, .chart-container {
    page-break-inside: avoid !important;
  }
  
  /* Adjust font sizes for better fit */
  .slide p, .slide li {
    font-size: 12px !important;
    line-height: 1.4 !important;
  }
  
  .slide h3 {
    font-size: 16px !important;
    margin-bottom: 8px !important;
  }
  
  .slide h4 {
    font-size: 14px !important;
    margin-bottom: 6px !important;
  }
  
  /* Compact spacing */
  .card {
    padding: 12px !important;
    margin-bottom: 10px !important;
  }
  
  .grid-2 {
    gap: 10px !important;
  }
  
  ul, ol {
    margin: 8px 0 !important;
    padding-left: 20px !important;
  }
  
  li {
    margin-bottom: 4px !important;
  }
}

/* Mobile Swipe Indicator */
@media (max-width: 768px) {
  .swipe-hint {
    position: fixed;
    bottom: 80px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 12px;
    z-index: 999;
    animation: fadeInOut 3s ease-in-out;
    pointer-events: none;
  }
  
  @keyframes fadeInOut {
    0%, 100% { opacity: 0; }
    10%, 90% { opacity: 1; }
  }
}
/* PDF Export Loading Overlay */
.pdf-loading-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.8);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  color: white;
}

.pdf-loading-spinner {
  width: 50px;
  height: 50px;
  border: 5px solid rgba(255, 255, 255, 0.3);
  border-top-color: var(--color-primary);
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.pdf-loading-text {
  margin-top: 20px;
  font-size: 18px;
  font-weight: 500;
}

.pdf-loading-progress {
  margin-top: 10px;
  font-size: 14px;
  color: rgba(255, 255, 255, 0.7);
}

/* ========== Final Slide Elegant Styles ========== */

.final-slide-elegant {
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  height: 100%;
  max-width: 800px;
  margin: 0 auto;
  padding: var(--space-48) var(--space-24);
}

.final-thanks {
  text-align: center;
  padding: var(--space-48) 0;
}

.final-thanks h2 {
  font-size: 32px;
  font-weight: var(--font-weight-semibold);
  color: var(--color-text);
  margin-bottom: var(--space-24);
}

.final-thanks p {
  font-size: 18px;
  color: var(--color-text-secondary);
  line-height: 1.6;
  margin: 0;
}

.final-contact {
  text-align: center;
  padding: var(--space-48) 0;
}

.contact-question {
  font-size: 20px;
  color: var(--color-text);
  margin-bottom: var(--space-32);
}

.contact-name {
  font-size: 24px;
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
  margin: 0 0 var(--space-32) 0;
}

.linkedin-button {
  display: inline-block;
  background: var(--color-primary);
  color: white;
  padding: 14px 40px;
  font-size: 18px;
  font-weight: var(--font-weight-medium);
  border-radius: 8px;
  text-decoration: none;
  transition: all 0.3s ease;
  box-shadow: 0 2px 8px rgba(33, 128, 141, 0.2);
}

.linkedin-button:hover {
  background: var(--color-primary-hover);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(33, 128, 141, 0.3);
}

.final-actions {
  display: flex;
  justify-content: center;
  gap: var(--space-24);
  padding: var(--space-32) 0;
}

.action-secondary {
  background: transparent;
  color: var(--color-text-secondary);
  border: 1px solid var(--color-border);
  padding: 10px 24px;
  font-size: 16px;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.action-secondary:hover {
  background: var(--color-surface);
  color: var(--color-text);
  border-color: var(--color-text-secondary);
}

/* Адаптивность для финального слайда */
@media (max-width: 768px) {
  .final-slide-elegant {
    padding: var(--space-32) var(--space-16);
  }

  .final-thanks h2 {
    font-size: 24px;
  }

  .final-thanks p {
    font-size: 16px;
  }

  .contact-question {
    font-size: 18px;
  }

  .contact-name {
    font-size: 20px;
  }

  .final-actions {
    flex-direction: column;
    gap: var(--space-12);
  }

  .action-secondary {
    width: 100%;
  }
}

/* ========== Enhanced Quiz Styles ========== */
.quiz-profile {
  background: rgba(var(--color-teal-500-rgb), 0.08);
  padding: var(--space-16);
  border-radius: 8px;
  margin: var(--space-16) 0;
}

.quiz-profile-title {
  font-weight: var(--font-weight-semibold);
  color: var(--pres-primary);
  margin-bottom: var(--space-8);
}

.quiz-profile-description {
  font-style: italic;
  color: var(--color-text);
}

.quiz-profile-chart {
  margin: var(--space-24) 0;
  display: flex;
  justify-content: center;
  align-items: center;
  background: rgba(var(--color-slate-900-rgb), 0.02);
  border-radius: 8px;
  padding: var(--space-16);
}

.quiz-recommendations h5 {
  color: var(--pres-primary);
  margin-bottom: var(--space-16);
  text-align: center;
}

.quiz-model-item {
  background: var(--color-surface);
  padding: var(--space-16);
  border-radius: 8px;
  margin-bottom: var(--space-12);
  border: 1px solid var(--color-border);
  transition: border-color 0.2s ease;
}

.quiz-model-item:hover {
  border-color: var(--color-primary);
}

.quiz-model-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--space-8);
}

.quiz-model-number {
  background: var(--color-primary);
  color: white;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: bold;
}

.quiz-model-name {
  flex: 1;
  margin-left: var(--space-12);
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
}

.quiz-model-match {
  background: rgba(var(--color-teal-500-rgb), 0.1);
  color: var(--color-primary);
  padding: 4px 8px;
  border-radius: 12px;
  font-weight: var(--font-weight-bold);
  font-size: 14px;
}

.quiz-model-sources {
  font-size: 12px;
  color: var(--color-text-muted);
  margin-top: var(--space-4);
}

.quiz-actions {
  display: flex;
  gap: var(--space-8);
  margin-top: var(--space-24);
  flex-wrap: wrap;
  justify-content: center;
}

.quiz-actions .panel-button {
  flex: 1;
  min-width: 140px;
}

/* Футер для печати - скрыт на экране */
.print-footer {
  display: none;
}

/* Показать футер только при печати */
@media print {
  .print-footer {
    display: block !important;
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    text-align: center;
    font-size: 9pt;
    color: #555;
    padding: 8px;
    border-top: 1px solid #ccc;
    background: white;
    z-index: 9999;
  }
  
  /* Добавить отступ снизу для каждого слайда под футер */
  .slide {
    padding-bottom: 25mm !important;
  }
}

/* === СТИЛИ ДЛЯ РАЗДЕЛИТЕЛЬНЫХ СЛАЙДОВ === */

/* Основной контейнер разделителя */
.section-separator {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 80vh;
  text-align: center;
  padding: var(--space-32);
  background: linear-gradient(135deg, var(--color-background) 0%, rgba(var(--color-teal-500-rgb), 0.05) 100%);
}

/* Героическая секция */
.separator-hero {
  margin-bottom: var(--space-48);
}

.hero-icon {
  width: 80px;
  height: 80px;
  margin: 0 auto var(--space-24);
  color: var(--color-teal-500);
  opacity: 0.8;
}

.hero-icon svg {
  width: 100%;
  height: 100%;
  fill: currentColor;
}

.separator-title {
  font-size: 3.5rem;
  font-weight: 700;
  color: var(--color-text);
  margin: var(--space-16) 0;
  line-height: 1.1;
}

.separator-subtitle {
  font-size: 1.5rem;
  color: var(--color-text-secondary);
  margin: 0;
  max-width: 600px;
  margin: 0 auto;
}

/* Обзорная секция */
.section-overview {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: var(--space-24);
  margin-bottom: var(--space-48);
  max-width: 900px;
  width: 100%;
}

.overview-card {
  background: var(--color-surface);
  padding: var(--space-32);
  border-radius: 16px;
  border: 1px solid var(--color-card-border);
  transition: all 0.3s ease;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
}

.overview-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
  border-color: var(--color-teal-300);
}

.overview-icon {
  width: 48px;
  height: 48px;
  margin: 0 auto var(--space-16);
  color: var(--color-teal-500);
}

.overview-icon svg {
  width: 100%;
  height: 100%;
  fill: currentColor;
}

.overview-card h3 {
  font-size: 1.25rem;
  font-weight: 600;
  color: var(--color-text);
  margin: var(--space-8) 0;
}

.overview-card p {
  color: var(--color-text-secondary);
  margin: 0;
  font-size: 0.95rem;
  line-height: 1.5;
}

/* Навигационная секция */
.separator-navigation {
  max-width: 600px;
  width: 100%;
  margin-top: var(--space-32);
}

.nav-hint {
  margin-bottom: var(--space-24);
}

.nav-hint p {
  margin: var(--space-4) 0;
  color: var(--color-text-secondary);
  font-size: 0.9rem;
}

.separator-cta {
  background: var(--color-teal-500);
  color: white;
  border: none;
  padding: var(--space-16) var(--space-32);
  border-radius: 12px;
  font-size: 1.1rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  width: 100%;
  max-width: 300px;
}

.separator-cta:hover {
  background: var(--color-teal-600);
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(var(--color-teal-500-rgb), 0.3);
}

.nav-actions {
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: var(--space-8);
  flex-wrap: wrap;
  justify-content: center;
}

.navigation {
  max-height: 80px;
  padding: 6px 12px;
}

/* Адаптивность для очень маленьких экранов */
@media (max-width: 640px) {
  .navigation {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
    -ms-overflow-style: none;
  }

  .navigation::-webkit-scrollbar {
    display: none;
  }

  .navigation {
    padding: 6px 8px;
    gap: var(--space-6);
  }

  .toolbar-btn {
    min-height: 44px; /* Минимум для комфортного тапа */
    padding: 8px 12px;
    font-size: 12px;
  }

  .slide-counter {
    font-size: 11px;
    white-space: nowrap;
  }

  /* Визуальный индикатор прокрутки */
  .navigation::after {
    content: '→';
    position: sticky;
    right: 0;
    padding: 4px 8px;
    background: linear-gradient(to left, var(--color-surface) 70%, transparent);
    color: var(--color-text-secondary);
    font-size: 16px;
    pointer-events: none;
  }

  .nav-center {
    flex-shrink: 0;
    min-width: auto;
  }

  .nav-actions-group {
    flex-shrink: 0;
  }
}

@media (max-width: 480px) {
  .navigation {
    padding: 4px 6px;
  }

  .toolbar-btn {
    padding: 6px 10px;
    font-size: 11px;
  }

  .model-selector, .path-selector {
    max-width: 120px;
    font-size: 11px;
  }
}

.nav-shortcuts {
  text-align: center;
}

.nav-shortcut-btn {
  padding: var(--space-6) var(--space-12);
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 1px solid var(--color-teal-300);
  background: var(--color-teal-50);
  color: var(--color-teal-700);
}

.nav-shortcut-btn:hover {
  background: var(--color-teal-100);
  transform: translateY(-1px);
  box-shadow: 0 3px 8px rgba(var(--color-teal-500-rgb), 0.2);
}

/* === СТИЛИ ДЛЯ РАЗДЕЛИТЕЛЯ "МОДЕЛИ УПРАВЛЕНИЯ ИЗМЕНЕНИЯМИ" === */

.models-separator .separator-hero {
  margin-bottom: var(--space-32);
}

.models-overview {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: var(--space-20);
  margin-bottom: var(--space-40);
  max-width: 1000px;
}

.model-category-card {
  background: var(--color-surface);
  padding: var(--space-24);
  border-radius: 12px;
  border: 1px solid var(--color-card-border);
  transition: all 0.3s ease;
}

.model-category-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
}

.model-category-card .type-badge {
  display: inline-block;
  padding: var(--space-6) var(--space-12);
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: 600;
  margin-bottom: var(--space-12);
}

.model-category-card h4 {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--color-text);
  margin: var(--space-8) 0;
}

.model-category-card p {
  color: var(--color-text-secondary);
  margin: 0;
  font-size: 0.85rem;
  line-height: 1.4;
}

.model-count {
  display: inline-block;
  background: var(--color-teal-100);
  color: var(--color-teal-700);
  padding: var(--space-4) var(--space-8);
  border-radius: 12px;
  font-size: 0.75rem;
  font-weight: 600;
  margin-left: var(--space-8);
}

/* === СТИЛИ ДЛЯ РАЗДЕЛИТЕЛЯ "ПРАКТИКА: ОЦЕНИТЕ СВОЙ ПРОЕКТ" === */

.practice-separator .section-separator {
  background: linear-gradient(135deg, var(--color-background) 0%, rgba(var(--color-orange-500-rgb), 0.05) 100%);
}

.practice-path {
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: var(--space-40);
  max-width: 800px;
  width: 100%;
  position: relative;
}

.path-step {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  position: relative;
  flex: 1;
}

.path-step:not(:last-child)::after {
  content: '';
  position: absolute;
  top: 20px;
  left: 60%;
  right: -40%;
  height: 2px;
  background: linear-gradient(90deg, var(--color-teal-300), var(--color-orange-400));
  z-index: 1;
}

.path-icon {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: var(--space-12);
  position: relative;
  z-index: 2;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.path-step:nth-child(1) .path-icon {
  background: linear-gradient(135deg, var(--color-teal-400), var(--color-teal-600));
  color: white;
}

.path-step:nth-child(2) .path-icon {
  background: linear-gradient(135deg, var(--color-orange-400), var(--color-orange-600));
  color: white;
}

.path-step:nth-child(3) .path-icon {
  background: linear-gradient(135deg, var(--color-red-400), var(--color-red-600));
  color: white;
}

.path-step:nth-child(4) .path-icon {
  background: linear-gradient(135deg, var(--color-teal-400), var(--color-teal-600));
  color: white;
}

.path-step:nth-child(5) .path-icon {
  background: linear-gradient(135deg, var(--color-brown-600), var(--color-brown-600));
  color: white;
}

.path-icon svg {
  width: 24px;
  height: 24px;
  fill: currentColor;
}

.path-label {
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--color-text);
  margin-bottom: var(--space-4);
}

.path-desc {
  font-size: 0.75rem;
  color: var(--color-text-secondary);
  line-height: 1.3;
}

.practice-tools {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: var(--space-24);
  margin-bottom: var(--space-40);
  max-width: 1000px;
}

.practice-tool-card {
  background: var(--color-surface);
  padding: var(--space-24);
  border-radius: 12px;
  border: 1px solid var(--color-card-border);
  transition: all 0.3s ease;
}

.practice-tool-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
  border-color: var(--color-orange-300);
}

.practice-tool-card h4 {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--color-text);
  margin: var(--space-8) 0;
}

.practice-tool-card p {
  color: var(--color-text-secondary);
  margin: 0;
  font-size: 0.9rem;
  line-height: 1.5;
}

.practice-tool-card .tool-duration {
  display: inline-block;
  background: var(--color-orange-100);
  color: var(--color-orange-700);
  padding: var(--space-4) var(--space-8);
  border-radius: 12px;
  font-size: 0.75rem;
  font-weight: 600;
  margin-top: var(--space-12);
}

/* === СТИЛИ ДЛЯ ИНДИКАТОРА ПУТИ ПРОЕКТА === */

.practice-path-indicator {
  background: var(--color-surface);
  border: 1px solid var(--color-card-border);
  border-radius: 12px;
  padding: var(--space-20);
  margin-bottom: var(--space-24);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.path-indicator-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--space-16);
  padding-bottom: var(--space-12);
  border-bottom: 1px solid var(--color-border);
}

.path-indicator-header h4 {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--color-text);
  margin: 0;
}

.current-step {
  font-size: 0.85rem;
  color: var(--color-teal-600);
  font-weight: 600;
  background: var(--color-teal-50);
  padding: var(--space-4) var(--space-8);
  border-radius: 12px;
}

.path-indicator {
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: var(--space-20);
  position: relative;
}

.path-step-indicator {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  position: relative;
  opacity: 0.4;
  transition: all 0.3s ease;
  padding: var(--space-4);
  border-radius: 8px;
}

.path-step-indicator:hover {
  opacity: 0.7;
  transform: translateY(-1px);
  background: rgba(var(--color-teal-500-rgb), 0.05);
}

.path-step-indicator.active {
  opacity: 1;
}

.path-step-indicator.completed {
  opacity: 0.8;
}

.path-step-indicator.completed .step-icon {
  background: linear-gradient(135deg, var(--color-green-400), var(--color-green-600));
  border-color: var(--color-green-500);
  color: white;
}

.path-step-indicator.completed .step-label {
  color: var(--color-green-600);
}

.path-connector.completed::after {
  width: 100%;
}

.path-step-indicator .step-icon {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: var(--space-8);
  background: var(--color-gray-200);
  border: 2px solid var(--color-border);
  transition: all 0.3s ease;
}

.path-step-indicator.active .step-icon {
  background: linear-gradient(135deg, var(--color-teal-400), var(--color-teal-600));
  border-color: var(--color-teal-500);
  color: white;
}

.path-step-indicator .step-icon svg {
  width: 20px;
  height: 20px;
  fill: currentColor;
}

.path-step-indicator .step-label {
  font-size: 0.8rem;
  font-weight: 600;
  color: var(--color-text-secondary);
  white-space: nowrap;
}

.path-step-indicator.active .step-label {
  color: var(--color-teal-600);
}

.path-connector {
  width: 40px;
  height: 2px;
  background: var(--color-border);
  margin: 0 var(--space-8);
  position: relative;
}

.path-connector::after {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, var(--color-teal-300), var(--color-teal-600));
  transition: width 0.5s ease;
}

.path-step-indicator.active + .path-connector::after {
  width: 100%;
}

.path-navigation {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-top: var(--space-16);
  border-top: 1px solid var(--color-border);
}

.path-nav-btn {
  padding: var(--space-8) var(--space-16);
  border-radius: 8px;
  font-size: 0.9rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 1px solid var(--color-teal-300);
  background: var(--color-teal-50);
  color: var(--color-teal-700);
}

.path-nav-btn:hover {
  background: var(--color-teal-100);
  transform: translateY(-1px);
}

.path-nav-btn.secondary {
  border-color: var(--color-gray-300);
  background: var(--color-gray-50);
  color: var(--color-text-secondary);
}

.path-nav-btn.secondary:hover {
  background: var(--color-gray-100);
}

/* Responsive design */
@media (max-width: 768px) {
  .section-overview,
  .models-overview,
  .practice-tools {
    grid-template-columns: 1fr;
    gap: var(--space-16);
  }

  .separator-title {
    font-size: 2.5rem;
  }

  .separator-subtitle {
    font-size: 1.2rem;
  }

  .practice-path {
    flex-direction: column;
    gap: var(--space-16);
  }

  .path-step:not(:last-child)::after {
    display: none;
  }

  .path-indicator {
    flex-direction: column;
    gap: var(--space-12);
  }

  .path-connector {
    width: 2px;
    height: 20px;
    margin: var(--space-8) 0;
  }

  .path-step-indicator {
    flex-direction: row;
    width: 100%;
    justify-content: flex-start;
  }

  .path-step-indicator .step-icon {
    margin-bottom: 0;
    margin-right: var(--space-12);
  }

  .path-step-indicator .step-label {
    text-align: left;
  }

  .path-navigation {
    flex-direction: column;
    gap: var(--space-8);
  }

  .path-nav-btn {
    width: 100%;
  }
}
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Progress Bar -->
    <div class="progress-bar-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <!-- Circular Progress Indicator -->
    <div class="circular-progress" id="progressIndicator">
        <svg viewBox="0 0 60 60" aria-hidden="true">
            <circle class="progress-track" cx="30" cy="30" r="25"></circle>
            <circle class="progress-circle" id="progressCircle" cx="30" cy="30" r="25"></circle>
        </svg>
        <span class="progress-count" id="progressCount">1 / --</span>
    </div>
    
    <!-- Control Buttons -->
    <button class="export-btn" onclick="exportToPDF()" title="Экспорт в PDF (все слайды)">📄 PDF</button>
    <button class="fullscreen-btn" onclick="toggleFullscreen()" title="Полноэкранный режим">⛶</button>
    
    <div class="presentation">
        <div class="slide-container" id="slideContainer">
            <!-- Slides will be dynamically generated -->
        </div>
        
        <div class="navigation">
            <div class="nav-buttons">
                <button class="btn btn-secondary" id="prevBtn" onclick="changeSlide(-1)">← Назад</button>
                <button class="btn" id="nextBtn" onclick="changeSlide(1)">Далее →</button>
            </div>
            
            <div class="nav-center">
                <div class="slide-counter" id="slideCounter">1 / --</div>
                <select class="model-selector" id="modelSelector" onchange="jumpToSlide(this.value)">
                    <option value="">Перейти к слайду...</option>
                </select>
                <select class="path-selector" id="pathSelector" title="Выберите глубину погружения">
                    <option value="quick">Быстрый</option>
                    <option value="standard">Стандартный</option>
                    <option value="expert" selected>Экспертный</option>
                </select>
                <div class="path-meta" id="pathMeta">Экспертный путь • все слайды</div>
            </div>

            <div class="nav-actions">
                <div class="search-container" id="searchContainer">
                    <input type="search" id="searchInput" placeholder="Поиск по слайдам (Ctrl+K)" autocomplete="off" aria-label="Поиск по слайдам">
                    <ul class="search-results" id="searchResults"></ul>
                </div>
                <div class="nav-actions-group">
                    <button class="toolbar-btn" id="bookmarkToggle" type="button" title="Добавить текущий слайд в избранное">☆ Избранное</button>
                    <button class="toolbar-btn" id="bookmarkPanelToggle" type="button" title="Открыть список избранных слайдов">Список ⭐</button>
                    <button class="toolbar-btn" id="historyToggle" type="button" title="История просмотра">🕘 История</button>
                    <button class="toolbar-btn" id="notesToggle" type="button" title="Открыть заметки по слайду">📝 Заметки</button>
                    <button class="toolbar-btn" id="themeToggle" type="button" title="Переключить тему">🌞 Тема</button>
                    <a class="toolbar-btn linkedin-link" href="https://www.linkedin.com/in/dmitry-vladimirov-cdto" target="_blank" rel="noopener noreferrer" title="Мой профиль LinkedIn">in LinkedIn</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Панель избранного -->
    <div class="bookmark-panel" id="bookmarkPanel">
        <div class="panel-header">
            <h4>Избранные слайды</h4>
            <button class="panel-close" id="bookmarkPanelClose" aria-label="Закрыть список избранных">×</button>
        </div>
        <div class="bookmark-empty" id="bookmarkEmpty">Пока нет избранных. Добавьте слайды, которые хотите быстро находить.</div>
        <ul class="bookmark-list" id="bookmarkList"></ul>
    </div>

    <!-- Панель заметок -->
    <div class="notes-panel" id="notesPanel">
        <div class="panel-header">
            <h4>Заметки по слайду</h4>
            <button class="panel-close" id="notesClose" aria-label="Скрыть панель заметок">×</button>
        </div>
        <textarea id="notesTextarea" placeholder="Запишите ключевые инсайты, идеи или договоренности по текущему слайду..."></textarea>
        <div class="notes-footer">
            <span class="notes-status" id="notesStatus">Изменения не сохранены</span>
            <div class="notes-actions">
                <button class="panel-button" id="notesClear">Очистить</button>
            </div>
        </div>
    </div>

    <!-- Панель истории -->
    <div class="history-panel" id="historyPanel">
        <div class="panel-header">
            <h4>История просмотра</h4>
            <button class="panel-close" id="historyClose" aria-label="Закрыть историю">×</button>
        </div>
        <div class="history-empty" id="historyEmpty">Просмотрите несколько слайдов — и они появятся здесь для быстрого возврата.</div>
        <ul class="history-list" id="historyList"></ul>
    </div>

    <!-- Модальное окно достижений -->
    <div class="achievement-modal" id="achievementModal" aria-live="polite">
        <div class="achievement-content">
            <div class="achievement-icon">🏆</div>
            <h3 id="achievementTitle">Отличная работа!</h3>
            <p id="achievementMessage">Вы прошли 10 слайдов и открыли новое достижение.</p>
            <button class="panel-button achievement-close" id="achievementClose">Продолжить</button>
        </div>
    </div>

    <!-- Футер для печати -->
    <div class="print-footer">
        Автор: Dmitry Vladimirov | LinkedIn: www.linkedin.com/in/dmitry-vladimirov-cdto
    </div>

    <script>
        let currentSlide = 0;
        let totalSlides = 0;
        let fullSlidesCount = 0;
        let visibleSlides = [];
        let visibleSlidesSet = new Set();
        let activeLearningPath = 'expert';
        let baseSlidesCount = 0;
        let classicalStartIndex = 0;
        let newModelsStartIndex = 0;
        let closingSlidesStartIndex = 0;
        let closingSlidesCount = 0;
        let quizCompleted = false;
        const slidesVisited = new Set([0]);
        const startTime = Date.now();
        let modelsChartInstance = null;
        let modelsChartSlideIndex = -1;
        let finalSlideIndex = -1;
        const searchIndex = [];
        let searchResults = [];
        let searchTerms = [];
        let activeSearchResultIndex = -1;
        let currentSearchTerm = '';
        const historyItems = [];
        const HISTORY_LIMIT = 12;
        const THEME_STORAGE_KEY = 'change_presentation_theme';
        const themeOrder = ['auto', 'dark', 'light'];
        let currentTheme = localStorage.getItem(THEME_STORAGE_KEY) || 'auto';

        // initializeTheme(); // ПЕРЕНЕСЕНО в конец инициализации после объявления всех переменных
        
        const PROGRESS_CIRCUMFERENCE = 2 * Math.PI * 25;
        
        // ===== ФУНКЦИИ НАВИГАЦИИ (перемещены в начало для доступности из HTML) =====
        
        // Функция для отображения сообщений об ошибках пользователю
        function showErrorMessage(message) {
            const errorDiv = document.createElement('div');
            errorDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: var(--color-error, #dc3545);
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                z-index: 10000;
                max-width: 400px;
                font-family: var(--font-family-base);
            `;
            errorDiv.innerHTML = `<strong>Ошибка:</strong> ${message}`;
            document.body.appendChild(errorDiv);

            setTimeout(() => {
                errorDiv.remove();
            }, 5000);
        }

        function changeSlide(direction) {
            const slides = document.querySelectorAll('.slide');
            if (slides.length === 0) {
                console.warn('Слайды ещё не созданы, changeSlide отменён');
                return;
            }
            if (!slides[currentSlide]) {
                console.error('Текущий слайд не найден:', currentSlide);
                return;
            }
            
            slides[currentSlide].classList.remove('active');
            const nextSlide = findNextVisibleSlide(currentSlide, direction);
            currentSlide = nextSlide;
            
            if (slides[currentSlide]) {
                slides[currentSlide].classList.add('active');
                slides[currentSlide].scrollTop = 0;
            }
            updateNavigation();
        }
        
        function jumpToSlide(index) {
            if (index === '') return;
            const slideIndex = parseInt(index, 10);
            if (Number.isNaN(slideIndex)) return;
            if (slideIndex >= 0 && slideIndex < fullSlidesCount) {
                // Переключаемся на экспертный путь только если текущий путь не экспертный
                // и если целевой слайд недоступен в текущем пути
                if (activeLearningPath !== 'expert' && !visibleSlidesSet.has(slideIndex)) {
                    setLearningPath('expert');
                }

                const slides = document.querySelectorAll('.slide');
                if (slides[currentSlide]) {
                    slides[currentSlide].classList.remove('active');
                }
                currentSlide = slideIndex;
                if (slides[currentSlide]) {
                    slides[currentSlide].classList.add('active');
                    slides[currentSlide].scrollTop = 0;
                }
                updateNavigation();
            }
        }
        
        function activateSlide(index) {
            const slides = document.querySelectorAll('.slide');
            if (slides.length === 0) {
                console.warn('Слайды ещё не созданы');
                return;
            }
            
            // Убрать active со всех слайдов
            slides.forEach(slide => slide.classList.remove('active'));
            
            // Добавить active к текущему слайду
            if (slides[index]) {
                slides[index].classList.add('active');
                slides[index].scrollTop = 0;
                console.log('Активирован слайд:', index);
            } else {
                console.error('Слайд с индексом', index, 'не найден. Всего слайдов:', slides.length);
            }
        }
        
        function updateNavigation() {
            const position = getVisiblePosition(currentSlide);
            const totalVisible = visibleSlides.length || 1;
            
            if (slideCounterEl) {
                slideCounterEl.textContent = `${position + 1} / ${totalVisible}`;
            }
            if (prevBtnEl) {
                prevBtnEl.disabled = position <= 0;
            }
            if (nextBtnEl) {
                nextBtnEl.disabled = position >= totalVisible - 1;
            }
            if (modelSelectorEl) {
                modelSelectorEl.value = visibleSlidesSet.has(currentSlide) ? String(currentSlide) : '';
            }
            
            const progressRatio = totalVisible > 1 && position >= 0 ? position / (totalVisible - 1) : 1;
            if (progressBarEl) {
                progressBarEl.style.width = `${Math.min(Math.max(progressRatio * 100, 0), 100)}%`;
            }
            updateCircularProgress(progressRatio);
            slidesVisited.add(currentSlide);
            updateHistory(currentSlide);
            updateBookmarkUI();
            highlightActiveBookmark();
            syncNotesPanel();
            clearSearchHighlight();
            if (currentSearchTerm && searchTerms.length) {
                applySearchHighlight();
            }
            checkAchievements(currentSlide);
            if (modelsChartSlideIndex === currentSlide) {
                renderModelsBubbleChart();
            }
            if (currentSlide === finalSlideIndex) {
                updateFinalStats();
            }
            
            activateSlide(currentSlide);
        }
        
        // ===== КОНЕЦ ФУНКЦИЙ НАВИГАЦИИ =====
        
        const progressBarEl = document.getElementById('progressBar');
        const progressCircleEl = document.getElementById('progressCircle');
        const progressCountEl = document.getElementById('progressCount');
        const slideCounterEl = document.getElementById('slideCounter');
        const prevBtnEl = document.getElementById('prevBtn');
        const nextBtnEl = document.getElementById('nextBtn');
        const modelSelectorEl = document.getElementById('modelSelector');
        const bookmarkToggleBtn = document.getElementById('bookmarkToggle');
        const bookmarkPanelToggleBtn = document.getElementById('bookmarkPanelToggle');
        const bookmarkPanelEl = document.getElementById('bookmarkPanel');
        const bookmarkPanelCloseBtn = document.getElementById('bookmarkPanelClose');
        const bookmarkListEl = document.getElementById('bookmarkList');
        const bookmarkEmptyEl = document.getElementById('bookmarkEmpty');
        const pathSelectorEl = document.getElementById('pathSelector');
        const pathMetaEl = document.getElementById('pathMeta');
        const notesToggleBtn = document.getElementById('notesToggle');
        const notesPanelEl = document.getElementById('notesPanel');
        const notesCloseBtn = document.getElementById('notesClose');
        const notesTextareaEl = document.getElementById('notesTextarea');
        const notesClearBtn = document.getElementById('notesClear');
        const notesStatusEl = document.getElementById('notesStatus');
        const achievementModalEl = document.getElementById('achievementModal');
        const achievementTitleEl = document.getElementById('achievementTitle');
        const achievementMessageEl = document.getElementById('achievementMessage');
        const achievementCloseBtn = document.getElementById('achievementClose');
        const searchInputEl = document.getElementById('searchInput');
        const searchResultsEl = document.getElementById('searchResults');
        const historyPanelEl = document.getElementById('historyPanel');
        const historyCloseBtn = document.getElementById('historyClose');
        const historyListEl = document.getElementById('historyList');
        const historyEmptyEl = document.getElementById('historyEmpty');
        const historyToggleBtn = document.getElementById('historyToggle');
        const themeToggleBtn = document.getElementById('themeToggle');
        const searchContainerEl = document.getElementById('searchContainer');
        
        if (progressCircleEl) {
            progressCircleEl.style.strokeDasharray = PROGRESS_CIRCUMFERENCE;
            progressCircleEl.style.strokeDashoffset = PROGRESS_CIRCUMFERENCE;
        }
        
        const BOOKMARK_STORAGE_KEY = 'change_presentation_bookmarks_v1';
        const NOTES_STORAGE_KEY = 'change_presentation_notes_v1';
        const ACHIEVEMENT_STORAGE_KEY = 'change_presentation_achievements_v2';
        
        const achievementThresholds = [
            {
                id: 'slide-10-complete',
                slidesCount: 10,
                title: '10 слайдов позади!',
                message: 'Отличный старт! Вы уже прошли 10 разных слайдов и готовы к углублению.'
            },
            {
                id: 'slide-25-complete',
                slidesCount: 25,
                title: 'Четверть пути!',
                message: 'Вы просмотрели 25 слайдов! Сделайте паузу на чашку кофе ☕ и продолжайте!'
            },
            {
                id: 'slide-50-complete',
                slidesCount: 50,
                title: '50 слайдов — вы эксперт!',
                message: 'Вы просмотрели 50 уникальных слайдов. Впечатляющий прогресс!'
            },
            {
                id: 'slide-final',
                slidesCount: null,
                title: 'Полное прохождение!',
                message: 'Вы просмотрели все слайды презентации и знакомы с 56 моделями управления изменениями!'
            }
        ];

        const quizSteps = [
            {
                id: 'scope',
                question: 'Каков масштаб предстоящих изменений?',
                options: [
                    { value: 'small', label: 'Локальные (команда/процесс)', hint: 'Пилоты, Kaizen, быстрая адаптация' },
                    { value: 'medium', label: 'Кросс-функциональные (департамент)', hint: 'Нужно синхронизировать несколько команд' },
                    { value: 'large', label: 'Вся организация или холдинг', hint: 'Комплексная трансформация с множеством стейкхолдеров' }
                ]
            },
            {
                id: 'resistance',
                question: 'Какой уровень сопротивления вы ожидаете?',
                options: [
                    { value: 'low', label: 'Низкий — люди ждут изменений', hint: 'Достаточно хорошей коммуникации и обучения' },
                    { value: 'mixed', label: 'Смешанный — есть энтузиазм и сомнения', hint: 'Нужно сочетать эмпатию и быстрые победы' },
                    { value: 'high', label: 'Высокий — серьёзные опасения и недоверие', hint: 'Требуется психологическая работа и спонсорство' }
                ]
            },
            {
                id: 'pace',
                question: 'Какой темп внедрения необходим?',
                options: [
                    { value: 'rapid', label: 'Очень быстрый', hint: 'Рынок или руководство требует быстрых результатов' },
                    { value: 'iterative', label: 'Итеративный', hint: 'Нужны волны внедрения и постоянная обратная связь' },
                    { value: 'strategic', label: 'Пошагово и стратегически', hint: 'Важно соотнести изменения с архитектурой организации' }
                ]
            },
            {
                id: 'culture',
                question: 'Как бы вы описали культуру вашей организации?',
                options: [
                    { value: 'conservative', label: 'Консервативная', hint: 'Стабильность, традиции, проверенные методы' },
                    { value: 'hybrid', label: 'Гибридная', hint: 'Сочетание традиций и инноваций' },
                    { value: 'innovative', label: 'Инновационная', hint: 'Готовность к рискам, экспериментам' }
                ]
            },
            {
                id: 'resources',
                question: 'Как бы вы оценили доступные ресурсы?',
                options: [
                    { value: 'limited', label: 'Ограничены', hint: 'Недостаточно бюджета и времени' },
                    { value: 'adequate', label: 'Достаточно', hint: 'Есть необходимые ресурсы для реализации' },
                    { value: 'abundant', label: 'Избыточны', hint: 'Много ресурсов, можно экспериментировать' }
                ]
            }
        ];

        const quizScopeMap = {
            small: {
                title: 'Локальные изменения',
                description: 'Используйте короткие циклы экспериментов и микровлияние на поведение.',
                recommendations: [
                    { label: 'PDCA Цикл', keyword: 'pdca', baseMatch: 90 },
                    { label: 'Теория подталкивания', keyword: 'подталкивания', baseMatch: 85 },
                    { label: 'R2P2', keyword: 'r2p2', baseMatch: 80 }
                ]
            },
            medium: {
                title: 'Кросс-функциональные изменения',
                description: 'Согласуйте несколько команд и обеспечьте поддержку спонсоров.',
                recommendations: [
                    { label: 'АДКАР', keyword: 'адкар', baseMatch: 88 },
                    { label: 'Модель Коттера', keyword: 'коттер', baseMatch: 85 },
                    { label: 'Модель Сатир', keyword: 'сатир', baseMatch: 82 }
                ]
            },
            large: {
                title: 'Организационная трансформация',
                description: 'Комплексная трансформация требует структурированного подхода и управления сопротивлением.',
                recommendations: [
                    { label: 'Гибридная модель', keyword: 'гибридная', baseMatch: 90 },
                    { label: 'Маур 3 уровня', keyword: 'маур', baseMatch: 87 },
                    { label: 'Стандарт ACMP', keyword: 'acmp', baseMatch: 85 }
                ]
            }
        };

        const quizResistanceMap = {
            low: {
                title: 'Низкое сопротивление',
                description: 'Фокус на коммуникации и вовлечении.',
                recommendations: [
                    { label: 'Теория подталкивания', keyword: 'подталкивания', baseMatch: 88 },
                    { label: 'PDCA Цикл', keyword: 'pdca', baseMatch: 85 },
                    { label: 'R2P2', keyword: 'r2p2', baseMatch: 80 }
                ]
            },
            mixed: {
                title: 'Смешанное сопротивление',
                description: 'Комбинация эмпатии, обучения и быстрого получения результатов.',
                recommendations: [
                    { label: 'АДКАР', keyword: 'адкар', baseMatch: 90 },
                    { label: 'Модель Коттера', keyword: 'коттер', baseMatch: 87 },
                    { label: 'Модель Сатир', keyword: 'сатир', baseMatch: 85 }
                ]
            },
            high: {
                title: 'Высокое сопротивление',
                description: 'Необходимы глубокая работа с сопротивлением и спонсорство.',
                recommendations: [
                    { label: 'Маур 3 уровня', keyword: 'маур', baseMatch: 92 },
                    { label: 'Гибридная модель', keyword: 'гибридная', baseMatch: 88 },
                    { label: 'Стандарт ACMP', keyword: 'acmp', baseMatch: 85 }
                ]
            }
        };

        const quizPaceMap = {
            rapid: {
                title: 'Быстрое внедрение',
                description: 'Акцент на скорость и быстрые результаты.',
                recommendations: [
                    { label: 'PDCA Цикл', keyword: 'pdca', baseMatch: 90 },
                    { label: 'Теория подталкивания', keyword: 'подталкивания', baseMatch: 85 },
                    { label: 'Гибридная модель', keyword: 'гибридная', baseMatch: 80 }
                ]
            },
            iterative: {
                title: 'Итеративное внедрение',
                description: 'Постоянная обратная связь и корректировка.',
                recommendations: [
                    { label: 'АДКАР', keyword: 'адкар', baseMatch: 88 },
                    { label: 'PDCA Цикл', keyword: 'pdca', baseMatch: 85 },
                    { label: 'R2P2', keyword: 'r2p2', baseMatch: 82 }
                ]
            },
            strategic: {
                title: 'Стратегическое внедрение',
                description: 'Глубокая интеграция с архитектурой организации.',
                recommendations: [
                    { label: 'Модель Коттера', keyword: 'коттер', baseMatch: 90 },
                    { label: 'Стандарт ACMP', keyword: 'acmp', baseMatch: 87 },
                    { label: 'Маур 3 уровня', keyword: 'маур', baseMatch: 85 }
                ]
            }
        };

        const quizCultureMap = {
            conservative: {
                title: 'Консервативная культура',
                description: 'Подходят проверенные и структурированные методы.',
                recommendations: [
                    { label: 'Модель Коттера', keyword: 'коттер', baseMatch: 90 },
                    { label: 'Стандарт ACMP', keyword: 'acmp', baseMatch: 88 },
                    { label: 'АДКАР', keyword: 'адкар', baseMatch: 85 }
                ]
            },
            hybrid: {
                title: 'Гибридная культура',
                description: 'Комбинация проверенных методов и инноваций.',
                recommendations: [
                    { label: 'Гибридная модель', keyword: 'гибридная', baseMatch: 90 },
                    { label: 'Модель Сатир', keyword: 'сатир', baseMatch: 87 },
                    { label: 'PDCA Цикл', keyword: 'pdca', baseMatch: 85 }
                ]
            },
            innovative: {
                title: 'Инновационная культура',
                description: 'Подходят экспериментальные и гибкие подходы.',
                recommendations: [
                    { label: 'Теория подталкивания', keyword: 'подталкивания', baseMatch: 88 },
                    { label: 'R2P2', keyword: 'r2p2', baseMatch: 85 },
                    { label: 'PDCA Цикл', keyword: 'pdca', baseMatch: 82 }
                ]
            }
        };

        const quizResourcesMap = {
            limited: {
                title: 'Ограниченные ресурсы',
                description: 'Эффективные и простые в реализации методы.',
                recommendations: [
                    { label: 'PDCA Цикл', keyword: 'pdca', baseMatch: 90 },
                    { label: 'Теория подталкивания', keyword: 'подталкивания', baseMatch: 88 },
                    { label: 'АДКАР', keyword: 'адкар', baseMatch: 85 }
                ]
            },
            adequate: {
                title: 'Достаточные ресурсы',
                description: 'Можно использовать комплексные подходы.',
                recommendations: [
                    { label: 'Модель Коттера', keyword: 'коттер', baseMatch: 88 },
                    { label: 'Гибридная модель', keyword: 'гибридная', baseMatch: 85 },
                    { label: 'Маур 3 уровня', keyword: 'маур', baseMatch: 83 }
                ]
            },
            abundant: {
                title: 'Избыточные ресурсы',
                description: 'Можно экспериментировать и использовать сложные методы.',
                recommendations: [
                    { label: 'Стандарт ACMP', keyword: 'acmp', baseMatch: 90 },
                    { label: 'Маур 3 уровня', keyword: 'маур', baseMatch: 87 },
                    { label: 'Модель Сатир', keyword: 'сатир', baseMatch: 85 }
                ]
            }
        };
        
        const learningPaths = {
            quick: {
                id: 'quick',
                label: 'Быстрый',
                description: '≈15 минут • Основы и ключевые модели',
                slides: [0] // Безопасное значение по умолчанию
            },
            standard: {
                id: 'standard',
                label: 'Стандартный',
                description: '≈45 минут • Углублённое изучение',
                slides: [0] // Безопасное значение по умолчанию
            },
            expert: {
                id: 'expert',
                label: 'Экспертный',
                description: 'Полная версия • Все материалы',
                slides: [0] // Безопасное значение по умолчанию
            }
        };
        
        const timelineData = [
            {
                period: '1950–1980',
                headline: 'Эпоха научного управления',
                summary: 'Фокус на структуре, процессах и воспроизводимости изменений.',
                highlights: [
                    'Основатели: Курт Левин, Дэвид Бекхард',
                    'Ключевые модели: Трёхэтапная модель Левина, Формула Бекхарда-Харриса'
                ],
                tone: 'context'
            },
            {
                period: '1980–2000',
                headline: 'Стратегический фокус',
                summary: 'Изменения становятся частью корпоративной стратегии и масштабных программ.',
                highlights: [
                    'Игроки: Джон Коттер, GE, McKinsey',
                    'Модели: 8 шагов Коттера, McKinsey 7-S, GE CAP'
                ],
                tone: 'strategy'
            },
            {
                period: '2000–2015',
                headline: 'Люди и культура в центре',
                summary: 'Психология, вовлечение и эмоциональный путь становятся ключевыми.',
                highlights: [
                    'Фокус: сопротивление, коммуникация, доверие',
                    'Модели: ADKAR, Переход Бриджеса, Позитивное отклонение'
                ],
                tone: 'people'
            },
            {
                period: '2015–2023',
                headline: 'Гибкость и скорость',
                summary: 'Agile, продуктовое мышление и непрерывные итерации закрепляются как стандарт.',
                highlights: [
                    'Практики: Agile управление изменениями, PDCA',
                    'Акцент: быстрые циклы обратной связи, экспериментирование'
                ],
                tone: 'agile'
            },
            {
                period: '2024–2025',
                headline: 'ИИ, персонализация и психологическая безопасность',
                summary: 'Технология поддерживает человека, а изменения становятся гиперперсонализированными.',
                highlights: [
                    'Фокус: AI как инструмент, индивидуальные траектории, доверие',
                    'Модели: Модель Сатир, R2P2, AI-усиленный подход'
                ],
                tone: 'future'
            }
        ];
        
        const bubbleChartConfig = {
            categories: {
                Контекстные: { backgroundColor: 'rgba(99, 102, 241, 0.55)', borderColor: '#4338CA' },
                'Высокоуровневые': { backgroundColor: 'rgba(14, 165, 233, 0.55)', borderColor: '#0EA5E9' },
                Действенные: { backgroundColor: 'rgba(16, 185, 129, 0.55)', borderColor: '#059669' },
                Вспомогательные: { backgroundColor: 'rgba(249, 115, 22, 0.55)', borderColor: '#EA580C' }
            },
            points: [
                { category: 'Контекстные', label: 'Burke-Litwin', x: 8.5, y: 8, r: 18 },
                { category: 'Контекстные', label: 'McKinsey 7-S', x: 7.2, y: 7, r: 15 },
                { category: 'Контекстные', label: 'Теория U', x: 8, y: 6.5, r: 16 },
                { category: 'Высокоуровневые', label: 'Модель Коттера', x: 6, y: 6.5, r: 14 },
                { category: 'Высокоуровневые', label: 'Переход Бриджеса', x: 4.8, y: 5.2, r: 12 },
                { category: 'Высокоуровневые', label: 'Стандарт ACMP', x: 6.4, y: 5.8, r: 13 },
                { category: 'Действенные', label: 'ADKAR', x: 5.5, y: 5.6, r: 14 },
                { category: 'Действенные', label: 'PDCA', x: 3.4, y: 3.2, r: 11 },
                { category: 'Действенные', label: 'Гибридное управление', x: 7.1, y: 5.4, r: 17 },
                { category: 'Действенные', label: 'Change Delta', x: 6.6, y: 6, r: 14 },
                { category: 'Действенные', label: 'Маур 3 уровня', x: 5.2, y: 7, r: 13 },
                { category: 'Вспомогательные', label: 'R2P2', x: 2.6, y: 2.5, r: 10 },
                { category: 'Вспомогательные', label: 'Теория подталкивания', x: 2.2, y: 3.1, r: 9 },
                { category: 'Вспомогательные', label: 'AI-усиленный подход', x: 6.8, y: 6.2, r: 15 }
            ]
        };
        
        const safeParseStorage = (key, fallback) => {
            try {
                const raw = localStorage.getItem(key);
                return raw ? JSON.parse(raw) : fallback;
            } catch (error) {
                console.warn(`Не удалось прочитать данные ${key}:`, error);
                return fallback;
            }
        };
        
        let bookmarks = new Set(
            safeParseStorage(BOOKMARK_STORAGE_KEY, [])
                .map(Number)
                .filter(Number.isFinite)
        );
        let notesStore = safeParseStorage(NOTES_STORAGE_KEY, {});
        let unlockedAchievements = new Set(safeParseStorage(ACHIEVEMENT_STORAGE_KEY, []));
        let notesSaveTimeout = null;
        
        const slidesData = [
            // СЛАЙД 1 - РАЗДЕЛИТЕЛЬ: ДОБРО ПОЖАЛОВАТЬ
            {
                title: "Добро пожаловать в мир управления изменениями",
                subtitle: "Интерактивное путешествие по 56 моделям",
                content: `
                    <div class="section-separator">
                        <div class="separator-hero">
                            <div class="hero-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"></path>
                                </svg>
                            </div>
                            <h1 class="separator-title">Добро пожаловать!</h1>
                            <p class="separator-subtitle">Ваш путь к мастерству управления изменениями начинается здесь</p>
                        </div>

                        <div class="section-overview">
                            <div class="overview-card">
                                <div class="overview-icon">
                                    <svg viewBox="0 0 24 24" aria-hidden="true">
                                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                                    </svg>
                                </div>
                                <h3>56 Моделей</h3>
                                <p>Полный каталог от классических до современных подходов</p>
                            </div>

                            <div class="overview-card">
                                <div class="overview-icon">
                                    <svg viewBox="0 0 24 24" aria-hidden="true">
                                        <path d="M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.1 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"></path>
                                    </svg>
                                </div>
                                <h3>Интерактивные Инструменты</h3>
                                <p>Практические инструменты для оценки и планирования ваших проектов</p>
                            </div>

                            <div class="overview-card">
                                <div class="overview-icon">
                                    <svg viewBox="0 0 24 24" aria-hidden="true">
                                        <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path>
                                    </svg>
                                </div>
                                <h3>Экспорт и Аналитика</h3>
                                <p>Сохраните результаты и поделитесь инсайтами в формате PDF</p>
                            </div>
                        </div>

                        <div class="separator-navigation">
                            <div class="nav-hint">
                                <p><strong>Навигация:</strong> Используйте стрелки клавиатуры или кнопки для перехода между слайдами</p>
                                <p><strong>Интерактив:</strong> Нажмите на элементы для получения дополнительной информации</p>
                            </div>
                            <button class="separator-cta" onclick="changeSlide(1)">Начать путешествие →</button>
                        </div>
                    </div>
                `
            },

            // СЛАЙД 2 - ТИТУЛЬНЫЙ
            {
                title: "Мастер управления изменениями",
                subtitle: "",
                content: `
                    <div class="hero-intro-slide">
                        <!-- HOOK: Эмоциональный якорь через проблему -->
                        <div class="hero-hook">
                            <h2 class="hook-question">Ваш проект изменений под угрозой?</h2>
                            <div class="hook-problems">
                                <div class="problem-item">
                                    <span class="problem-icon">😰</span>
                                    <p>63% проектов проваливаются</p>
                                </div>
                                <div class="problem-item">
                                    <span class="problem-icon">💸</span>
                                    <p>Миллионы впустую</p>
                                </div>
                                <div class="problem-item">
                                    <span class="problem-icon">🤷</span>
                                    <p>Не знаете, какую модель выбрать</p>
                                </div>
                            </div>
                        </div>

                        <!-- VALUE PROPOSITION: Ценность решения -->
                        <div class="hero-value">
                            <h2>✅ Эта презентация — ваш ответ</h2>
                            <div class="value-cards">
                                <div class="value-card">
                                    <span class="card-icon">🎯</span>
                                    <h3>56 проверенных моделей</h3>
                                    <p>От Левина 1947 до AI 2025</p>
                                </div>
                                <div class="value-card">
                                    <span class="card-icon">🛠️</span>
                                    <h3>5 интерактивных инструментов</h3>
                                    <p>Квиз, ROI, Диагностика, Конструктор, PCT</p>
                                </div>
                                <div class="value-card">
                                    <span class="card-icon">⚡</span>
                                    <h3>Практическое применение</h3>
                                    <p>Выберите модель за 20 минут</p>
                                </div>
                            </div>
                        </div>
                    </div>
                `
            },
            
            // СЛАЙД 2 - КЛАССИФИКАЦИЯ
            {
                title: "Классификация: Как распределены 56 моделей",
                subtitle: "Четыре основные категории для каждого сценария",
                content: `
                    <div class="grid-2">
                        <div class="card">
                            <span class="type-badge type-contextual">КОНТЕКСТНЫЕ МОДЕЛИ</span>
                            <h3>15 Моделей</h3>
                            <p><strong>Стратегические, макро-подходы</strong></p>
                            <ul style="margin-top: 12px; list-style: none;">
                                <li>→ Модель Левина</li>
                                <li>→ Коттер 8-этапов</li>
                                <li>→ Модель Сатир</li>
                                <li>→ Переход Бриджеса</li>
                            </ul>
                        </div>
                        <div class="card">
                            <span class="type-badge type-highlevel">ВЫСОКОУРОВНЕВЫЕ МОДЕЛИ</span>
                            <h3>10 Моделей</h3>
                            <p><strong>Концептуальные Рамки</strong></p>
                            <ul style="margin-top: 12px; list-style: none;">
                                <li>→ Бекхард и Харрис</li>
                                <li>→ Модель Pritchett</li>
                                <li>→ Модель Carnall</li>
                            </ul>
                        </div>
                        <div class="card">
                            <span class="type-badge type-actionable">ДЕЙСТВЕННЫЕ МОДЕЛИ</span>
                            <h3>26 Моделей</h3>
                            <p><strong>Пошаговые, подробные методологии</strong></p>
                            <ul style="margin-top: 12px; list-style: none;">
                                <li>→ АДКАР</li>
                                <li>→ АИМ</li>
                                <li>→ ГЕ КАП</li>
                                <li>→ PDCA</li>
                                <li>→ Гибридный подход</li>
                            </ul>
                        </div>
                        <div class="card">
                            <span class="type-badge type-supporting">ВСПОМОГАТЕЛЬНЫЕ МОДЕЛИ</span>
                            <h3>8 Моделей</h3>
                            <p><strong>Инструменты и методологии поддержки</strong></p>
                            <ul style="margin-top: 12px; list-style: none;">
                                <li>→ Теория подталкивания</li>
                                <li>→ AI-усиленный</li>
                                <li>→ Теории изменений</li>
                            </ul>
                        </div>
                    </div>
                    <div class="highlight-box" style="margin-top: 32px;">
                        <strong style="font-size: 18px;">Всего: 56 моделей, охватывающих каждый сценарий организационных изменений</strong>
                    </div>
                `
            },
            
            // СЛАЙД 3 - ЭВОЛЮЦИЯ
            {
                title: "История развития: 75 лет эволюции",
                subtitle: "От научного управления до ИИ-усиленных подходов",
                content: `
                    <div class="interactive-timeline" id="timelineContainer">
                        <div class="timeline-track" id="timelineTrack"></div>
                        <div class="timeline-details-card" id="timelineDetails">
                            <h3 id="timelineTitle">История управления изменениями</h3>
                            <p id="timelineSummary">Выберите период на временной шкале, чтобы увидеть ключевые акценты эпохи и используемые модели.</p>
                            <ul id="timelineHighlights"></ul>
                        </div>
                    </div>
                `
            },

            // СЛАЙД 4 - КЛЮЧЕВЫЕ ТРЕНДЫ 2025
            {
                title: "7 Основных Трендов Управления Изменениями в 2025",
                subtitle: "Что формирует будущее управления изменениями",
                content: `
                    <div class="grid-2">
                        <div class="card">
                            <div class="icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <rect x="3" y="7" width="18" height="10" rx="3"></rect>
                                    <circle cx="9" cy="12" r="1.5"></circle>
                                    <circle cx="15" cy="12" r="1.5"></circle>
                                    <line x1="7" y1="5" x2="7" y2="7.5"></line>
                                    <line x1="17" y1="5" x2="17" y2="7.5"></line>
                                    <line x1="7" y1="16.5" x2="7" y2="19"></line>
                                    <line x1="17" y1="16.5" x2="17" y2="19"></line>
                                    <line x1="3" y1="12" x2="1.5" y2="12"></line>
                                    <line x1="22.5" y1="12" x2="21" y2="12"></line>
                                </svg>
                            </div>
                            <h3>1. ИСКУССТВЕННЫЙ ИНТЕЛЛЕКТ КАК ИНСТРУМЕНТ</h3>
                            <p>ИИ - это не только предмет изменений, но и инструмент для управления ими. Применение: Анализ настроений, прогнозная аналитика, адаптивная коммуникация. Компании с ИИ видят на 25-30% выше успешность внедрения.</p>
                        </div>
                        <div class="card">
                            <div class="icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M21 8.25c0-2.35-1.86-4.25-4.15-4.25-1.66 0-3.16 0.98-3.85 2.45-0.69-1.47-2.19-2.45-3.85-2.45C5.86 4 4 5.9 4 8.25c0 4.04 3.64 7.19 8 11 4.36-3.81 8-6.96 8-11z"></path>
                                </svg>
                            </div>
                            <h3>2. ЧЕЛОВЕК В ЦЕНТРЕ (Несмотря на Технологию)</h3>
                            <p>Эмоции, психология и психологическая безопасность остаются решающими. Люди - это главный фактор успеха или неудачи изменений. Подход: Модели Сатир, R2P2, Мауэра.</p>
                        </div>
                        <div class="card">
                            <div class="icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <polyline points="11 2 5 13 11 13 9 22 19 9 13 9 15 2"></polyline>
                                </svg>
                            </div>
                            <h3>3. СКОРОСТЬ И ГИБКОСТЬ КАК НОВЫЙ СТАНДАРТ</h3>
                            <p>Гибридные модели (Waterfall + Agile) становятся нормой. Рынки меняются быстро, нужна адаптивность. Результат: Большие планы + быстрая реализация + коррекции.</p>
                        </div>
                        <div class="card">
                            <div class="icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M12 21c-4.8-1.5-8-6.02-8-10.8V6.2L12 3l8 3.2v4.98c0 4.78-3.2 9.3-8 10.8z"></path>
                                    <polyline points="9.5 12.5 12 15.5 15.5 10.5"></polyline>
                                </svg>
                            </div>
                            <h3>4. ГЛУБОКОЕ ПОНИМАНИЕ ТИПОВ СОПРОТИВЛЕНИЯ</h3>
                            <p>Не всё сопротивление одинаково - 3 различных уровня. Уровень 1: "Я не понимаю", Уровень 2: "Мне это не нравится", Уровень 3: "Я вам не доверяю". Решение: Диагностика перед действием.</p>
                        </div>
                        <div class="card">
                            <div class="icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <circle cx="12" cy="8.5" r="3.5"></circle>
                                    <path d="M6 19c0-3.3 2.7-6 6-6s6 2.7 6 6"></path>
                                </svg>
                            </div>
                            <h3>5. ПЕРСОНАЛИЗАЦИЯ И ИНДИВИДУАЛЬНОСТЬ</h3>
                            <p>Каждый сотрудник - уникальный путь, не один размер для всех. Модель R2P2: Роль, Причина, Путь, Партнер для каждого человека. Технология: AI помогает масштабировать персонализацию.</p>
                        </div>
                        <div class="card">
                            <div class="icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <circle cx="12" cy="12" r="9"></circle>
                                    <path d="M3 12h18"></path>
                                    <path d="M12 3c2.6 2.8 3.9 6 3.9 9s-1.3 6.2-3.9 9"></path>
                                    <path d="M12 3c-2.6 2.8-3.9 6-3.9 9s1.3 6.2 3.9 9"></path>
                                </svg>
                            </div>
                            <h3>6. ГИБРИДНАЯ РАБОТА ТРЕБУЕТ НОВЫХ ПОДХОДОВ</h3>
                            <p>Удалённые команды нуждаются в структурированной виртуальной поддержке. Вызов: Меньше личных контактов, больше цифровых инструментов. Решение: Асинхронная коммуникация, виртуальные коучи.</p>
                        </div>
                        <div class="card">
                            <div class="icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M5 6h6a2 2 0 0 1 2 2v12"></path>
                                    <path d="M19 6h-6a2 2 0 0 0-2 2v12"></path>
                                    <path d="M5 6v12.5c0-0.8 0.6-1.5 1.4-1.5H11"></path>
                                    <path d="M19 6v12.5c0-0.8-0.6-1.5-1.4-1.5H13"></path>
                                </svg>
                            </div>
                            <h3>7. НЕПРЕРЫВНОЕ ОБУЧЕНИЕ И АДАПТАЦИЯ</h3>
                            <p>Изменение - это спираль, а не конечная точка. Культура: PDCA циклы, "быстро ошибаться - быстро учиться". Результат: Организационная способность &gt; отдельные проекты.</p>
                        </div>
                    </div>
                `
            },

            // СЛАЙД 5 - ЧТО ТРЕБУЕТСЯ ДЛЯ УСПЕХА
            {
                title: "7 столпов успешного управления изменениями в 2025",
                subtitle: "Основные элементы для эффективного лидерства",
                content: `
                    <div class="grid-2">
                        <div class="card">
                            <h3>1. Комбинированный Подход к Моделям</h3>
                            <p>Выберите правильный микс моделей для вашей конкретной ситуации. Ни одна модель не подходит для всех сценариев.</p>
                        </div>
                        <div class="card">
                            <h3>2. Понимание Человеческой Психологии</h3>
                            <p>Признайте эмоциональное путешествие, которое люди переживают во время изменений. Работайте со страхами, сопротивлением и опасениями с эмпатией.</p>
                        </div>
                        <div class="card">
                            <h3>3. Гибкость и Адаптивность</h3>
                            <p>Будьте готовы быстро менять курс, когда обстоятельства изменяются. Встраивайте циклы обратной связи и механизмы корректировки.</p>
                        </div>
                        <div class="card">
                            <h3>4. Технология как Инструмент</h3>
                            <p>Используйте AI и цифровые инструменты для улучшения принятия решений, но не заменяйте человеческое суждение и эмпатию.</p>
                        </div>
                        <div class="card">
                            <h3>5. Непрерывное Обучение</h3>
                            <p>Установите циклы обратной связи на каждом этапе. Учитесь на неудачах и успехах для постоянного улучшения.</p>
                        </div>
                        <div class="card">
                            <h3>6. Доверие и Психологическая Безопасность</h3>
                            <p>Создайте среду, в которой люди чувствуют себя в безопасности, чтобы выражать опасения, задавать вопросы и рисковать.</p>
                        </div>
                        <div class="card">
                            <h3>7. Структурированная Личная Поддержка</h3>
                            <p>Обеспечьте каждого человека ясностью относительно их Роли, Причины изменения, Пути вперед и Партнера для поддержки (R2P2).</p>
                        </div>
                    </div>
                `
            },

            // SLIDE 6 - MODEL SELECTION GUIDE
            {
                title: "Матрица выбора модели",
                subtitle: "Практические рекомендации по выбору правильной модели (кликните на строку для перехода)",
                content: `
                    <div class="chart-container">
                        <h3 style="margin-bottom: 16px; color: var(--pres-primary);">Выберите Свою Модель на Основе Ситуации</h3>
                        <p style="font-size: 13px; color: var(--color-text-secondary); margin-bottom: 16px;">💡 Нажмите на любую строку, чтобы перейти к первой рекомендуемой модели</p>
                        <table class="matrix-table">
                            <thead>
                                <tr>
                                    <th>Сценарий</th>
                                    <th>Рекомендуемые Модели</th>
                                    <th>Почему</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="matrix-row" onclick="jumpToSlide(58)" title="Кликните для перехода к модели PDCA">
                                    <td><strong>Малые/Средние Изменения</strong></td>
                                    <td>Цикл PDCA, Теория Подталкивания, R2P2</td>
                                    <td>Быстрая итерация, минимальные разрушения, поведенческий фокус</td>
                                </tr>
                                <tr class="matrix-row" onclick="jumpToSlide(61)" title="Кликните для перехода к Гибридной модели">
                                    <td><strong>Крупные Организационные Изменения</strong></td>
                                    <td>Гибридная, 8-Шагов Коттера, ADKAR, Canvas</td>
                                    <td>Комплексная структура, проверено в масштабе, вовлечение стейкхолдеров</td>
                                </tr>
                                <tr class="matrix-row" onclick="jumpToSlide(59)" title="Кликните для перехода к модели Мауэра">
                                    <td><strong>Ожидается Высокое Сопротивление</strong></td>
                                    <td>3 Уровня Мауэра, Модель Сатир, Теория Подталкивания</td>
                                    <td>Работа с эмоциональным сопротивлением, диагностический подход, мягкое влияние</td>
                                </tr>
                                <tr class="matrix-row" onclick="jumpToSlide(61)" title="Кликните для перехода к Гибридной модели">
                                    <td><strong>Быстро Меняющаяся Среда</strong></td>
                                    <td>Гибридная, PDCA, Agile Управление</td>
                                    <td>Гибкость, итеративность, быстрые циклы обратной связи</td>
                                </tr>
                                <tr class="matrix-row" onclick="jumpToSlide(62)" title="Кликните для перехода к AI-Усиленной модели">
                                    <td><strong>Внедрение Технологий/AI</strong></td>
                                    <td>AI-Усиленный, ADKAR, R2P2, PDCA</td>
                                    <td>Технологичность, персонализированная поддержка, непрерывное обучение</td>
                                </tr>
                                <tr class="matrix-row" onclick="jumpToSlide(56)" title="Кликните для перехода к модели Сатир">
                                    <td><strong>Культурная Трансформация</strong></td>
                                    <td>Сатир, Позитивный Поиск, Сенге</td>
                                    <td>Глубокая эмоциональная работа, основанный на ценностях, системное мышление</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                `

            },

            // СЛАЙД - РАЗДЕЛИТЕЛЬ: ПРАКТИКА - ОЦЕНИТЕ СВОЙ ПРОЕКТ
            {
                title: "Практика: Оцените свой проект",
                subtitle: "Интерактивные инструменты для комплексной оценки и планирования",
                content: `
                    <div class="section-separator practice-separator">
                        <div class="separator-hero">
                            <div class="hero-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"></path>
                                </svg>
                            </div>
                            <h1 class="separator-title">Оцените свой проект</h1>
                            <p class="separator-subtitle">Комплексная диагностика и планирование изменений в 5 шагов</p>
                        </div>

                        <div class="practice-tools">
                            <div class="practice-tool-card">
                                <h4>Мини-диагностика</h4>
                                <p>Ответьте на 3 вопроса и получите персональные рекомендации по выбору модели управления изменениями.</p>
                                <span class="tool-duration">5 мин</span>
                            </div>

                            <div class="practice-tool-card">
                                <h4>Калькулятор ROI</h4>
                                <p>Рассчитайте экономическую эффективность внедрения управления изменениями в вашем проекте.</p>
                                <span class="tool-duration">10 мин</span>
                            </div>

                            <div class="practice-tool-card">
                                <h4>Диагностика готовности</h4>
                                <p>Оцените текущую готовность вашей организации к успешному внедрению изменений.</p>
                                <span class="tool-duration">15 мин</span>
                            </div>

                            <div class="practice-tool-card">
                                <h4>Конструктор модели</h4>
                                <p>Создайте собственную модель управления изменениями из лучших практик разных подходов.</p>
                                <span class="tool-duration">20 мин</span>
                            </div>

                            <div class="practice-tool-card">
                                <h4>PCT Оценка</h4>
                                <p>Комплексная диагностика проекта по четырем аспектам: успех, лидерство, управление проектом и изменения.</p>
                                <span class="tool-duration">25 мин</span>
                            </div>
                        </div>

                        <div class="separator-navigation">
                            <button class="separator-cta" onclick="jumpToSlide(65)">🚀 Начать комплексную оценку</button>
                        </div>
                    </div>
                `

            }
        ];

        baseSlidesCount = slidesData.length;

        // Classical Models Data (Models 1-47)
        const classicalModels = [
            {
                name: "Модель АИМ (Методология Ускоренной Реализации)",
                type: "Действенная",
                developer: "ARMOUR, 1990-е годы",
                description: "Процесс реализации стратегического изменения для управления рисками в организации",
                phases: [
                    "1. Определить изменение",
                    "2. Оценить климат организации",
                    "3. Сгенерировать спонсорство",
                    "4. Построить план коммуникации",
                    "5. Определить подход к изменению",
                    "6. Приоритизировать действия",
                    "7. Построить агентов изменения",
                    "8. Развить целевую готовность",
                    "9. Реализовать",
                    "10. Мониторить и развить подкрепление"
                ],
                whenToUse: "Быстрая реализация стратегических проектов, высокие риски требующие управления, внедрение критичных инициатив",
                bestFor: "Крупные корпорации, критичные изменения, высокие риски",
                complexity: "Высокая",
                scale: "Крупный",
                duration: "6-12 мес",
                focus: "Стратегия"
            },
            {
                name: "Стандарт ACMP (Управление Изменениями)",
                type: "Вспомогательная",
                developer: "Институт ACMP, 2014 год",
                description: "Глобальный стандарт лучших практик в управлении организационными изменениями",
                phases: [
                    "1. Оценка влияния и готовности организации",
                    "2. Формулирование стратегии управления",
                    "3. Разработка планов управления",
                    "4. Исполнение планов управления",
                    "5. Закрытие усилий управления"
                ],
                whenToUse: "Стандартизация процессов, профессионализм команды, измеримость результатов, соответствие глобальным практикам",
                bestFor: "Многонациональные корпорации, сертификация, стандартизация"
            },
            {
                name: "Фреймворк Change Delta",
                type: "Действенная",
                developer: "ARMOUR, 2000-е годы",
                description: "Комплексный целостный подход к управлению изменениями, концентрирующий ресурсы на наиболее важных элементах",
                phases: [
                    "1. ИСПОЛНЕНИЕ - Портфельный подход, прозрачность статуса, раннее действие",
                    "2. СПОНСОРСТВО И УПРАВЛЕНИЕ - Четкая структура управления, явные роли",
                    "3. РАСШИРЕНИЕ ВОЗМОЖНОСТЕЙ ЛИДЕРОВ - Инструменты и ответственность",
                    "4. ВОВЛЕЧЁННАЯ ОРГАНИЗАЦИЯ - Готовые, желающие, способные сотрудники"
                ],
                whenToUse: "Крупные программы трансформации, управление несколькими проектами, требуется уверенность в реализации",
                bestFor: "Крупные корпоративные трансформации, портфельное управление"
            },
            {
                name: "Формула Бекхарда и Харриса",
                type: "Вспомогательная",
                developer: "Дэвид Бекхард, Рубен Харрис, 1987 год",
                description: "Лаконичная формула для определения факторов успеха организационных изменений: Изменение = (A × B × C) > D, где A=Неудовлетворенность, B=Практичность, C=Видение, D=Затраты",
                phases: [
                    "A = Уровень неудовлетворенности текущим состоянием",
                    "B = Практичность решения и минимальный риск",
                    "C = Четкое видение желаемого будущего",
                    "D = Воспринимаемые затраты на реализацию",
                    "Произведение A, B и C должно быть больше D для успеха"
                ],
                whenToUse: "Диагностика готовности к изменениям, определение сопротивления, быстрая оценка потенциала успеха",
                bestFor: "Быстрая диагностика, планирование коммуникации"
            },
            {
                name: "Процесс Бекхарда и Харриса",
                type: "Высокоуровневая",
                developer: "Дэвид Бекхард, Рубен Харрис, 1987 год",
                description: "Пятиэтапный процесс управления организационными изменениями",
                phases: [
                    "1. АНАЛИЗ ОРГАНИЗАЦИИ - Выявление сил за и против, оценка ситуации",
                    "2. ОПРЕДЕЛЕНИЕ ПОЧЕМУ ИЗМЕНЕНИЯ - Необходимость, выбор, видение",
                    "3. АНАЛИЗ РАЗРЫВА - Текущее vs желаемое, выявление пробелов",
                    "4. ПЛАНИРОВАНИЕ ДЕЙСТВИЙ - Определение работы, ответственности, временной шкалы",
                    "5. УПРАВЛЕНИЕ ПЕРЕХОДОМ - Реализация, коммуникация, мониторинг"
                ],
                whenToUse: "Комплексный анализ перед большими изменениями, организационные трансформации, учет людской стороны",
                bestFor: "Системный подход, большие организационные изменения"
            },
            {
                name: "Модель Переходного Состояния Бекхарда",
                type: "Контекстная",
                developer: "Дэвид Бекхард, 1987 год",
                description: "Модель трёх состояний организации при переходе через изменение",
                phases: [
                    "1. ТЕКУЩЕЕ СОСТОЯНИЕ - Знакомое и комфортное, процессы понятны, роли ясны",
                    "2. СОСТОЯНИЕ ПЕРЕХОДА - Максимальная неопределённость, риск падения производительности, требует интенсивной поддержки",
                    "3. БУДУЩЕЕ СОСТОЯНИЕ - Новый порядок установлен, роли переопределены, новые возможности"
                ],
                whenToUse: "Понимание психологии переходов, управление стадией нейтральной зоны, планирование поддержки людей",
                bestFor: "Значительные организационные изменения, реструктуризация"
            },
            {
                name: "Модель Булока и Баттена",
                type: "Действенная",
                developer: "Robert Bullock, Daryl Batten, 1985 год",
                description: "Четырёхэтапная модель запланированного организационного изменения",
                phases: [
                    "1. ИССЛЕДОВАНИЕ - Проверка необходимости, сканирование среды, сбор информации, приобретение ресурсов",
                    "2. ПЛАНИРОВАНИЕ - Вовлечение ключевых лиц, диагностика проблем, разработка решений",
                    "3. ДЕЙСТВИЕ - Завершение работ согласно плану, механизмы обратной связи, мониторинг прогресса",
                    "4. ИНТЕГРАЦИЯ - Выравнивание с другими областями, формализация через политики, встраивание в культуру"
                ],
                whenToUse: "Организации с технической культурой, процессно-ориентированные изменения, системные улучшения",
                bestFor: "Технические трансформации, оптимизация процессов"
            },
            {
                name: "Модель Драйверов Burke-Litwin",
                type: "Контекстная",
                developer: "W. Warner Burke, George Litwin, 1992 год",
                description: "Модель девяти взаимосвязанных факторов организационной производительности",
                phases: [
                    "1. ВНЕШНЯЯ СРЕДА - Рынок, технология, конкуренция (наиболее важная)",
                    "2. МИССИЯ И СТРАТЕГИЯ - Определение целей и направления",
                    "3. ЛИДЕРСТВО - Качество руководства, видение и решимость",
                    "4. ОРГАНИЗАЦИОННАЯ КУЛЬТУРА - Ценности, убеждения, нормы",
                    "5. СТРУКТУРА - Организационный дизайн, распределение ответственности",
                    "6. КЛИМАТ - Моральный дух, мотивация, психологическая безопасность",
                    "7. ТРЕБОВАНИЯ К ЗАДАЧАМ И НАВЫКИ - Компетентность",
                    "8. ИНДИВИДУАЛЬНЫЕ ПОТРЕБНОСТИ - Личные стремления",
                    "9. МОТИВАЦИЯ СОТРУДНИКОВ - Энергия и приверженность"
                ],
                whenToUse: "Анализ системных взаимосвязей, определение полного спектра факторов, понимание сложности систем",
                bestFor: "Системный анализ, крупные трансформации"
            },
            {
                name: "Модель Карнала",
                type: "Высокоуровневая",
                developer: "Cary Carnall, 1990 год",
                description: "Три ключевые области мастерства для успешного управления изменениями",
                phases: [
                    "1. ЭФФЕКТИВНОЕ УПРАВЛЕНИЕ ПЕРЕХОДАМИ - Понимание этапов, поддержка людей",
                    "2. РАБОТА С ОРГАНИЗАЦИОННЫМИ КУЛЬТУРАМИ - Понимание текущей культуры, влияние на культурные сдвиги",
                    "3. КОНСТРУКТИВНОЕ УПРАВЛЕНИЕ ОРГАНИЗАЦИОННОЙ ПОЛИТИКОЙ - Динамика власти, коалиции поддержки"
                ],
                whenToUse: "Культурные изменения, организационные трансформации, управление сложными системами",
                bestFor: "Комплексные культурные и организационные изменения"
            },
            {
                name: "Методология CHAMPS2",
                type: "Действенная",
                developer: "ARMOUR, 2000-е годы",
                description: "Восьмифазная методология для трансформационных организационных изменений",
                phases: [
                    "0. ИНИЦИИРОВАНИЕ ТРАНСФОРМАЦИИ - Определение необходимости, формирование видения",
                    "1. ВИДЕНИЕ - Создание четкого видения, артикуляция желаемого состояния",
                    "2. ФОРМИРОВАНИЕ И ПЛАНИРОВАНИЕ - Формирование рабочих групп, детальное планирование",
                    "3. ДИЗАЙН - Проектирование новых процессов, дизайн структуры",
                    "4. СОЗДАНИЕ И РЕАЛИЗАЦИЯ УСЛУГИ - Физическое создание новых систем",
                    "5. ПРЕДОСТАВЛЕНИЕ И ПЕРЕХОД - Переход от старого к новому",
                    "6. СТАБИЛИЗАЦИЯ - Решение проблем, оптимизация, закрепление",
                    "7. РЕАЛИЗАЦИЯ ВЫГОД - Измерение результатов, демонстрация ценности"
                ],
                whenToUse: "Масштабные трансформационные программы, комплексные системные изменения, требуется фазированный подход",
                bestFor: "Масштабные трансформационные программы"
            },
            {
                name: "Дорожная Карта Лидеров Изменений (CLRM)",
                type: "Действенная",
                developer: "ChangeFirst, 2000-е годы",
                description: "Интеграция контентной работы с работой с людьми для управления изменениями",
                phases: [
                    "1. ОЦЕНИТЬ СИТУАЦИЮ - Определить требования дизайна, выявить вызовы",
                    "2. СПРОЕКТИРОВАТЬ ЖЕЛАЕМОЕ СОСТОЯНИЕ - Определить целевые процессы",
                    "3. ПРОВЕСТИ АНАЛИЗ ВЛИЯНИЯ - Определить затронутые группы",
                    "4. СПЛАНИРОВАТЬ И ОРГАНИЗОВАТЬ РЕАЛИЗАЦИЮ - Разработать план",
                    "5. РЕАЛИЗОВАТЬ ИЗМЕНЕНИЕ - Выполнить план, коммуницировать",
                    "6. ОБУЧИТЬСЯ И ОТКОРРЕКТИРОВАТЬ КУРС - Собрать обратную связь",
                    "7. ОТПРАЗДНОВАТЬ И ИНТЕГРИРОВАТЬ - Признать достижения, встроить в культуру"
                ],
                whenToUse: "Комбинированные технические и людские изменения, требуется анализ влияния, высокое потенциальное сопротивление",
                bestFor: "Балансирование процессных и человеческих аспектов"
            },
            {
                name: "Институт Управления Изменениями (CMI)",
                type: "Вспомогательная",
                developer: "Change Management Institute, 2014 год",
                description: "База знаний и модель зрелости для управления изменениями",
                phases: [
                    "Охватывает 9 областей: теории изменений, управление выгодами, стратегии заинтересованных сторон, коммуникация",
                    "МОДЕЛЬ ЗРЕЛОСТИ (5 уровней): 1-Нулевой опыт, 2-Начальный, 3-Компетентный, 4-Опытный, 5-Лидер мнений",
                    "Оценка компетентности управления в организации",
                    "Определение пути развития и сертификация специалистов"
                ],
                whenToUse: "Развитие компетентности, стандартизация процессов, профессионализм команды",
                bestFor: "Развитие компетентности, стандартизация, сертификация"
            },
            {
                name: "Методология Исполнения Изменений (CEM)",
                type: "Действенная",
                developer: "Conner Partners, 1990-е годы",
                description: "Четырёхфазная методология для управления людской стороной изменений",
                phases: [
                    "1. РЕШЕНИЕ (Decide) - Принятие решения, определение целей. Фокус: Намерение, Люди, Доставка",
                    "2. ОПРЕДЕЛЕНИЕ (Define) - Определение деталей, анализ влияния. Фокус: Детали, Затронутые, Подход",
                    "3. РЕАЛИЗАЦИЯ (Implement) - Внедрение изменения, поддержка. Фокус: Поддержка людей, Потребности, Ресурсы",
                    "4. УСТОЙЧИВОСТЬ (Sustain) - Поддержание результатов, закрепление. Фокус: Закрепление, Мотивация, Механизмы"
                ],
                whenToUse: "Управление людской стороной, фокус на сопротивлении, поддержка сотрудников",
                bestFor: "Люди-ориентированные изменения"
            },
            {
                name: "Позитивный Поиск (Appreciative Inquiry)",
                type: "Контекстная",
                developer: "David Cooperrider, 1980-е годы",
                description: "Подход, основанный на позитивном ядре организации и её способностях. Системы движутся в направлении того, что они изучают и ценят",
                phases: [
                    "1. ОТКРЫТИЕ (Discovery) - Мобилизация исследования позитивного ядра, выявление что работает хорошо",
                    "2. МЕЧТА (Dream) - Создание четкого видения результатов, формулирование амбициозного видения",
                    "3. ДИЗАЙН (Design) - Создание предложений возможности идеальной организации",
                    "4. СУДЬБА (Destiny) - Укрепление аффирмативной способности системы, реализация видения"
                ],
                whenToUse: "Культурные изменения, необходимо вовлечение и энтузиазм, позитивный переход, построение доверия",
                bestFor: "Культурные изменения, вовлечение, позитивные трансформации"
            },
            {
                name: "Модель Каммингса и Ворли",
                type: "Высокоуровневая",
                developer: "Thomas Cummings, Christopher Worley, 1990-е годы",
                description: "Шесть рекомендаций для успешного управления организационными изменениями",
                phases: [
                    "1. ФОРМУЛИРОВАТЬ ЧЕТКОЕ СТРАТЕГИЧЕСКОЕ ВИДЕНИЕ - Определить ясное видение и стратегическое направление",
                    "2. ДЕМОНСТРИРОВАТЬ ПРИВЕРЖЕННОСТЬ ВЫСШЕГО РУКОВОДСТВА - Активное участие, видимая поддержка",
                    "3. МОДЕЛИРОВАТЬ ИЗМЕНЕНИЕ КУЛЬТУРЫ НА ВЫСШЕМ УРОВНЕ - Демонстрация новых поведений",
                    "4. МОДИФИЦИРОВАТЬ ОРГАНИЗАЦИЮ для ПОДДЕРЖКИ ИЗМЕНЕНИЙ - Структурные и системные изменения",
                    "5. ОТБИРАТЬ И СОЦИАЛИЗИРОВАТЬ НОВИЧКОВ - Найм сторонников изменений",
                    "6. РАЗВИВАТЬ ЭТИЧЕСКУЮ И ПРАВОВУЮ ЧУВСТВИТЕЛЬНОСТЬ - Этичный подход к изменениям"
                ],
                whenToUse: "Комплексный подход к изменениям, фокус на культуре, системное выравнивание",
                bestFor: "Системный и культурный подход к изменениям"
            },
            {
                name: "DeltaV (DECIPHER)",
                type: "Действенная",
                developer: "Decipher, 2000-е годы",
                description: "Гибкая, нелинейная модель управления сложными изменениями. Модель не линейна - можно двигаться вперед и назад",
                phases: [
                    "1. ОПРЕДЕЛИТЬ БУДУЩЕЕ - Создать видение желаемого состояния",
                    "2. ВОВЛЕЧЬ ЛИДЕРОВ - Построить коалицию лидеров изменений",
                    "3. ВЫЛОЖИТЬ ДОРОЖНУЮ КАРТУ - Определить фазы реализации",
                    "4. РАССКАЗАТЬ ИСТОРИЮ - Коммуницировать видение через истории",
                    "5. ДЕЙСТВОВАТЬ - Начать реализацию",
                    "6-9. ОЦЕНИТЬ, ОТКОРРЕКТИРОВАТЬ, ПОДТВЕРДИТЬ, ПРЕДУГАДАТЬ следующую волну"
                ],
                whenToUse: "Сложные, непредсказуемые изменения, быстро меняющейся среде, необходима адаптивность",
                bestFor: "Гибкое управление сложными изменениями"
            },
            {
                name: "Реализация Запланированного Изменения Корнелиуса",
                type: "Высокоуровневая",
                developer: "Edwin Cornelius III, 1990-е годы",
                description: "Четыре ключевых ингредиента для успешного внедрения запланированного изменения (Все четыре необходимы)",
                phases: [
                    "1. ПОНИМАНИЕ - Люди должны понимать необходимость изменения, что это, почему, как затрагивает",
                    "2. НАВЫКИ - Люди должны иметь навыки для успешного изменения, практика и развитие",
                    "3. СРЕДА - Среда должна поддерживать новое поведение, удаление барьеров",
                    "4. МОТИВАЦИЯ - Люди должны быть мотивированы, понимание выгоды, признание и награды"
                ],
                whenToUse: "Диагностика готовности к изменениям, определение пробелов в подходе, обеспечение полноты подхода",
                bestFor: "Диагностика готовности, обеспечение полноты подхода"
            },
            {
                name: "Модель Совершенства EFQM (RADAR)",
                type: "Контекстная",
                developer: "European Foundation for Quality Management, 1991 год",
                description: "Модель совершенства с инструментом систематического улучшения организаций",
                phases: [
                    "ФУНДАМЕНТАЛЬНЫЕ КОНЦЕПЦИИ: Ориентация на результаты, Фокус на клиенте, Лидерство",
                    "КРИТЕРИИ (8 областей): Лидерство, Стратегия, Люди, Партнерства, Процессы, Результаты",
                    "ЛОГИКА RADAR: R=Результаты, A=Подходы, D=Развертывание, A=Оценка, R=Совершенствование"
                ],
                whenToUse: "Стандартизация и совершенствование, организационное развитие, комплексная оценка производительности",
                bestFor: "Системный подход к совершенству и улучшению"
            },
            {
                name: "Колесо Девяти Клиньев Галпина",
                type: "Действенная",
                developer: "Timothy M. Galpin, 1996 год",
                description: "Девятиэтапное колесо управления изменениями с фундаментом культуры",
                phases: [
                    "1. УСТАНОВЛЕНИЕ НЕОБХОДИМОСТИ ИЗМЕНЕНИЙ - Определить почему необходимо",
                    "2. РАЗВИТИЕ И РАСПРОСТРАНЕНИЕ ВИДЕНИЯ - Создать привлекательное видение",
                    "3. ДИАГНОСТИКА И АНАЛИЗ ТЕКУЩЕЙ СИТУАЦИИ - Анализ текущего состояния",
                    "4. ГЕНЕРИРОВАНИЕ РЕКОМЕНДАЦИЙ - Разработка решений",
                    "5. ДЕТАЛИЗАЦИЯ РЕКОМЕНДАЦИЙ - Конкретизация решений",
                    "6. ПИЛОТНОЕ ТЕСТИРОВАНИЕ - Тест в контролируемых условиях",
                    "7. ПОДГОТОВКА К РАЗВЕРТЫВАНИЮ - Обучение людей",
                    "8. РАЗВЕРТЫВАНИЕ РЕКОМЕНДАЦИЙ - Внедрение решений",
                    "9. ИЗМЕРЕНИЕ, ПОДКРЕПЛЕНИЕ И СОВЕРШЕНСТВОВАНИЕ",
                    "ФУНДАМЕНТ: ПОНИМАНИЕ КУЛЬТУРЫ ОРГАНИЗАЦИИ"
                ],
                whenToUse: "Целостный подход к изменениям, необходимо учитывать культуру, комплексные программы трансформации",
                bestFor: "Целостное управление с учетом культуры"
            },
            {
                name: "Процесс Ускорения Изменений GE (CAP)",
                type: "Действенная",
                developer: "General Electric, 1990-е годы",
                description: "Гибкая, нелинейная методология ускорения организационных изменений. Используется на протяжении ВСЕГО процесса изменений",
                phases: [
                    "1. ВЕДЕНИЕ ИЗМЕНЕНИЙ - Видимая, активная поддержка спонсоров, моделирование нового поведения",
                    "2. СОЗДАНИЕ ОБЩЕЙ НЕОБХОДИМОСТИ - Причина внедряется, широко распространяется понимание",
                    "3. ФОРМИРОВАНИЕ ВИДЕНИЯ - Четкое видение определено, широко понимается",
                    "4. МОБИЛИЗАЦИЯ ПРИВЕРЖЕННОСТИ - Сильная приверженность, инвестирование в изменение",
                    "5. СОЗДАНИЕ ДОЛГОСРОЧНЫХ ИЗМЕНЕНИЙ - Изменения сохраняются, интеграция, ранние победы"
                ],
                whenToUse: "Ускорение организационных изменений, необходимы быстрые результаты, сложные программы трансформации",
                bestFor: "Ускорение изменений, быстрые трансформации"
            },
            {
                name: "Пятиэтапная Модель Джадсона",
                type: "Действенная",
                developer: "Arnold S. Judson, 1966 год",
                description: "Пять фаз управления коммуникацией и принятием организационных изменений",
                phases: [
                    "1. АНАЛИЗ И ПЛАНИРОВАНИЕ ИЗМЕНЕНИЙ - Анализ необходимости, определение целей, планирование подхода",
                    "2. КОММУНИКАЦИЯ ИЗМЕНЕНИЙ - Четкое объяснение, преимущества и выгоды, ответы на вопросы",
                    "3. ПОЛУЧЕНИЕ ПРИНЯТИЯ НОВЫХ ПОВЕДЕНИЙ - Преодоление сопротивления, убеждение",
                    "4. ПЕРЕХОД ОТ СТАТУС-КВО К ЖЕЛАЕМОМУ СОСТОЯНИЮ - Фактический переход, поддержка",
                    "5. КОНСОЛИДАЦИЯ И ИНСТИТУЦИОНАЛИЗАЦИЯ - Закрепление, встраивание в процессы"
                ],
                whenToUse: "Управление принятием изменений, фокус на коммуникации, фокус на сопротивлении",
                bestFor: "Управление людской стороной, принятие изменений"
            },
            {
                name: "Восьмиэтапная Модель Коттера",
                type: "Действенная",
                developer: "John P. Kotter, 1996 год",
                description: "Классическая восьмиэтапная модель управления организационными изменениями. Процесс изменений требует времени и проходит несколько фаз",
                phases: [
                    "1. ПОВЫШЕНИЕ СРОЧНОСТИ - Создание ощущения необходимости, выявление кризисов или возможностей",
                    "2. ПОСТРОЕНИЕ РУКОВОДЯЩЕЙ КОМАНДЫ - Создание коалиции лидеров, включение влиятельных людей",
                    "3. ПОЛУЧЕНИЕ ПРАВИЛЬНОГО ВИДЕНИЯ - Разработка четкого видения целей, видение вдохновляет",
                    "4. КОММУНИКАЦИЯ ДЛЯ ПОКУПКИ - Эффективное доведение видения, использование разных каналов",
                    "5. РАСШИРЕНИЕ ПРАВ И ВОЗМОЖНОСТЕЙ - Удаление барьеров, упрощение процессов",
                    "6. СОЗДАНИЕ КРАТКОСРОЧНЫХ ПОБЕД - Достижение видимых результатов, признание и награда",
                    "7. НЕ ОТПУСТИТЬ - Предотвращение возврата, усиление успехов, продолжение мотивации",
                    "8. ЗАКРЕПИТЬ ИЗМЕНЕНИЯ - Интеграция в культуру, встраивание в процессы"
                ],
                whenToUse: "Большие стратегические организационные изменения, требуется структурированный подход, необходимо многоэтапное управление",
                bestFor: "Крупные корпоративные трансформации"
            },
            {
                name: "Модель Кривой Изменений Кюблер-Росс",
                type: "Контекстная",
                developer: "Elisabeth Kübler-Ross, 1960-е годы (Адаптирована для организационных изменений в 1980-х)",
                description: "Модель пяти эмоциональных стадий в ответ на изменения. Первоначально разработана для объяснения процесса горевания",
                phases: [
                    "1. ОТРИЦАНИЕ - Шок, непринятие. Поведение: не верит в необходимость. Задача: Информация и факты",
                    "2. ГНЕВ - Раздражение, возмущение. Поведение: Активное сопротивление. Задача: Признать чувства",
                    "3. ТОРГОВЛЯ - Надежда договориться. Поведение: Попытка найти компромисс. Задача: Слушать предложения",
                    "4. ДЕПРЕССИЯ - Печаль, потеря. Поведение: Снижение производительности. Задача: Психологическая поддержка",
                    "5. ПРИНЯТИЕ - Спокойствие, адаптация. Поведение: Принятие нового состояния. Задача: Постоянное подкрепление"
                ],
                whenToUse: "Значительные, болезненные изменения, изменения связанные с потерей рабочих мест, реструктуризация",
                bestFor: "Управление эмоциональными реакциями, сочувствие, поддержка"
            },
            {
                name: "Методология Управления Изменениями LaMarsh Global",
                type: "Действенная",
                developer: "LaMarsh Global, 1990-е годы",
                description: "Методология управления изменениями, сосредоточенная на людской стороне для снижения сопротивления. Фокус: идентификация, анализ и смягчение сопротивления сотрудников",
                phases: [
                    "1. ОПРЕДЕЛИТЬ ИЗМЕНЕНИЕ - Четко определить что изменяется, выявить причины, целевое состояние",
                    "2. ПОДГОТОВИТЬ ИЗМЕНЕНИЕ - Подготовить спонсоров, построить команду, разработать коммуникационную стратегию",
                    "3. СПЛАНИРОВАТЬ ИЗМЕНЕНИЕ - Анализ влияния на людей, определение сопротивления",
                    "4. РЕАЛИЗОВАТЬ ИЗМЕНЕНИЕ - Выполнение плана, коммуникация, преодоление сопротивления",
                    "5. ПОДДЕРЖИВАТЬ ИЗМЕНЕНИЕ - Закрепление новых поведений, долгосрочная поддержка"
                ],
                whenToUse: "Ожидается значительное сопротивление, фокус на людской стороне, необходимо управление изменениями",
                bestFor: "Снижение сопротивления, управление людской стороной"
            },
            {
                name: "Трёхэтапная Модель Изменений Левина",
                type: "Контекстная",
                developer: "Курт Левин, 1951 год",
                description: "Первая научная модель организационного изменения. Описывает три психологических состояния процесса. Две движущие и сдерживающие силы влияют на изменение.",
                phases: [
                    "1️⃣ РАЗМОРАЖИВАНИЕ - Создание мотивации к изменению, осознание необходимости, рассмотрение новых идей, снижение сопротивления",
                    "2️⃣ ИЗМЕНЕНИЕ - Внедрение нового поведения и процессов, обучение новым навыкам, период нестабильности",
                    "3️⃣ ЗАМОРАЖИВАНИЕ - Закрепление новых поведений, встраивание в рутину, интеграция в культуру"
                ],
                whenToUse: "Введение в управление изменениями, маленькие и средние изменения, как основа для понимания других моделей",
                bestFor: "Базовое понимание процесса изменений, начальные инициативы"
            },
            {
                name: "Семиступенчатая Модель Изменений",
                type: "Действенная",
                developer: "Липпитт, Ватсон, Вестли, 1958 год",
                description: "Расширенная версия модели Левина с фокусом на роль агента изменений (внутреннего или внешнего консультанта).",
                phases: [
                    "1️⃣ Диагностика проблемы - Определение, что нужно изменить",
                    "2️⃣ Оценка мотивации и готовности к изменению",
                    "3️⃣ Оценка ресурсов и компетентности агента изменений",
                    "4️⃣ Отбор прогрессивных объектов и способов действия",
                    "5️⃣ Направление энергии изменения",
                    "6️⃣ Поддержка изменений и управление сопротивлением",
                    "7️⃣ Постепенное завершение отношений помощи"
                ],
                whenToUse: "Проекты с привлечением внешних консультантов, внутренние агенты изменений, организации нуждающиеся в направлении",
                bestFor: "Управление ролью агента изменений, проекты трансформации"
            },
            {
                name: "Управление Успешными Программами (MSP)",
                type: "Действенная",
                developer: "Office of Government Commerce (Великобритания), 2004 год",
                description: "Комплексная методология для управления портфелями программ трансформации, особенно в государственном секторе.",
                phases: [
                    "1️⃣ ФУНДАМЕНТАЛЬНЫЕ ПРИНЦИПЫ - Видимое спонсорство, полнота и приоритизация",
                    "2️⃣ ТЕМЫ УПРАВЛЕНИЯ - Заинтересованные стороны, преимущества, организационная готовность, управление рисками",
                    "3️⃣ ПОТОК ТРАНСФОРМАЦИИ - Инициирование → Намерение → Трансформирование → Устойчивость"
                ],
                whenToUse: "Крупные программы трансформации, портфельное управление изменениями, государственные и крупные корпоративные проекты",
                bestFor: "Масштабные трансформационные программы, портфельное управление"
            },
            {
                name: "McKinsey Seven-S",
                type: "Контекстная",
                developer: "Том Питерс, Роберт Уотерман (McKinsey), 1980 год",
                description: "Семь взаимосвязанных элементов, определяющих успех организации. Все элементы должны быть в гармонии и поддерживать одна другую.",
                phases: [
                    "ЖЁСТКИЕ: 1️⃣ Стратегия 2️⃣ Структура 3️⃣ Системы",
                    "МЯГКИЕ: 4️⃣ Разделяемые ценности (центр) 5️⃣ Навыки 6️⃣ Персонал 7️⃣ Стиль руководства",
                    "КЛЮЧЕВОЙ ПРИНЦИП: При изменении одного элемента изменяются все остальные"
                ],
                whenToUse: "Комплексная организационная диагностика, планирование трансформации, анализ причин проблем, обеспечение выравнивания",
                bestFor: "Системный анализ, комплексные трансформации, диагностика"
            },
            {
                name: "Модель Конгруэнтности Надлера и Тушмана",
                type: "Контекстная",
                developer: "Дэвид Надлер, Майкл Тушман, 1980 год",
                description: "Организация как системный феномен - все части должны быть согласованы и поддерживать одна другую. Производительность зависит от соответствия четырёх компонентов.",
                phases: [
                    "1️⃣ РАБОТА - Что должна делать организация",
                    "2️⃣ ЛЮДИ - Навыки, способности, ценности, установки",
                    "3️⃣ ФОРМАЛЬНАЯ ОРГАНИЗАЦИЯ - Структура, системы, процессы, политики",
                    "4️⃣ НЕФОРМАЛЬНАЯ ОРГАНИЗАЦИЯ - Культура, лидерство, социальные связи"
                ],
                whenToUse: "Анализ причин проблем в организации, диагностика сопротивления, определение что менять в приоритете",
                bestFor: "Системная диагностика, анализ причин, выравнивание организации"
            },
            {
                name: "Люди-Ориентированная Реализация (PCI)",
                type: "Действенная",
                developer: "ChangeFirst, 2000-е годы",
                description: "Комплексная методология, сосредоточенная на людской стороне внедрения изменений. Успех зависит от людей, а не только от технологии.",
                phases: [
                    "1️⃣ ЛИДЕРСТВО - Видимая поддержка руководства",
                    "2️⃣ ВОВЛЕЧЕНИЕ - Участие людей в планировании",
                    "3️⃣ ЛОКАЛЬНОЕ СПОНСОРСТВО - Руководители функций как спонсоры",
                    "4️⃣ ЛИЧНАЯ СВЯЗЬ - Понимание индивидуальных потребностей",
                    "5️⃣ ПОДКРЕПЛЕНИЕ - Системы вознаграждения",
                    "6️⃣ ОБЩАЯ ЦЕЛЬ - Ясная артикуляция цели"
                ],
                whenToUse: "Крупные проекты с множеством людей, консервативная культура, высокое потенциальное сопротивление",
                bestFor: "Люди-ориентированные трансформации, вовлечение сотрудников"
            },
            {
                name: "Управление Изменениями PMI",
                type: "Действенная",
                developer: "Project Management Institute, 2010 год",
                description: "Интегрирует управление изменениями в существующую структуру управления проектами PMI.",
                phases: [
                    "1️⃣ ПОРТФЕЛЬНЫЙ УРОВЕНЬ - Управление портфелем изменений, выравнивание со стратегией",
                    "2️⃣ ПРОГРАММНЫЙ УРОВЕНЬ - Управление взаимосвязанными проектами, реализация больших инициатив",
                    "3️⃣ ПРОЕКТНЫЙ УРОВЕНЬ - Управление конкретным проектом изменений, тактическое управление"
                ],
                whenToUse: "Компании с культурой PMI, портфельное управление изменениями, множество взаимосвязанных проектов",
                bestFor: "Организации с PMI культурой, портфельное управление"
            },
            {
                name: "Модель Притчетта",
                type: "Высокоуровневая",
                developer: "Price Pritchett, 1994 год",
                description: "Простой четырёхфазный подход к управлению организационными изменениями. Философия: иногда простота эффективнее сложности.",
                phases: [
                    "1️⃣ ИМПЕРАТИВ - Создание понимания необходимости",
                    "2️⃣ ГОТОВНОСТЬ - Подготовка организации, обучение и развитие",
                    "3️⃣ РЕАЛИЗАЦИЯ - Внедрение изменений, поддержка людей",
                    "4️⃣ ПРЕИМУЩЕСТВА - Демонстрация результатов, измерение успеха"
                ],
                whenToUse: "Срочные изменения, организации предпочитающие простоту, проекты со сжатыми сроками",
                bestFor: "Быстрое внедрение, организации со сжатыми сроками"
            },
            {
                name: "Модель Прохаски и ДиКленте (6 Стадий)",
                type: "Высокоуровневая",
                developer: "Джеймс Прохаска, Карло ДиКлементе, 1982 год (Адаптирована для организаций)",
                description: "Люди проходят через серии психологических и поведенческих стадий при изменении. Первоначально для помощи людям бросить курить.",
                phases: [
                    "1️⃣ ПРЕДРАЗМЫШЛЕНИЕ - Человек не думает об изменении",
                    "2️⃣ РАЗМЫШЛЕНИЕ - Человек рассматривает идею изменения",
                    "3️⃣ ПОДГОТОВКА - Человек решил меняться",
                    "4️⃣ ДЕЙСТВИЕ - Человек активно меняет поведение",
                    "5️⃣ ПОДДЕРЖКА - Человек работает над закреплением",
                    "6️⃣ РЕЦИДИВ - Возврат к старому поведению (это нормально!)"
                ],
                whenToUse: "Поведенческие изменения, персональная трансформация, долгосрочные программы развития, работа с сопротивлением",
                bestFor: "Индивидуальные и групповые поведенческие изменения"
            },
            {
                name: "АДКАР (PROSCI)",
                type: "Действенная",
                developer: "Prosci (Jeff Hiatt), 2003 год",
                description: "Пятиэлементная целевая модель, фокусирующаяся на индивидуальном переходе через изменение. Успех изменений = успех в переходе каждого человека.",
                phases: [
                    "A - ОСОЗНАНИЕ (Awareness) - Люди должны осознавать необходимость изменения",
                    "D - ЖЕЛАНИЕ (Desire) - Люди должны хотеть участвовать и поддерживать",
                    "K - ЗНАНИЕ (Knowledge) - Люди должны иметь знания как делать новое",
                    "A - СПОСОБНОСТЬ (Ability) - Люди должны иметь способность выполнять новое поведение",
                    "R - ПОДКРЕПЛЕНИЕ (Reinforcement) - Люди должны получать подкрепление новых поведений"
                ],
                whenToUse: "Крупные организационные трансформации, проекты требующие индивидуальной поддержки, технологические внедрения",
                bestFor: "Трансформация на уровне сотрудников, индивидуальная поддержка"
            },
            {
                name: "Модель Принятия Инноваций Роджерса",
                type: "Контекстная",
                developer: "Эверетт М. Роджерс, 1962 год",
                description: "Теория распространения инноваций среди населения. Показывает, как люди с разной скоростью принимают новые идеи и технологии.",
                phases: [
                    "1️⃣ ИННОВАТОРЫ (2,5%) - Первопроходцы, любители рисков",
                    "2️⃣ РАННИЕ ПОСЛЕДОВАТЕЛИ (13,5%) - Мнение-лидеры, советчики",
                    "3️⃣ РАННЕЕ БОЛЬШИНСТВО (34%) - Рассудительные, информированные",
                    "4️⃣ ПОЗДНЕЕ БОЛЬШИНСТВО (34%) - Скептичные, консервативные",
                    "5️⃣ ОТСТАЮЩИЕ (16%) - Традиционалисты, сопротивляющиеся"
                ],
                whenToUse: "Внедрение новых технологий, организационные инновации, ролл-ауты по фазам, планирование коммуникации",
                bestFor: "Технологические изменения, инновационные инициативы"
            },
            {
                name: "Пятая Дисциплина (Петер Сенге)",
                type: "Контекстная",
                developer: "Питер Сенге, 1990 год",
                description: "Модель обучающейся организации - организация, способная быстро адаптироваться и развиваться. Пять дисциплин для создания будущего.",
                phases: [
                    "1️⃣ СИСТЕМНОЕ МЫШЛЕНИЕ (центральная дисциплина) - Видение связей и взаимодействий",
                    "2️⃣ ЛИЧНОЕ МАСТЕРСТВО - Непрерывное развитие личных способностей",
                    "3️⃣ МЕНТАЛЬНЫЕ МОДЕЛИ - Глубокие убеждения и образы о мире",
                    "4️⃣ ОБЩЕЕ ВИДЕНИЕ - Совместное видение желаемого будущего",
                    "5️⃣ КОМАНДНОЕ ОБУЧЕНИЕ - Развитие способности команды к совместному обучению"
                ],
                whenToUse: "Формирование культуры постоянного обучения, долгосрочные трансформации, развитие лидеров будущего",
                bestFor: "Культурная трансформация, формирование обучающейся организации"
            },
            {
                name: "Динамические Возможности (Дэвид Тиес)",
                type: "Контекстная",
                developer: "Дэвид Тиес (David Teece), 1997 год",
                description: "Способность организации быстро интегрировать, создавать и переконфигурировать компетенции для ответа на вызовы рынка.",
                phases: [
                    "1️⃣ ЧУВСТВОВАНИЕ (Sensing) - Выявление возможностей и угроз",
                    "2️⃣ ИСПОЛЬЗОВАНИЕ (Seizing) - Мобилизация ресурсов для захвата возможностей",
                    "3️⃣ ТРАНСФОРМАЦИЯ (Transforming) - Переконфигурация компетенций для долгосрочного преимущества"
                ],
                whenToUse: "Быстро меняющиеся рынки, технологические преобразования, развитие организационной ловкости",
                bestFor: "Стратегическое развитие, адаптивность организации"
            },
            {
                name: "Сложные адаптивные системы (Stacey & Shaw)",
                type: "Контекстная",
                developer: "Ralph Stacey, Patricia Shaw, 2000 год",
                description: "Организация как сложная адаптивная система, в которой изменения нелинейны и не всегда управляемы традиционными методами.",
                phases: [
                    "1️⃣ СЛОЖНОСТЬ - Множество взаимодействующих элементов, нелинейные отношения",
                    "2️⃣ АДАПТИВНОСТЬ - Система адаптируется к окружающей среде",
                    "3️⃣ САМООРГАНИЗАЦИЯ - Система упорядочивает себя без центрального контроля"
                ],
                whenToUse: "Высокая неопределённость (VUCA), сложные организационные системы, инновационные среды",
                bestFor: "Работа в неопределённости, инновационные организации"
            },
            {
                name: "Вирусные изменения (Leandro Herrero)",
                type: "Действенная",
                developer: "Leandro Herrero, 2004 год",
                description: "Распространение изменений через социальное 'заражение' путём активных сторонников и влиятельных лиц. Изменения как вирус.",
                phases: [
                    "1️⃣ ОТКРЫТИЕ (Discovery) - Выявление инициаторов и культурных вирусов",
                    "2️⃣ РАЗВИТИЕ (Development) - Развитие вируса (идеи) и его носителей",
                    "3️⃣ ВОВЛЕЧЕНИЕ (Engagement) - Вовлечение более широких кругов",
                    "4️⃣ ДИФФУЗИЯ (Diffusion) - Быстрое распространение по организации",
                    "5️⃣ ПОДДЕРЖКА (Support) - Закрепление и долгосрочная поддержка"
                ],
                whenToUse: "Культурные изменения, корпоративные инициативы, инновационные изменения, когда нужна быстрая диффузия",
                bestFor: "Органическое распространение идей, культурные трансформации"
            },
            {
                name: "Шестиблочная модель Вейсборда",
                type: "Контекстная",
                developer: "Marvin Weisboard, 1976 год",
                description: "Диагностический инструмент для анализа шести аспектов эффективной организации. Найти причины проблем в организации.",
                phases: [
                    "1️⃣ ЦЕЛИ (Purpose) - Понимают ли люди цель организации",
                    "2️⃣ СТРУКТУРА (Structure) - Служит ли структура целям",
                    "3️⃣ ОТНОШЕНИЯ (Relationships) - Как люди работают вместе",
                    "4️⃣ ВОЗНАГРАЖДЕНИЕ (Rewards) - Вознаграждаются ли желаемые поведения",
                    "5️⃣ ЛИДЕРСТВО (Leadership) - Какое руководство",
                    "6️⃣ ВСПОМОГАТЕЛЬНЫЕ МЕХАНИЗМЫ (Helpful Mechanisms) - Есть ли системы поддержки"
                ],
                whenToUse: "Диагностика организационных проблем, определение приоритетов для изменений, комплексный анализ эффективности",
                bestFor: "Системный анализ, диагностика проблем, планирование улучшений"
            },
            {
                name: "Управление переходом Уильяма Бриджеса",
                type: "Контекстная",
                developer: "William Bridges, 1991 год",
                description: "Отличие между ИЗМЕНЕНИЕМ и ПЕРЕХОДОМ. Изменение = внешнее. Переход = внутреннее, психологический процесс. Люди могут пережить изменение, но могут не справиться с переходом.",
                phases: [
                    "1️⃣ ЗАВЕРШЕНИЕ (Ending) - Конец старого способа, период потери. Эмоции: печаль, страх, гнев",
                    "2️⃣ НЕЙТРАЛЬНАЯ ЗОНА (Neutral Zone) - Старое отпущено, новое ещё не принято. САМАЯ ВАЖНАЯ ФАЗА",
                    "3️⃣ НОВОЕ НАЧАЛО (New Beginning) - Новые процессы становятся привычкой, новая идентичность"
                ],
                whenToUse: "Значительные, болезненные изменения, реструктуризация, сокращения, изменения идентичности",
                bestFor: "Понимание психологии переходов, сочувственное управление"
            },
            {
                name: "Теория U (Otto Scharmer)",
                type: "Контекстная",
                developer: "Otto Scharmer, 2007 год",
                description: "Глубокая трансформация связана с глубокой трансформацией сознания и внимания. Основной вопрос: 'Из какого места (качества сознания) мы действуем?'",
                phases: [
                    "ДВИЖЕНИЕ ВНИЗ - Открыть: отпустить предыдущие убеждения. Вынырнуть: глубокая рефлексия",
                    "ДВИЖЕНИЕ ПО ДНУ - Присутствие: момент преобразующего осознания. Прорыв: новое качество сознания",
                    "ДВИЖЕНИЕ ВВЕРХ - Прообраз: кристаллизация нового видения. Создать: воплощение нового в действии"
                ],
                whenToUse: "Трансформирующие изменения, развитие лидеров будущего, организационные крупные сдвиги, инновационные инициативы",
                bestFor: "Глубокие трансформации, развитие лидеров, инновация"
            },
            {
                name: "Теории изменений (Theory of Change)",
                type: "Вспомогательная",
                developer: "Инициатива комьюнити (Community Change Inc.), 1995 год",
                description: "Методология планирования, которая связывает конкретные действия с долгосрочными целями. Если мы сделаем X, то произойдет Y, что приведет к Z.",
                phases: [
                    "1️⃣ ВИДЕНИЕ - Описание идеального будущего состояния",
                    "2️⃣ РЕЗУЛЬТАТЫ - Конкретные изменения, необходимые для достижения видения",
                    "3️⃣ ПОКАЗАТЕЛИ УСПЕХА - Как мы узнаем, что результат достигнут",
                    "4️⃣ ДЕЯТЕЛЬНОСТЬ - Конкретные действия для достижения результатов",
                    "5️⃣ ВХОДЫ - Ресурсы, необходимые для деятельности",
                    "6️⃣ ПРЕДПОЛОЖЕНИЯ - Что мы считаем верным, какие риски"
                ],
                whenToUse: "Проектное планирование, социальные инициативы, причинно-следственный анализ, оценка программ",
                bestFor: "Планирование программ, связь действий с результатами"
            },
            {
                name: "Позитивное отклонение (Positive Deviance)",
                type: "Действенная",
                developer: "Джерри Стернин, Моник Стернин, 1990 год",
                description: "Подход, использующий успехи отдельных людей или групп как основу для масштабирования изменений. Решения часто уже существуют в сообществе - нужно их обнаружить и масштабировать.",
                phases: [
                    "1️⃣ ОПРЕДЕЛИТЬ ПРОБЛЕМУ - Четко определить вызов",
                    "2️⃣ НАЙТИ ПОЗИТИВНЫХ ДЕВИАНТОВ - Выявить людей, которые успешны несмотря на условия",
                    "3️⃣ ИЗУЧИТЬ ИХ ПОВЕДЕНИЕ - Глубокое исследование их подхода",
                    "4️⃣ РАЗРАБОТАТЬ РЕШЕНИЯ - На основе позитивных девиантов",
                    "5️⃣ МАСШТАБИРОВАТЬ ИЗМЕНЕНИЯ - Распространить успешные практики на большей группе"
                ],
                whenToUse: "Социальные трансформации, корпоративные программы развития, распространение лучших практик, малобюджетные проекты",
                bestFor: "Органическое распространение успеха, социальные инициативы"
            },
            {
                name: "BPI - Перестройка деловых процессов",
                type: "Действенная",
                developer: "Michael Hammer, James Champy, 1993 год",
                description: "Радикальное переосмысление и переделка бизнес-процессов для достижения выдающихся улучшений. Не просто улучшение существующих процессов (incremental), а полная переделка (radical redesign).",
                phases: [
                    "1️⃣ РАДИКАЛЬНЫЙ - Не небольшие улучшения, полная переделка процесса, переосмысление с нуля",
                    "2️⃣ ПРОЦЕССЫ - Фокус на процессах, не функциях, кросс-функциональные процессы",
                    "3️⃣ ВЫДАЮЩИЕСЯ - Результаты значительные, не частичные, часто 10-кратные улучшения",
                    "ЭТАПЫ: Определить процесс → Установить видение результата → Спроектировать новый процесс → Реализовать → Закрепить и непрерывно улучшать"
                ],
                whenToUse: "Критичные процессы требуют улучшения, конкуренция требует радикальных перемен, появились новые технологии, текущие процессы устарели",
                bestFor: "Операционная трансформация, переделка процессов"
            },
            {
                name: "Звездная Модель Организации (Galbraith)",
                type: "Контекстная",
                developer: "Jay Galbraith, 1995 год",
                description: "Пять взаимосвязанных элементов успешной организации - вместе они образуют 'звезду'. Все пять элементов должны быть согласованы для эффективности.",
                phases: [
                    "1️⃣ СТРАТЕГИЯ - Направление организации, стратегические приоритеты, позиционирование рынка",
                    "2️⃣ СТРУКТУРА - Организационный дизайн, иерархия подразделений, линии отчетности",
                    "3️⃣ СИСТЕМЫ И ПРОЦЕССЫ - Информационные системы, управленческие процессы, контрольные механизмы",
                    "4️⃣ ЛЮДИ И КОМПЕТЕНЦИИ - Навыки и способности, уровень развития, мотивация",
                    "5️⃣ ВОЗНАГРАЖДЕНИЕ - Система компенсации, мотивации, признание и награды",
                    "ЦЕНТР ЗВЕЗДЫ: Лидерство - объединяет все пять элементов"
                ],
                whenToUse: "Организационный дизайн, диагностика проблем, планирование преобразований, выравнивание организации",
                bestFor: "Системный анализ, организационный дизайн"
            },
            {
                name: "Канвас управления изменениями",
                type: "Действенная",
                developer: "Владимиров, 2020-е годы",
                description: "Визуальный инструмент интегрированного планирования всех элементов управления изменениями. Canvas - живой документ, постоянно обновляется.",
                phases: [
                    "1️⃣ ТЕКУЩЕЕ СОСТОЯНИЕ - Анализ существующей ситуации, текущие проблемы, готовность организации",
                    "2️⃣ ВИДЕНИЕ БУДУЩЕГО - Желаемое состояние, целевые результаты, новые процессы",
                    "3️⃣ ДРАЙВЕРЫ ИЗМЕНЕНИЙ - Внешние причины, внутренние причины, срочность",
                    "4️⃣ ВЛИЯНИЕ НА ОРГАНИЗАЦИЮ - Затронутые подразделения, основные риски, финансовое влияние",
                    "5️⃣ КЛЮЧЕВЫЕ ИНИЦИАТИВЫ - Основные проекты, этапы внедрения, взаимосвязи",
                    "6️⃣ РОЛИ И ОТВЕТСТВЕННОСТЬ - Спонсор изменений, лидер изменений, RACI матрица",
                    "7️⃣ ВРЕМЕННАЯ ШКАЛА - Сроки реализации, ключевые вехи, фазы внедрения",
                    "8️⃣ КОММУНИКАЦИЯ - Стратегия коммуникации, целевые аудитории, каналы и форматы",
                    "9️⃣ ИЗМЕРЕНИЕ УСПЕХА - Ключевые показатели, метрики достижения, критерии успеха",
                    "🔟 ПОДДЕРЖКА И РЕСУРСЫ - Бюджет, человеческие ресурсы, технологические инструменты"
                ],
                whenToUse: "Планирование крупных изменений, выравнивание заинтересованных сторон, документирование программы, мониторинг прогресса",
                bestFor: "Комплексное планирование, выравнивание, документирование"
            }
        ];
        
        // Contemporary & New Models 2025 (Models 48-55)
        const newModels = [
            {
                name: "Модель Сатир",
                type: "Контекстная",
                developer: "Virginia Satir, 1980-е годы (Адаптирована для организаций)",
                description: "Модель эмоционального и психологического пути человека при переходе через изменение. Изменение - это эмоциональное путешествие, не только процесс.",
                phases: [
                    "1️⃣ ПОЗДНИЙ СТАТУС-КВО - Комфорт, привычка, уверенность, контроль. Задача лидера: Создать неудовлетворённость",
                    "2️⃣ СОПРОТИВЛЕНИЕ - Первоначальное потрясение, страх, раздражение, отрицание. ПРОИЗВОДИТЕЛЬНОСТЬ ПАДАЕТ. Задача: Коммуникация и эмпатия",
                    "3️⃣ ХАОС - Максимальная путаница, старое не работает, новое не освоено. ПРОИЗВОДИТЕЛЬНОСТЬ МИНИМАЛЬНА. КРИТИЧНО: Требуется интенсивная поддержка",
                    "4️⃣ ИНТЕГРАЦИЯ - Постепенное признание, начало интуитивных действий. ПРОИЗВОДИТЕЛЬНОСТЬ ВОССТАНАВЛИВАЕТСЯ. Задача: Закрепление и признание",
                    "5️⃣ НОВЫЙ СТАТУС-КВО - Новый комфорт, новое по умолчанию. ПРОИЗВОДИТЕЛЬНОСТЬ ВЫШЕ ИСХОДНОГО. Начало новой спирали изменений"
                ],
                whenToUse: "Значительные, болезненные изменения, реструктуризация, культурные изменения, психологически сложные проекты",
                bestFor: "Управление эмоциональными реакциями, сочувствие"
            },
            {
                name: "Теория подталкивания (Nudge Theory)",
                type: "Вспомогательная",
                developer: "Richard Thaler, Cass Sunstein, 2008 год",
                description: "Дизайн выбора для направления людей к желаемому поведению без ограничения их свободы. Люди имеют предсказуемые смещения в решениях.",
                phases: [
                    "1️⃣ СТАТУС-КВО СМЕЩЕНИЕ - Люди предпочитают текущее состояние. Нужно переделать выбор по умолчанию",
                    "2️⃣ ВЫБОР ПО УМОЛЧАНИЮ - То, что предложено по умолчанию, часто выбирается. Автоматическая запись вместо 'запишитесь'",
                    "3️⃣ СОЦИАЛЬНОЕ ДОКАЗАТЕЛЬСТВО - Люди делают то, что делают другие. '80% коллег уже это делают'",
                    "4️⃣ ОТВРАЩЕНИЕ К ПОТЕРЕ - Люди боятся потерь больше, чем радуются выигрышам. 'Упустив обучение, потеряете преимущество'",
                    "ПРИМЕРЫ: Обучение - автоматическая запись вместо 'запишитесь' (80-90% участия вместо 20-30%)"
                ],
                whenToUse: "Увеличение участия, изменение поведения без конфронтации, большие группы, низкое активное сопротивление",
                bestFor: "Массовые изменения, повышение участия"
            },
            {
                name: "PDCA Цикл (План-Делай-Проверяй-Действуй)",
                type: "Действенная",
                developer: "William Edwards Deming (Walter Shewhart), 1950-е годы (Популярна в 2025)",
                description: "Непрерывный цикл постоянного улучшения, не одноразовая процедура. Изменение = спираль, где каждый цикл выше предыдущего.",
                phases: [
                    "1️⃣ PLAN (Планирование) - Определить цель, проанализировать ситуацию, выработать гипотезу, определить метрики. Пилот на 2 недели",
                    "2️⃣ DO (Тестирование) - Реализовать МАЛЫЙ пилот, собирать данные во время, работать в контролируемых условиях",
                    "3️⃣ CHECK (Проверка) - Оценить результаты, сравнить ожидаемое vs. фактическое, проанализировать почему, документировать обучение",
                    "4️⃣ ACT (Действие) - Если успешно: расширить волну 2. Если неудачно: модифицировать и вернуться к Plan. Начать НОВЫЙ цикл",
                    "КЛЮЧЕВОЕ ОТЛИЧИЕ: НИКОГДА не 'это не сработало' - вместо этого 'что мы узнали?'"
                ],
                whenToUse: "Быстро меняющаяся среда, неопределённость, необходима адаптивность, технологические изменения",
                bestFor: "Быстрые изменения, инновационные организации, стартапы"
            },
            {
                name: "Управление сопротивлением (Маур 3 Уровня)",
                type: "Действенная",
                developer: "Rick Maurer, 1996 год",
                description: "Три различных уровня сопротивления требуют трёх различных подходов. Не все сопротивления одинаковые - нужна диагностика.",
                phases: [
                    "1️⃣ ПЕРВЫЙ УРОВЕНЬ: 'Я не понимаю' - Информационный дефицит. Вопросы: 'Что именно меняется?' РЕШЕНИЕ: Информация и коммуникация",
                    "2️⃣ ВТОРОЙ УРОВЕНЬ: 'Мне это не нравится' - Эмоциональный дефицит. 'Это плохая идея', эмоциональная критика. РЕШЕНИЕ: Вовлечение и поддержка",
                    "3️⃣ ТРЕТИЙ УРОВЕНЬ: 'Я вам не доверяю' - Дефицит доверия. 'Это обман, реальное намерение иное', циничность. РЕШЕНИЕ: Восстановление доверия",
                    "Часто нужны ВСЕ три подхода одновременно с разными группами"
                ],
                whenToUse: "Высокое потенциальное сопротивление, необходимо понимание типов сопротивления, таргетированные подходы к разным группам",
                bestFor: "Управление сопротивлением, диагностика причин"
            },
            {
                name: "МR2P2 (Роль-Причина-Путь-Партнер)",
                type: "Действенная",
                developer: "Различные авторы (интегрирован в современные практики), 2010 год",
                description: "Четыре ключевых элемента, которые каждый человек должен понимать для успешного изменения. Все четыре необходимы.",
                phases: [
                    "1️⃣ РОЛЬ (Role) - Что МНЕ нужно делать? Четко определить новые обязанности, новые навыки, новые способы работы. Результат: Ясность действия",
                    "2️⃣ ПРИЧИНА (Reason) - ПОЧЕМУ мы это делаем? Объяснить контекст, стратегические причины, личную выгоду. Результат: Понимание и мотивация",
                    "3️⃣ ПУТЬ (Path) - КАК я буду это делать и КОГДА? Обучение и развитие, пошаговые инструкции, временная шкала. Результат: Способность действовать",
                    "4️⃣ ПАРТНЕР (Partner) - Кому я могу позвонить, если нужна помощь? Менеджер как спонсор, коуч, система поддержки. Результат: Поддержка и безопасность",
                    "Когда человек может ответить на все четыре вопроса - он готов к изменению"
                ],
                whenToUse: "Персональная поддержка в изменениях, работа с каждым человеком индивидуально, масштабирование поддержки",
                bestFor: "Персональная поддержка, массовые изменения"
            },
            {
                name: "Гибридное управление изменениями",
                type: "Действенная",
                developer: "Современные практики, 2020-е годы",
                description: "Комбинация Waterfall и Agile подходов для больших трансформаций. Не всё можно сделать Agile, не всё нужно планировать на год вперёд.",
                phases: [
                    "СЛОЙ 1: WATERFALL ФУНДАМЕНТ (6-12 месяцев) - Стратегия и видение, дизайн целевого состояния, архитектура и план. Фокус: Правильное определение что менять",
                    "СЛОЙ 2: AGILE РЕАЛИЗАЦИЯ (3-6 месячные волны) - Спринты реализации, итеративное внедрение, частая обратная связь. Фокус: Быстрая реализация с корректировками",
                    "СЛОЙ 3: WATERFALL СТАБИЛИЗАЦИЯ (3-6 месяцев) - Закрепление результатов, интеграция в системы, стандартизация. Фокус: Долгосрочная устойчивость",
                    "ПРЕИМУЩЕСТВА: Стратегический фундамент + Гибкость в реализации + Контролируемый риск + Быстрые результаты + Долгосрочная устойчивость"
                ],
                whenToUse: "Крупные программы трансформации, неопределённость, требующая гибкости, необходимы быстрые результаты, долгосрочные инициативы",
                bestFor: "Крупные программы трансформации, масштабные изменения"
            },
            {
                name: "AI-Усиленное Управление Изменениями",
                type: "Действенная",
                developer: "Современные практики 2024-2025",
                description: "Использование Искусственного Интеллекта как инструмента для управления изменениями. ИИ - инструмент, не замена человеку.",
                phases: [
                    "1️⃣ АНАЛИЗ НАСТРОЕНИЙ - Мониторинг чатов и коммуникации, выявление областей опасения, раннее предупреждение проблем",
                    "2️⃣ ПРОГНОЗНАЯ АНАЛИТИКА - Предсказание, какие люди будут сопротивляться, выявление рисков на основе данных",
                    "3️⃣ ПЕРСОНАЛИЗИРОВАННЫЕ ПУТИ ОБУЧЕНИЯ - ИИ создаёт индивидуальные пути, адаптация к скорости понимания",
                    "4️⃣ ВИРТУАЛЬНЫЕ КОУЧИ - ИИ-коучи 24/7 поддержка, ответы на вопросы, поддержка на разных языках",
                    "5️⃣ ОПТИМИЗАЦИЯ КОММУНИКАЦИИ - Лучшее время для отправки сообщений, правильный канал для каждого человека",
                    "6️⃣ ИЗМЕРЕНИЕ И ОТЧЁТНОСТЬ - Дашборды готовности в реальном времени, выявление отстающих областей",
                    "⚠️ ОГРАНИЧЕНИЯ: Человеческий контакт остаётся критичным, этика и конфиденциальность важны"
                ],
                whenToUse: "Крупные изменения с множеством людей, необходимость масштабирования, компании с высокой технологичностью, многоязычные организации",
                bestFor: "Масштабируемые трансформации, технологические компании"
            },
            {
                name: "Модель лидерства в условиях неопределённости (VUCA)",
                type: "Контекстная",
                developer: "Современные практики 2024-2025",
                description: "Как лидировать в условиях высокой неопределённости и быстрых изменений. VUCA = Волатильность, Неопределённость, Сложность, Неоднозначность.",
                phases: [
                    "1️⃣ ВИЗИЯ, ЯСНАЯ, НО ГИБКАЯ (Vision) - Ясная долгосрочная направление, НО гибкая в деталях. Люди знают 'зачем', но 'как' адаптируется",
                    "2️⃣ ПОНИМАНИЕ И СЛУШАНИЕ (Understanding) - Глубокое понимание текущей ситуации, слушание 'слабых сигналов'",
                    "3️⃣ ЯСНОСТЬ ЦЕННОСТЕЙ (Clarity) - Ценности как якорь в неопределённости, решения основаны на ценностях",
                    "4️⃣ АДАПТИВНОСТЬ И ГИБКОСТЬ (Agility) - Готовность менять курс, экспериментирование и быстрое обучение, Fail-fast менталитет",
                    "5️⃣ ЛЮДИ И ДОВЕРИЕ - Инвестиции в людей, построение доверия, психологическая безопасность",
                    "НАВЫКИ: Сокращение неопределённости, балансировка плана и адаптации, быстрые решения с неполной информацией"
                ],
                whenToUse: "Быстро меняющаяся среда, высокая неопределённость, развитие лидеров будущего, организационная трансформация",
                bestFor: "Развитие лидеров, управление неопределённостью"
            }
        ];

        // Функция для автоматического расширения данных моделей
        function extendModelData(model) {
            // Определение сложности на основе количества фаз и типа
            let complexity = "Средняя";
            const phaseCount = model.phases ? model.phases.length : 0;

            if (phaseCount <= 3 || model.type === "Вспомогательная") {
                complexity = "Низкая";
            } else if (phaseCount >= 8 || model.type === "Действенная") {
                complexity = "Высокая";
            }

            // Определение масштаба на основе whenToUse и bestFor
            let scale = "Средний";
            const text = (model.whenToUse + " " + model.bestFor).toLowerCase();

            if (text.includes("команда") || text.includes("малый") || text.includes("локальн")) {
                scale = "Малый";
            } else if (text.includes("организаци") || text.includes("корпораци") || text.includes("крупн") || text.includes("трансформаци")) {
                scale = "Крупный";
            }

            // Определение срока на основе сложности и количества фаз
            let duration = "3-6 мес";
            if (complexity === "Низкая" && phaseCount <= 3) {
                duration = "1-3 мес";
            } else if (complexity === "Высокая" || phaseCount >= 8) {
                duration = "6-12 мес";
            } else if (phaseCount >= 5) {
                duration = "3-6 мес";
            }
            if (text.includes("быстр") || text.includes("критичн")) {
                duration = "1-3 мес";
            } else if (text.includes("длительн") || text.includes("комплексн")) {
                duration = "12+ мес";
            }

            // Определение фокуса на основе типа и описания
            let focus = "Процессы";
            if (model.type === "Контекстные") {
                focus = "Стратегия";
            } else if (model.type === "Высокоуровневые") {
                focus = "Люди";
            } else if (text.includes("люд") || text.includes("психолог") || text.includes("эмоциональн") || text.includes("культур")) {
                focus = "Люди";
            } else if (text.includes("стратег") || text.includes("видени") || text.includes("лидерств")) {
                focus = "Стратегия";
            } else if (text.includes("культур") || text.includes("ценност") || text.includes("поведен")) {
                focus = "Культура";
            }

            // Добавляем новые поля к модели
            model.complexity = complexity;
            model.scale = scale;
            model.duration = duration;
            model.focus = focus;

            return model;
        }

        // Расширяем данные всех моделей
        classicalModels.forEach(model => extendModelData(model));
        newModels.forEach(model => extendModelData(model));

        // СЛАЙД - РАЗДЕЛИТЕЛЬ: МОДЕЛИ УПРАВЛЕНИЯ ИЗМЕНЕНИЯМИ
        slidesData.push({
            title: "Модели управления изменениями",
            subtitle: "56 подходов от классических до современных",
            content: `
                <div class="section-separator models-separator">
                    <div class="separator-hero">
                        <div class="hero-icon">
                            <svg viewBox="0 0 24 24" aria-hidden="true">
                                <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"></path>
                            </svg>
                        </div>
                        <h1 class="separator-title">56 Моделей</h1>
                        <p class="separator-subtitle">От классических подходов к современным инновационным методологиям</p>
                    </div>

                    <div class="models-overview">
                        <div class="model-category-card">
                            <span class="type-badge type-contextual">КОНТЕКСТНЫЕ МОДЕЛИ</span>
                            <h4>Стратегические, макро-подходы</h4>
                            <p>Модели, фокусирующиеся на общем контексте изменений, стратегическом планировании и системном подходе.</p>
                            <span class="model-count">15 моделей</span>
                        </div>

                        <div class="model-category-card">
                            <span class="type-badge type-highlevel">ВЫСОКОУРОВНЕВЫЕ МОДЕЛИ</span>
                            <h4>Концептуальные рамки</h4>
                            <p>Абстрактные модели, предоставляющие высокоуровневые концепции и теоретические основы.</p>
                            <span class="model-count">10 моделей</span>
                        </div>

                        <div class="model-category-card">
                            <span class="type-badge type-actionable">ДЕЙСТВЕННЫЕ МОДЕЛИ</span>
                            <h4>Пошаговые методологии</h4>
                            <p>Практические модели с четкими этапами, инструментами и рекомендациями по реализации.</p>
                            <span class="model-count">26 моделей</span>
                        </div>

                        <div class="model-category-card">
                            <span class="type-badge type-supporting">ВСПОМОГАТЕЛЬНЫЕ МОДЕЛИ</span>
                            <h4>Инструменты и методологии поддержки</h4>
                            <p>Специализированные модели для конкретных аспектов управления изменениями и поддержки.</p>
                            <span class="model-count">8 моделей</span>
                        </div>
                    </div>

                    <div class="separator-navigation">
                        <div class="nav-hint">
                            <p><strong>Навигация по моделям:</strong> Используйте номера слайдов для быстрого перехода к интересующей модели</p>
                            <p><strong>Категории:</strong> Каждая модель имеет цветовую маркировку для облегчения поиска</p>
                        </div>
                        <button class="separator-cta" onclick="jumpToSlide(9)">Изучить модели →</button>
                    </div>
                </div>
            `
        });

        // Add model slides to slidesData
        classicalModels.forEach((model, index) => {
            slidesData.push({
                title: `${index + 1}. ${model.name}`,
                subtitle: `Тип: ${model.type} | ${model.developer}`,
                content: `
                    <div class="model-slide">
                        <div class="model-info">
                            <span class="type-badge type-${model.type.toLowerCase()}">${model.type.toUpperCase()}</span>
                            <h4>Описание</h4>
                            <p>${model.description}</p>
                            <h4>Ключевые Этапы/Компоненты</h4>
                            <ul>
                                ${model.phases.map(phase => `<li>${phase}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="model-info">
                            <h4>Когда Использовать</h4>
                            <p>${model.whenToUse}</p>
                            <div class="best-for">
                                <strong>Лучше всего для:</strong><br>
                                ${model.bestFor}
                            </div>
                        </div>
                    </div>
                `
            });
        });
        
        newModels.forEach((model, index) => {
            slidesData.push({
                title: `${classicalModels.length + index + 1}. ${model.name}`,
                subtitle: `Тип: ${model.type} | ${model.developer}`,
                content: `
                    <div class="model-slide">
                        <div class="model-info">
                            <span class="type-badge type-${model.type.toLowerCase()}">${model.type.toUpperCase()}</span>
                            <h4>Описание</h4>
                            <p>${model.description}</p>
                            <h4>Ключевые Этапы/Компоненты</h4>
                            <ul>
                                ${model.phases.map(phase => `<li>${phase}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="model-info">
                            <h4>Когда использовать</h4>
                            <p>${model.whenToUse}</p>
                            <div class="best-for">
                                <strong>Лучше всего для:</strong><br>
                                ${model.bestFor}
                            </div>
                        </div>
                    </div>
                `
            });
        });

        // РАЗДЕЛИТЕЛЬ: ПРАКТИЧЕСКИЕ ИНСТРУМЕНТЫ
        slidesData.push({
            title: "Практические инструменты",
            subtitle: "Интерактивные инструменты для оценки и планирования ваших проектов",
            content: `
                <div class="section-separator tools-separator">
                    <div class="separator-hero">
                        <div class="hero-icon">
                            <svg viewBox="0 0 24 24" aria-hidden="true">
                                <path d="M22.7 19l-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4z"></path>
                            </svg>
                        </div>
                        <h2>Практические инструменты</h2>
                        <p>Интерактивные инструменты для оценки и планирования ваших проектов</p>
                    </div>

                    <div class="tools-overview">
                        <div class="tool-preview">
                            <div class="tool-icon">📊</div>
                            <h3>Квиз профиля</h3>
                            <p>Определите ваш подход к управлению изменениями</p>
                        </div>
                        <div class="tool-preview">
                            <div class="tool-icon">💰</div>
                            <h3>Калькулятор ROI</h3>
                            <p>Оцените финансовую эффективность изменений</p>
                        </div>
                        <div class="tool-preview">
                            <div class="tool-icon">🎯</div>
                            <h3>Диагностика готовности</h3>
                            <p>Проверьте готовность организации к изменениям</p>
                        </div>
                        <div class="tool-preview">
                            <div class="tool-icon">🔧</div>
                            <h3>Конструктор моделей</h3>
                            <p>Создайте гибридную модель управления изменениями</p>
                        </div>
                        <div class="tool-preview">
                            <div class="tool-icon">⭐</div>
                            <h3>PCT оценка</h3>
                            <p>Комплексная оценка по методологии Prosci</p>
                        </div>
                    </div>

                    <div class="tools-navigation">
                        <button class="panel-button" onclick="changeSlide(1)">Продолжить →</button>
                    </div>
                </div>
            `
        });

        // ИНТЕРАКТИВНЫЙ КВИЗ
        slidesData.push({
            title: "Интерактивный квиз",
            subtitle: "Определите свой профиль управления изменениями",
            content: `
                <div class="practice-path-indicator">
                    <div class="path-indicator-header">
                        <h4>Путь оценки проекта</h4>
                        <span class="current-step">Шаг 1 из 5</span>
                    </div>
                    <div class="path-indicator">
                        <div class="path-step-indicator active" onclick="jumpToSlide(65)" style="cursor: pointer;">
                            <div class="step-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.1 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"></path>
                                </svg>
                            </div>
                            <div class="step-label">Квиз</div>
                        </div>
                        <div class="path-connector"></div>
                        <div class="path-step-indicator" onclick="jumpToSlide(66)" style="cursor: pointer;">
                            <div class="step-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path>
                                </svg>
                            </div>
                            <div class="step-label">ROI</div>
                        </div>
                        <div class="path-connector"></div>
                        <div class="path-step-indicator" onclick="jumpToSlide(67)" style="cursor: pointer;">
                            <div class="step-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <circle cx="12" cy="8.5" r="3.5"></circle>
                                    <path d="M6 19c0-3.3 2.7-6 6-6s6 2.7 6 6"></path>
                                </svg>
                            </div>
                            <div class="step-label">Готовность</div>
                        </div>
                        <div class="path-connector"></div>
                        <div class="path-step-indicator" onclick="jumpToSlide(68)" style="cursor: pointer;">
                            <div class="step-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"></path>
                                </svg>
                            </div>
                            <div class="step-label">Конструктор</div>
                        </div>
                        <div class="path-connector"></div>
                        <div class="path-step-indicator" onclick="jumpToSlide(69)" style="cursor: pointer;">
                            <div class="step-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                                </svg>
                            </div>
                            <div class="step-label">PCT</div>
                        </div>
                    </div>
                    <div class="path-navigation">
                        <button class="path-nav-btn secondary" onclick="jumpToSlide(64)">← Назад</button>
                        <button class="path-nav-btn" onclick="jumpToSlide(66)">Следующий шаг →</button>
                    </div>
                </div>

                <div class="quiz-tool">
                    <div class="quiz-intro">
                        <p><strong>Мини-квиз</strong> поможет определить ваш текущий подход к управлению изменениями и подобрать наиболее подходящие модели.</p>
                        <p>Ответьте на 7 вопросов и получите персонализированные рекомендации.</p>
                    </div>

                    <div class="quiz-progress">
                        <div class="quiz-progress-bar">
                            <div class="quiz-progress-fill" id="quizProgressFill"></div>
                        </div>
                        <span class="quiz-progress-text" id="quizProgressText">Вопрос 1 из 7</span>
                    </div>

                    <div class="quiz-question" id="quizQuestion"></div>

                    <div class="quiz-navigation">
                        <button class="quiz-nav-btn secondary" id="quizPrevBtn" style="display: none;" onclick="prevQuizQuestion()">← Назад</button>
                        <button class="quiz-nav-btn" id="quizNextBtn" onclick="nextQuizQuestion()">Далее →</button>
                    </div>
                </div>

                <div class="quiz-results" id="quizResults" style="display: none;">
                    <h3>Ваш профиль управления изменениями</h3>

                    <div class="quiz-profile" id="quizProfile"></div>

                    <div class="quiz-recommendations" id="quizRecommendations"></div>

                    <div class="quiz-actions">
                        <button class="panel-button" onclick="exportQuizResults()">📄 Скачать результаты</button>
                        <button class="panel-button secondary" onclick="confirmResetQuiz()">🔄 Пройти снова</button>
                    </div>
                </div>
            `
        });

        // КАЛЬКУЛЯТОР ROI
        slidesData.push({
            title: "Калькулятор ROI изменений",
            subtitle: "Оцените финансовую эффективность ваших проектов изменений",
            content: `
                <div class="practice-path-indicator">
                    <div class="path-indicator-header">
                        <h4>Путь оценки проекта</h4>
                        <span class="current-step">Шаг 2 из 5</span>
                    </div>
                    <div class="path-indicator">
                        <div class="path-step-indicator completed" onclick="jumpToSlide(65)" style="cursor: pointer;">
                            <div class="step-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.1 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"></path>
                                </svg>
                            </div>
                            <div class="step-label">Квиз</div>
                        </div>
                        <div class="path-connector completed"></div>
                        <div class="path-step-indicator active" onclick="jumpToSlide(66)" style="cursor: pointer;">
                            <div class="step-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path>
                                </svg>
                            </div>
                            <div class="step-label">ROI</div>
                        </div>
                        <div class="path-connector"></div>
                        <div class="path-step-indicator" onclick="jumpToSlide(67)" style="cursor: pointer;">
                            <div class="step-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <circle cx="12" cy="8.5" r="3.5"></circle>
                                    <path d="M6 19c0-3.3 2.7-6 6-6s6 2.7 6 6"></path>
                                </svg>
                            </div>
                            <div class="step-label">Готовность</div>
                        </div>
                        <div class="path-connector"></div>
                        <div class="path-step-indicator" onclick="jumpToSlide(68)" style="cursor: pointer;">
                            <div class="step-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"></path>
                                </svg>
                            </div>
                            <div class="step-label">Конструктор</div>
                        </div>
                        <div class="path-connector"></div>
                        <div class="path-step-indicator" onclick="jumpToSlide(69)" style="cursor: pointer;">
                            <div class="step-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                                </svg>
                            </div>
                            <div class="step-label">PCT</div>
                        </div>
                    </div>
                    <div class="path-navigation">
                        <button class="path-nav-btn secondary" onclick="jumpToSlide(65)">← Предыдущий шаг</button>
                        <button class="path-nav-btn" onclick="jumpToSlide(67)">Следующий шаг →</button>
                    </div>
                </div>

                <div class="roi-calculator">
                    <div class="roi-intro">
                        <p><strong>Калькулятор ROI</strong> поможет оценить экономическую эффективность ваших проектов изменений и обосновать инвестиции в управление изменениями.</p>
                        <p>Введите данные о вашем проекте для расчета возврата на инвестиции.</p>
                    </div>

                    <div class="roi-form">
                        <div class="roi-input-group">
                            <h4>Инвестиции в проект</h4>
                            <div class="roi-input-row">
                                <label>Бюджет проекта (руб.):</label>
                                <input type="number" id="projectBudget" placeholder="1000000" step="10000">
                            </div>
                            <div class="roi-input-row">
                                <label>Стоимость управления изменениями (руб.):</label>
                                <input type="number" id="changeBudget" placeholder="200000" step="10000">
                            </div>
                        </div>

                        <div class="roi-input-group">
                            <h4>Ожидаемые выгоды</h4>
                            <div class="roi-input-row">
                                <label>Экономия на увольнениях (руб./год):</label>
                                <input type="number" id="turnoverSavings" placeholder="500000" step="10000">
                            </div>
                            <div class="roi-input-row">
                                <label>Повышение производительности (%):</label>
                                <input type="number" id="productivityGain" placeholder="15" step="1">
                            </div>
                            <div class="roi-input-row">
                                <label>Средняя зарплата сотрудника (руб./год):</label>
                                <input type="number" id="avgSalary" placeholder="800000" step="10000">
                            </div>
                            <div class="roi-input-row">
                                <label>Количество сотрудников:</label>
                                <input type="number" id="employeeCount" placeholder="50" step="1">
                            </div>
                        </div>

                        <div class="roi-input-group">
                            <h4>Параметры расчета</h4>
                            <div class="roi-input-row">
                                <label>Период оценки (лет):</label>
                                <input type="number" id="evaluationPeriod" value="3" min="1" max="10">
                            </div>
                            <div class="roi-input-row">
                                <label>Ставка дисконтирования (%):</label>
                                <input type="number" id="discountRate" value="10" step="0.5">
                            </div>
                        </div>

                        <button class="panel-button" id="calculateROI" type="button">📊 Рассчитать ROI</button>
                    </div>

                    <div class="roi-results" id="roiResults" style="display: none;">
                        <h3>Результаты расчета</h3>

                        <div class="roi-summary">
                            <div class="roi-metric">
                                <div class="roi-metric-value" id="roiValue">0%</div>
                                <div class="roi-metric-label">ROI проекта</div>
                            </div>
                            <div class="roi-metric">
                                <div class="roi-metric-value" id="npvValue">0 руб.</div>
                                <div class="roi-metric-label">Чистая приведенная стоимость</div>
                            </div>
                            <div class="roi-metric">
                                <div class="roi-metric-value" id="paybackValue">0 лет</div>
                                <div class="roi-metric-label">Срок окупаемости</div>
                            </div>
                        </div>

                        <div class="roi-breakdown">
                            <h4>Детализация расчетов</h4>
                            <div id="roiBreakdown"></div>
                        </div>

                        <div class="roi-chart-container">
                            <canvas id="roiChart" width="400" height="200"></canvas>
                        </div>

                        <div class="roi-actions">
                            <button class="panel-button" id="exportROIReport" type="button">📄 Экспорт отчета (PDF)</button>
                        </div>
                    </div>
                </div>
            `
        });

        // ДИАГНОСТИКА ГОТОВНОСТИ
        slidesData.push({
            title: "Диагностика готовности к изменениям",
            subtitle: "Оцените текущую готовность вашей организации к успешному внедрению изменений",
            content: `
                <div class="practice-path-indicator">
                    <div class="path-indicator-header">
                        <h4>Путь оценки проекта</h4>
                        <span class="current-step">Шаг 3 из 5</span>
                    </div>
                    <div class="path-indicator">
                        <div class="path-step-indicator completed" onclick="jumpToSlide(65)" style="cursor: pointer;">
                            <div class="step-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.1 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"></path>
                                </svg>
                            </div>
                            <div class="step-label">Квиз</div>
                        </div>
                        <div class="path-connector completed"></div>
                        <div class="path-step-indicator completed" onclick="jumpToSlide(66)" style="cursor: pointer;">
                            <div class="step-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path>
                                </svg>
                            </div>
                            <div class="step-label">ROI</div>
                        </div>
                        <div class="path-connector completed"></div>
                        <div class="path-step-indicator active" onclick="jumpToSlide(67)" style="cursor: pointer;">
                            <div class="step-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <circle cx="12" cy="8.5" r="3.5"></circle>
                                    <path d="M6 19c0-3.3 2.7-6 6-6s6 2.7 6 6"></path>
                                </svg>
                            </div>
                            <div class="step-label">Готовность</div>
                        </div>
                        <div class="path-connector"></div>
                        <div class="path-step-indicator" onclick="jumpToSlide(68)" style="cursor: pointer;">
                            <div class="step-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"></path>
                                </svg>
                            </div>
                            <div class="step-label">Конструктор</div>
                        </div>
                        <div class="path-connector"></div>
                        <div class="path-step-indicator" onclick="jumpToSlide(69)" style="cursor: pointer;">
                            <div class="step-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                                </svg>
                            </div>
                            <div class="step-label">PCT</div>
                        </div>
                    </div>
                    <div class="path-navigation">
                        <button class="path-nav-btn secondary" onclick="jumpToSlide(66)">← Предыдущий шаг</button>
                        <button class="path-nav-btn" onclick="jumpToSlide(68)">Следующий шаг →</button>
                    </div>
                </div>

                <div class="readiness-assessment">
                    <!-- Введение -->
                    <div class="readiness-intro">
                        <p><strong>Диагностика готовности к изменениям</strong> помогает определить сильные и слабые стороны организации перед запуском проекта изменений.</p>
                        <p>Ответьте на 10 вопросов по шкале от 1 до 5, где:<br>
                        <strong>1 = Полностью не согласен</strong>, <strong>3 = Затрудняюсь ответить</strong>, <strong>5 = Полностью согласен</strong></p>
                    </div>

                    <!-- Прогресс -->
                    <div class="readiness-progress">
                        <div class="readiness-progress-bar">
                            <div class="readiness-progress-fill" id="readinessProgressFill"></div>
                        </div>
                        <span class="readiness-progress-text" id="readinessProgressText">Вопрос 1 из 10</span>
                    </div>

                    <!-- Вопросы -->
                    <div class="readiness-questions" id="readinessQuestions"></div>

                    <!-- Результаты -->
                    <div class="readiness-results" id="readinessResults" style="display: none;">
                        <h3>Результаты диагностики</h3>

                        <!-- Общий балл -->
                        <div class="readiness-overall">
                            <div class="readiness-overall-score" id="readinessOverallScore">0/50</div>
                            <div class="readiness-overall-level" id="readinessOverallLevel">Низкая готовность</div>
                            <div class="readiness-overall-description" id="readinessOverallDescription"></div>
                        </div>

                        <!-- Радар-чарт -->
                        <div class="readiness-radar-container">
                            <h4>Профиль готовности по категориям</h4>
                            <canvas id="readinessRadarChart" width="400" height="300"></canvas>
                        </div>

                        <!-- Детальные результаты -->
                        <div class="readiness-details">
                            <h4>Детальная оценка по категориям</h4>
                            <div class="readiness-categories" id="readinessCategories"></div>
                        </div>

                        <!-- Рекомендации -->
                        <div class="readiness-recommendations">
                            <h4>Рекомендации по улучшению</h4>
                            <div id="readinessRecommendations"></div>
                        </div>

                        <!-- Действия -->
                        <div class="readiness-actions">
                            <button class="panel-button" id="exportReadinessReport" type="button">📄 Скачать отчёт (PDF)</button>
                            <button class="panel-button secondary" onclick="resetReadinessAssessment()" type="button">🔄 Пройти снова</button>
                        </div>
                    </div>
                </div>
            `
        });

        // КОНСТРУКТОР ГИБРИДНОЙ МОДЕЛИ
        slidesData.push({
            title: "Конструктор гибридной модели",
            subtitle: "Создайте собственную модель управления изменениями из лучших практик",
            content: `
                <div class="practice-path-indicator">
                    <div class="path-indicator-header">
                        <h4>Путь оценки проекта</h4>
                        <span class="current-step">Шаг 4 из 5</span>
                    </div>
                    <div class="path-indicator">
                        <div class="path-step-indicator completed" onclick="jumpToSlide(65)" style="cursor: pointer;">
                            <div class="step-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.1 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"></path>
                                </svg>
                            </div>
                            <div class="step-label">Квиз</div>
                        </div>
                        <div class="path-connector completed"></div>
                        <div class="path-step-indicator completed" onclick="jumpToSlide(66)" style="cursor: pointer;">
                            <div class="step-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path>
                                </svg>
                            </div>
                            <div class="step-label">ROI</div>
                        </div>
                        <div class="path-connector completed"></div>
                        <div class="path-step-indicator completed" onclick="jumpToSlide(67)" style="cursor: pointer;">
                            <div class="step-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <circle cx="12" cy="8.5" r="3.5"></circle>
                                    <path d="M6 19c0-3.3 2.7-6 6-6s6 2.7 6 6"></path>
                                </svg>
                            </div>
                            <div class="step-label">Готовность</div>
                        </div>
                        <div class="path-connector completed"></div>
                        <div class="path-step-indicator active" onclick="jumpToSlide(68)" style="cursor: pointer;">
                            <div class="step-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"></path>
                                </svg>
                            </div>
                            <div class="step-label">Конструктор</div>
                        </div>
                        <div class="path-connector"></div>
                        <div class="path-step-indicator" onclick="jumpToSlide(69)" style="cursor: pointer;">
                            <div class="step-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                                </svg>
                            </div>
                            <div class="step-label">PCT</div>
                        </div>
                    </div>
                    <div class="path-navigation">
                        <button class="path-nav-btn secondary" onclick="jumpToSlide(67)">← Предыдущий шаг</button>
                        <button class="path-nav-btn" onclick="jumpToSlide(69)">Следующий шаг →</button>
                    </div>
                </div>

                <div class="hybrid-constructor">
                    <!-- Введение -->
                    <div class="hybrid-intro">
                        <p><strong>Гибридная модель</strong> позволяет комбинировать наиболее эффективные элементы из разных подходов к управлению изменениями для создания решения, идеально подходящего для вашей организации.</p>
                        <p>Выберите базовую модель и добавьте элементы из других подходов для создания уникальной комбинации.</p>
                    </div>

                    <!-- Шаг 1: Выбор базовой модели -->
                    <div class="hybrid-step" id="hybridStep1">
                        <h3>Шаг 1: Выберите базовую модель</h3>
                        <div class="hybrid-base-models" id="hybridBaseModels">
                            <!-- Модели будут загружены динамически -->
                        </div>
                    </div>

                    <!-- Шаг 2: Выбор дополнительных элементов -->
                    <div class="hybrid-step" id="hybridStep2" style="display: none;">
                        <h3>Шаг 2: Добавьте элементы из других моделей</h3>
                        <div class="hybrid-elements" id="hybridElements">
                            <!-- Элементы будут загружены динамически -->
                        </div>
                    </div>

                    <!-- Шаг 3: Предпросмотр и экспорт -->
                    <div class="hybrid-step" id="hybridStep3" style="display: none;">
                        <h3>Шаг 3: Ваша гибридная модель</h3>
                        <div class="hybrid-preview" id="hybridPreview">
                            <!-- Предпросмотр модели -->
                        </div>
                        <div class="hybrid-plan" id="hybridPlan">
                            <!-- План реализации -->
                        </div>
                        <div class="hybrid-actions">
                            <button class="panel-button" id="exportHybridModel" type="button">📄 Экспорт модели (PDF)</button>
                            <button class="panel-button secondary" onclick="resetHybridConstructor()" type="button">🔄 Создать заново</button>
                        </div>
                    </div>

                    <!-- Навигация -->
                    <div class="hybrid-navigation">
                        <button class="panel-button secondary" id="hybridPrevBtn" style="display: none;" onclick="prevHybridStep()">← Назад</button>
                        <button class="panel-button" id="hybridNextBtn" onclick="nextHybridStep()">Далее →</button>
                    </div>
                </div>
            `
        });

        // CLOSING SLIDES
        slidesData.push(
            {
                title: "Оценка Prosci Change Triangle (PCT)",
                subtitle: "Интерактивный инструмент диагностики проекта изменений",
                content: `
                    <div class="practice-path-indicator">
                        <div class="path-indicator-header">
                            <h4>Путь оценки проекта</h4>
                            <span class="current-step">Шаг 5 из 5</span>
                        </div>
                        <div class="path-indicator">
                            <div class="path-step-indicator completed" onclick="jumpToSlide(65)" style="cursor: pointer;">
                                <div class="step-icon">
                                    <svg viewBox="0 0 24 24" aria-hidden="true">
                                        <path d="M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.1 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"></path>
                                    </svg>
                                </div>
                                <div class="step-label">Квиз</div>
                            </div>
                            <div class="path-connector completed"></div>
                            <div class="path-step-indicator completed" onclick="jumpToSlide(66)" style="cursor: pointer;">
                                <div class="step-icon">
                                    <svg viewBox="0 0 24 24" aria-hidden="true">
                                        <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path>
                                    </svg>
                                </div>
                                <div class="step-label">ROI</div>
                            </div>
                            <div class="path-connector completed"></div>
                            <div class="path-step-indicator completed" onclick="jumpToSlide(67)" style="cursor: pointer;">
                                <div class="step-icon">
                                    <svg viewBox="0 0 24 24" aria-hidden="true">
                                        <circle cx="12" cy="8.5" r="3.5"></circle>
                                        <path d="M6 19c0-3.3 2.7-6 6-6s6 2.7 6 6"></path>
                                    </svg>
                                </div>
                                <div class="step-label">Готовность</div>
                            </div>
                            <div class="path-connector completed"></div>
                            <div class="path-step-indicator completed" onclick="jumpToSlide(68)" style="cursor: pointer;">
                                <div class="step-icon">
                                    <svg viewBox="0 0 24 24" aria-hidden="true">
                                        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"></path>
                                    </svg>
                                </div>
                                <div class="step-label">Конструктор</div>
                            </div>
                            <div class="path-connector completed"></div>
                            <div class="path-step-indicator active" onclick="jumpToSlide(69)" style="cursor: pointer;">
                                <div class="step-icon">
                                    <svg viewBox="0 0 24 24" aria-hidden="true">
                                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                                    </svg>
                                </div>
                                <div class="step-label">PCT</div>
                            </div>
                        </div>
                        <div class="path-navigation">
                            <button class="path-nav-btn secondary" onclick="jumpToSlide(68)">← Предыдущий шаг</button>
                            <button class="path-nav-btn" onclick="jumpToSlide(70)">Завершить →</button>
                        </div>
                    </div>

                    <div class="pct-tool">
                        <!-- Описание методологии -->
                        <div class="pct-intro">
                            <p><strong>Треугольник изменений Prosci (PCT)</strong> — инструмент оценки четырех критических аспектов успешного изменения: Успех, Лидерство/Спонсорство, Управление проектами и Управление изменениями.</p>
                            <p>Оцените каждый из 40 факторов по шкале от 1 до 3, где:<br>
                            <strong>1 = не применимо</strong>, <strong>2 = применимо</strong>, <strong>3 = превосходит ожидания</strong></p>
                        </div>

                        <!-- Прогресс заполнения -->
                        <div class="pct-progress">
                            <span id="pctProgressText">Оценено: 0 из 40 факторов</span>
                            <div class="pct-progress-bar">
                                <div id="pctProgressFill" class="pct-progress-fill"></div>
                            </div>
                        </div>

                        <!-- Табы категорий -->
                        <div class="pct-tabs" id="pctTabs">
                            <button class="pct-tab active" data-category="success" type="button">🎯 Успех</button>
                            <button class="pct-tab" data-category="leadership" type="button">👑 Лидерство</button>
                            <button class="pct-tab" data-category="projectManagement" type="button">📊 Проекты</button>
                            <button class="pct-tab" data-category="changeManagement" type="button">🔄 Изменения</button>
                        </div>

                        <!-- Контент категорий -->
                        <div class="pct-content" id="pctContent">
                            <!-- Динамически генерируется JS -->
                        </div>

                        <!-- Панель результатов -->
                        <div class="pct-results" id="pctResults">
                            <h3>Результаты оценки</h3>
                            <div class="pct-scores">
                                <div class="pct-score-item" id="pctScoreSuccess">
                                    <span class="pct-score-label">🎯 Успех</span>
                                    <span class="pct-score-value">0/30</span>
                                </div>
                                <div class="pct-score-item" id="pctScoreLeadership">
                                    <span class="pct-score-label">👑 Лидерство</span>
                                    <span class="pct-score-value">0/30</span>
                                </div>
                                <div class="pct-score-item" id="pctScoreProjectManagement">
                                    <span class="pct-score-label">📊 Проекты</span>
                                    <span class="pct-score-value">0/30</span>
                                </div>
                                <div class="pct-score-item" id="pctScoreChangeManagement">
                                    <span class="pct-score-label">🔄 Изменения</span>
                                    <span class="pct-score-value">0/30</span>
                                </div>
                            </div>
                            <div class="pct-visualization" id="pctVisualization">
                                <!-- SVG диаграмма -->
                            </div>
                            <div class="pct-recommendations" id="pctRecommendations">
                                <!-- Рекомендации -->
                            </div>
                        </div>

                        <!-- Кнопки действий -->
                        <div class="pct-actions">
                            <button class="panel-button" id="pctActionPlan" type="button">🎯 Сгенерировать план действий</button>
                            <button class="panel-button" id="pctExportPdf" type="button">📄 Экспорт в PDF</button>
                            <button class="panel-button secondary" id="pctReset" type="button">🔄 Сбросить оценку</button>
                        </div>
                    </div>
                `
            },
            {
                title: "Матрица Сравнения 56 Моделей",
                subtitle: "Комплексное сравнение в одном взгляде",
                content: `
                    <div class="chart-container">
                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 24px;">
                            <div class="card" style="background: var(--color-bg-1); text-align: center;">
                                <h3 style="font-size: 36px; margin-bottom: 8px;">15</h3>
                                <p style="margin: 0;">Контекстные Модели</p>
                            </div>
                            <div class="card" style="background: var(--color-bg-3); text-align: center;">
                                <h3 style="font-size: 36px; margin-bottom: 8px;">10</h3>
                                <p style="margin: 0;">Высокоуровневые Модели</p>
                            </div>
                            <div class="card" style="background: var(--color-bg-5); text-align: center;">
                                <h3 style="font-size: 36px; margin-bottom: 8px;">26</h3>
                                <p style="margin: 0;">Действенные Модели</p>
                            </div>
                            <div class="card" style="background: var(--color-bg-2); text-align: center;">
                                <h3 style="font-size: 36px; margin-bottom: 8px;">8</h3>
                                <p style="margin: 0;">Вспомогательные Модели</p>
                            </div>
                        </div>
                        <div class="highlight-box">
                            <h3 style="margin-bottom: 16px;">Ключевые Инсайты</h3>
                            <ul style="list-style: none;">
                                <li>→ <strong>Наиболее комплексные</strong>: Действенные модели (26) предоставляют детальные шаги реализации</li>
                                <li>→ <strong>Фундамент</strong>: Контекстные модели (15) помогают понять 'почему' и 'что'</li>
                                <li>→ <strong>Стратегические</strong>: Высокоуровневые модели (10) направляют общий подход</li>
                                <li>→ <strong>Инструменты</strong>: Вспомогательные модели (8) предоставляют инструменты и техники</li>
                            </ul>
                        </div>
                    </div>
                `
            },
            {
                title: "Интерактивный инструмент выбора модели",
                subtitle: "Найдите подходящую модель для вашего проекта",
                content: `
                    <div class="model-selector-tool">
                        <!-- Табы режимов -->
                        <div class="selector-mode-tabs">
                            <button class="mode-tab active" data-mode="table">Таблица сравнения</button>
                            <button class="mode-tab" data-mode="matrix">Матрица выбора</button>
                        </div>

                        <!-- Режим 1: Таблица сравнения -->
                        <div class="selector-mode-content" id="tableModeContent">
                            <div class="table-filters">
                                <input type="search" id="modelSearchInput" placeholder="Поиск по названию модели..." aria-label="Поиск моделей">
                                <div class="filter-group">
                                    <button class="filter-btn" data-filter="complexity" data-value="Низкая">Низкая сложность</button>
                                    <button class="filter-btn" data-filter="complexity" data-value="Средняя">Средняя сложность</button>
                                    <button class="filter-btn" data-filter="complexity" data-value="Высокая">Высокая сложность</button>
                                </div>
                                <div class="filter-group">
                                    <button class="filter-btn" data-filter="scale" data-value="Малый">Малый масштаб</button>
                                    <button class="filter-btn" data-filter="scale" data-value="Средний">Средний масштаб</button>
                                    <button class="filter-btn" data-filter="scale" data-value="Крупный">Крупный масштаб</button>
                                </div>
                                <div class="filter-group">
                                    <button class="filter-btn" data-filter="focus" data-value="Люди">Фокус на людях</button>
                                    <button class="filter-btn" data-filter="focus" data-value="Процессы">Фокус на процессах</button>
                                    <button class="filter-btn" data-filter="focus" data-value="Стратегия">Фокус на стратегии</button>
                                    <button class="filter-btn" data-filter="focus" data-value="Культура">Фокус на культуре</button>
                                </div>
                                <button class="reset-filters-btn" id="resetFiltersBtn" type="button">Сбросить фильтры</button>
                            </div>
                            <div class="comparison-table-wrapper">
                                <table class="model-comparison-table" id="modelsComparisonTable">
                                    <thead>
                                        <tr>
                                            <th data-sort="name">Название</th>
                                            <th data-sort="type">Тип</th>
                                            <th data-sort="complexity">Сложность</th>
                                            <th data-sort="scale">Масштаб</th>
                                            <th data-sort="duration">Срок</th>
                                            <th data-sort="focus">Фокус</th>
                                            <th>Выбор</th>
                                        </tr>
                                    </thead>
                                    <tbody id="modelsTableBody">
                                        <!-- Динамически генерируется JS -->
                                    </tbody>
                                </table>
                            </div>
                            <div class="selected-models-panel" id="selectedModelsPanel">
                                <div class="selected-models-header">
                                    <h4>Выбранные модели для сравнения (макс. 3)</h4>
                                    <button class="clear-selection-btn" id="clearSelectionBtn" type="button">Очистить</button>
                                </div>
                                <div id="selectedModelsList"></div>
                                <button class="compare-models-btn" id="compareModelsBtn" type="button" style="display: none;">Сравнить модели</button>
                            </div>
                        </div>

                        <!-- Режим 2: Матрица выбора -->
                        <div class="selector-mode-content" id="matrixModeContent" style="display:none">
                            <div class="selection-matrix">
                                <div class="matrix-step">
                                    <h4>Шаг 1: Масштаб изменений</h4>
                                    <div class="matrix-parameters">
                                        <div class="matrix-parameter" data-step="1" data-value="Малый">
                                            <div class="matrix-parameter-icon">👥</div>
                                            <div class="matrix-parameter-title">Малый</div>
                                            <div class="matrix-parameter-description">Команда или отдел, локальные процессы</div>
                                        </div>
                                        <div class="matrix-parameter" data-step="1" data-value="Средний">
                                            <div class="matrix-parameter-icon">🏢</div>
                                            <div class="matrix-parameter-title">Средний</div>
                                            <div class="matrix-parameter-description">Несколько отделов, кросс-функциональные процессы</div>
                                        </div>
                                        <div class="matrix-parameter" data-step="1" data-value="Крупный">
                                            <div class="matrix-parameter-icon">🌐</div>
                                            <div class="matrix-parameter-title">Крупный</div>
                                            <div class="matrix-parameter-description">Вся организация или холдинг</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="matrix-step">
                                    <h4>Шаг 2: Скорость внедрения</h4>
                                    <div class="matrix-parameters">
                                        <div class="matrix-parameter" data-step="2" data-value="Быстро">
                                            <div class="matrix-parameter-icon">⚡</div>
                                            <div class="matrix-parameter-title">Быстро</div>
                                            <div class="matrix-parameter-description">1-3 месяца, срочные изменения</div>
                                        </div>
                                        <div class="matrix-parameter" data-step="2" data-value="Средне">
                                            <div class="matrix-parameter-icon">🕐</div>
                                            <div class="matrix-parameter-title">Средне</div>
                                            <div class="matrix-parameter-description">3-6 месяцев, сбалансированный подход</div>
                                        </div>
                                        <div class="matrix-parameter" data-step="2" data-value="Долго">
                                            <div class="matrix-parameter-icon">📅</div>
                                            <div class="matrix-parameter-title">Долго</div>
                                            <div class="matrix-parameter-description">6+ месяцев, фундаментальные изменения</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="recommendations-panel" id="matrixRecommendations">
                                <div class="recommendations-header">
                                    <h3>Рекомендованные модели</h3>
                                    <p>На основе ваших параметров мы подобрали наиболее подходящие модели</p>
                                </div>
                                <div class="recommended-models" id="recommendedModelsList">
                                    <!-- Рекомендации генерируются JS -->
                                </div>
                                <div class="recommendations-actions">
                                    <button class="restart-matrix-btn" id="restartMatrixBtn" type="button">Начать заново</button>
                                    <button class="panel-button" onclick="jumpToSlide(65)" type="button">Пройти квиз для точных рекомендаций</button>
                                </div>
                            </div>
                        </div>
                    </div>
                `
            },
            {
                title: "Ключевые Выводы и Рекомендации",
                subtitle: "Семь критичных инсайтов для успешного управления изменениями в 2025",
                content: `
                    <div class="grid-2">
                        <div class="card">
                            <h3>1. НЕ СУЩЕСТВУЕТ ОДНОЙ "ЛУЧШЕЙ" МОДЕЛИ</h3>
                            <p>Каждая модель подходит для разных ситуаций. Выбор зависит от контекста, культуры, людей. Лучше всего: комбинировать несколько.</p>
                        </div>
                        <div class="card">
                            <h3>2. ЛЮДИ - ВСЕГДА В ЦЕНТРЕ</h3>
                            <p>Технология не вызывает изменения. Люди совершают изменения. Фокус на психологии и эмоциях критичен.</p>
                        </div>
                        <div class="card">
                            <h3>3. ЧЕТЫРЕ КРИТИЧНЫХ ФАКТОРА УСПЕХА</h3>
                            <p>✓ Видимое спонсорство<br>✓ Четкая коммуникация<br>✓ Вовлечение и поддержка<br>✓ Справедливое управление сопротивлением</p>
                        </div>
                        <div class="card">
                            <h3>4. ГИБКОСТЬ И АДАПТАЦИЯ ВАЖНЕЕ ПЛАНА</h3>
                            <p>Планы не выживают при контакте с реальностью. Нужна способность адаптироваться. PDCA циклы, Agile - лучше чем Waterfall.</p>
                        </div>
                        <div class="card">
                            <h3>5. СКОРОСТЬ И КАЧЕСТВО ВАЖНЫ ОДИНАКОВО</h3>
                            <p>Быстрые результаты поддерживают мотивацию. Но долгосрочное качество поддерживает устойчивость. Гибридный подход - лучше всего.</p>
                        </div>
                        <div class="card">
                            <h3>6. ИЗМЕРЕНИЕ И ДАННЫЕ КРИТИЧНЫ</h3>
                            <p>Без метрик нет контроля. Данные показывают, работает или нет. Дашборды готовности и метрики успеха необходимы.</p>
                        </div>
                        <div class="card">
                            <h3>7. КУЛЬТУРА ОРГАНИЗАЦИИ ОПРЕДЕЛЯЕТ МЕТОД</h3>
                            <p>Консервативная организация → более структурированные модели. Инновационная организация → Agile, PDCA, экспериментирование.</p>
                        </div>
                    </div>
                `
            },
            
            // СЛАЙД 65 - PCT ОЦЕНКА (ИНТЕРАКТИВНЫЙ ИНСТРУМЕНТ ДИАГНОСТИКИ)
            
            // СЛАЙД 66 - ПОСЛЕДНИЙ СЛАЙД
            {
                title: "Спасибо за время",
                subtitle: "",
                content: `
                    <div class="final-slide-elegant">
                        <!-- Блок благодарности -->
                        <div class="final-thanks">
                            <h2>Спасибо за время</h2>
                            <p>Теперь у вас есть инструменты<br>для управления изменениями</p>
                        </div>

                        <!-- Блок контакта -->
                        <div class="final-contact">
                            <p class="contact-question">💬 Нужна помощь в изменениях?</p>
                            <h3 class="contact-name">Дмитрий Владимиров</h3>
                            <a href="https://www.linkedin.com/in/dmitry-vladimirov-cdto"
                               target="_blank"
                               rel="noopener noreferrer"
                               class="linkedin-button">
                                LinkedIn →
                            </a>
                        </div>

                        <!-- Блок вторичных действий -->
                        <div class="final-actions">
                            <button onclick="location.reload()" class="action-secondary" type="button">
                                🔄 Начать снова
                            </button>
                            <button onclick="exportToPDF()" class="action-secondary" type="button">
                                📄 Сохранить
                            </button>
                        </div>
                    </div>
                `
            }
        );
        
        // ========== PCT Assessment Data ==========
        const pctAssessment = {
            description: "Модель треугольника изменений Prosci (Prosci Change Triangle – PCT) представляет собой простую, но действенную основу, состоящую из четырех аспектов любого успешного изменения: Успех: точные, ясные цели и результаты инициативы. Лидерство/Спонсорство: стратегия, направление, управление. Управление проектами: техническая сторона изменения, связанная с разработкой и реализацией проектного решения. Управление изменениями: человеческая сторона изменения, направленная на обеспечение принятия и использования проектного решения людьми для достижения результатов и выгод проекта.",
            categories: {
                success: {
                    id: 'success',
                    label: 'Успех',
                    icon: '🎯',
                    color: '#2DB67D',
                    description: 'Точные, ясные цели и результаты инициативы',
                    factors: [
                        { id: 1, text: 'Определены входные данные для процесса управления изменениями (могут включать бизнес-кейс, устав, объем и план проекта).' },
                        { id: 2, text: 'Точно определены выгоды организации (что организация получит в результате изменений).' },
                        { id: 3, text: 'Точно определены цели проекта (что будет результатом проекта).' },
                        { id: 4, text: 'Точно определены целевые показатели принятия и использования.' },
                        { id: 5, text: 'Установлены единицы измерения целей и выгод.' },
                        { id: 6, text: 'Выгоды и цели приоритизированы.' },
                        { id: 7, text: 'Назначены ответственные за достижение целей и выгод.' },
                        { id: 8, text: 'Проведена оценка насколько цели и выгоды проекта зависят от людей.' },
                        { id: 9, text: 'Критерии успеха определены и могут быть коммуницированы сотрудникам.' },
                        { id: 10, text: 'У спонсорской коалиции единое понимание критериев успеха.' }
                    ]
                },
                leadership: {
                    id: 'leadership',
                    label: 'Лидерство/Спонсорство',
                    icon: '👑',
                    color: '#F4A100',
                    description: 'Стратегия, направление, управление',
                    factors: [
                        { id: 1, text: 'У изменений есть спонсор, обладающий властью над людьми, процессами и системами, необходимой для принятия решений по изменениям и их финансированию.' },
                        { id: 2, text: 'Основной спонсор может четко определить суть изменений, причину изменений и выгоды для организации.' },
                        { id: 3, text: 'У организации есть четко определенное видение и стратегия.' },
                        { id: 4, text: 'Изменения согласованы с видением и стратегией организации.' },
                        { id: 5, text: 'Приоритетность этих изменений относительно других инициатив была определена и сообщена всем заинтересованным лицам.' },
                        { id: 6, text: 'Основной спонсор решает проблемы и принимает решения, относящиеся к графику, объему и ресурсам проекта.' },
                        { id: 7, text: 'Основной спонсор принимает активное и видимое участие в проекте совместно с проектной командой на всем его протяжении.' },
                        { id: 8, text: 'Основной спонсор вовлекает других руководителей в изменения и формирует спонсорскую коалицию в поддержку изменений.' },
                        { id: 9, text: 'Основной спонсор формирует понимание необходимости изменений у сотрудников, общаясь с ними напрямую.' },
                        { id: 10, text: 'Основной спонсор публично закрепляет изменения, празднуя успехи и работая с сопротивлением.' }
                    ]
                },
                projectManagement: {
                    id: 'projectManagement',
                    label: 'Управление проектами',
                    icon: '📊',
                    color: '#4A90E2',
                    description: 'Техническая сторона изменения, связанная с разработкой и реализацией проектного решения',
                    factors: [
                        { id: 1, text: 'Изменение четко определено, включая то, на каких людей оно повлияет и каким образом.' },
                        { id: 2, text: 'Проект имеет конкретные цели.' },
                        { id: 3, text: 'Проект имеет четко определенный функциональный и организационный объем.' },
                        { id: 4, text: 'Был назначен руководитель проекта для управления жизненным циклом проекта.' },
                        { id: 5, text: 'Определены ключевые вехи и разработан план-график проекта.' },
                        { id: 6, text: 'Были распределены рабочие задачи и определены их требуемые результаты.' },
                        { id: 7, text: 'Были определены и получены проектные ресурсы в соответствии с распределенными рабочими задачами.' },
                        { id: 8, text: 'Назначены сроки проведения регулярных совещаний проектной команды для фиксации промежуточных результатов и решения возникающих проблем.' },
                        { id: 9, text: 'Руководитель проекта понимает, что управление изменениями поможет обеспечить принятие и использование изменений.' },
                        { id: 10, text: 'План управления изменениями интегрирован в план проекта.' }
                    ]
                },
                changeManagement: {
                    id: 'changeManagement',
                    label: 'Управление изменениями',
                    icon: '🔄',
                    color: '#E01E5A',
                    description: 'Человеческая сторона изменения, направленная на обеспечение принятия и использования проектного решения',
                    factors: [
                        { id: 1, text: 'На проекте применяется структурированный подход к управлению изменениями для получения организацией запланированных выгод.' },
                        { id: 2, text: 'Была проведена оценка параметров изменений и их влияния на сотрудников и организацию.' },
                        { id: 3, text: 'Была проведена оценка уровня риска.' },
                        { id: 4, text: 'У изменений есть конкретные показатели принятия и использования.' },
                        { id: 5, text: 'Была проведена оценка состава спонсорской коалиции.' },
                        { id: 6, text: 'Разработана стратегия по управлению изменениями, отражающая специфику и масштаб проекта, а также необходимую поддержку со стороны спонсоров.' },
                        { id: 7, text: 'Выделены и подготовлены необходимые ресурсы для реализации стратегии по управлению изменениями.' },
                        { id: 8, text: 'Разработаны и реализуются планы управления изменениями для минимизации сопротивления и обеспечения принятия и использования изменений.' },
                        { id: 9, text: 'Эффективность управления изменениями постоянно измеряется и при необходимости принимаются корректирующие меры для обеспечения принятия и использования изменений.' },
                        { id: 10, text: 'Организация готова принять ответственность за изменение и его устойчивое использование.' }
                    ]
                }
            },
            scoring: {
                excellent: { min: 25, max: 30, label: 'Сильная сторона проекта – необходимо поддерживать и использовать', color: '#2DB67D', class: 'excellent' },
                moderate: { min: 20, max: 24, label: 'Есть риски - необходимо провести дополнительный анализ', color: '#F4A100', class: 'moderate' },
                risk: { min: 10, max: 19, label: 'Высокий риск – необходимо немедленно принять меры', color: '#E01E5A', class: 'risk' }
            }
        };

        // ========== Quiz Assessment Data ==========
        const quizData = {
            questions: [
                {
                    id: 1,
                    question: "Какой у вас опыт управления изменениями?",
                    options: [
                        { text: "Я новичок в этой области", value: "beginner" },
                        { text: "У меня есть базовый опыт (1-3 года)", value: "intermediate" },
                        { text: "У меня значительный опыт (3+ лет)", value: "expert" },
                        { text: "Я эксперт в данной области", value: "advanced" }
                    ]
                },
                {
                    id: 2,
                    question: "Какой масштаб изменений вы обычно реализуете?",
                    options: [
                        { text: "Небольшие локальные изменения", value: "small" },
                        { text: "Средние изменения в отделе/подразделении", value: "medium" },
                        { text: "Крупные изменения в организации", value: "large" },
                        { text: "Трансформационные изменения всей организации", value: "enterprise" }
                    ]
                },
                {
                    id: 3,
                    question: "Какой у вас подход к управлению изменениями?",
                    options: [
                        { text: "Строго структурированный и планируемый", value: "structured" },
                        { text: "Гибкий и адаптивный", value: "agile" },
                        { text: "Сочетание структуры и гибкости", value: "hybrid" },
                        { text: "Зависит от конкретной ситуации", value: "situational" }
                    ]
                },
                {
                    id: 4,
                    question: "Какие факторы вы считаете наиболее важными для успеха изменений?",
                    options: [
                        { text: "Сильное лидерство и спонсорство", value: "leadership" },
                        { text: "Четкое планирование и ресурсы", value: "planning" },
                        { text: "Вовлечение и коммуникация с сотрудниками", value: "communication" },
                        { text: "Техническая реализация и инструменты", value: "technical" }
                    ]
                },
                {
                    id: 5,
                    question: "Как вы относитесь к сопротивлению изменениям?",
                    options: [
                        { text: "Это серьезная проблема, требующая активного управления", value: "resistance_management" },
                        { text: "Это нормально, но можно минимизировать", value: "resistance_minimize" },
                        { text: "Сопротивление - это возможность для улучшения", value: "resistance_opportunity" },
                        { text: "Я предпочитаю избегать сопротивления через вовлечение", value: "resistance_prevent" }
                    ]
                },
                {
                    id: 6,
                    question: "Какой тип культуры преобладает в вашей организации?",
                    options: [
                        { text: "Консервативная, сопротивляющаяся изменениям", value: "conservative" },
                        { text: "Сбалансированная, умеренно открытая", value: "balanced" },
                        { text: "Инновационная, приветствующая изменения", value: "innovative" },
                        { text: "Зависит от конкретного подразделения", value: "diverse" }
                    ]
                },
                {
                    id: 7,
                    question: "Какой результат вы ожидаете от внедрения модели управления изменениями?",
                    options: [
                        { text: "Снижение рисков и повышение вероятности успеха", value: "risk_reduction" },
                        { text: "Улучшение коммуникации и вовлеченности", value: "communication_improvement" },
                        { text: "Структурированный подход к изменениям", value: "structured_approach" },
                        { text: "Комплексное решение всех аспектов изменений", value: "comprehensive_solution" }
                    ]
                }
            ],
            profiles: {
                beginner_structured: {
                    name: "Новичок со структурированным подходом",
                    description: "Вы только начинаете свой путь в управлении изменениями и предпочитаете четкие инструкции и пошаговые руководства.",
                    recommendedModels: [
                        { name: "Модель ADKAR", sources: ["базовый уровень", "пошаговый подход"] },
                        { name: "Модель Kübler-Ross", sources: ["эмоциональная сторона", "простота понимания"] },
                        { name: "Стандарт ACMP", sources: ["структурированный подход", "комплексность"] }
                    ]
                },
                intermediate_hybrid: {
                    name: "Опытный практик с гибридным подходом",
                    description: "У вас есть практический опыт, и вы понимаете, что каждый проект уникален, требуя индивидуального подхода.",
                    recommendedModels: [
                        { name: "Модель McKinsey", sources: ["стратегический уровень", "комплексный анализ"] },
                        { name: "Модель Kotter", sources: ["практическая реализация", "пошаговый процесс"] },
                        { name: "Конструктор гибридных моделей", sources: ["индивидуальный подход", "комбинация лучших практик"] }
                    ]
                },
                expert_situational: {
                    name: "Эксперт с ситуационным подходом",
                    description: "Вы имеете глубокий опыт и выбираете инструменты в зависимости от конкретного контекста и требований.",
                    recommendedModels: [
                        { name: "Модель Prosci", sources: ["профессиональный стандарт", "комплексная методология"] },
                        { name: "Модель GE", sources: ["крупные трансформации", "корпоративный опыт"] },
                        { name: "PCT Оценка", sources: ["диагностика проекта", "профессиональный анализ"] }
                    ]
                },
                technical_focused: {
                    name: "Технически ориентированный менеджер",
                    description: "Вы фокусируетесь на технической стороне реализации, но понимаете важность человеческого фактора.",
                    recommendedModels: [
                        { name: "Модель АИМ", sources: ["техническая реализация", "управление рисками"] },
                        { name: "Модель DMAIC (Six Sigma)", sources: ["структурированный процесс", "качество"] },
                        { name: "ROI Калькулятор", sources: ["экономическая оценка", "обоснование инвестиций"] }
                    ]
                }
            }
        };

        // ========== Quiz State ==========
        let quizState = {
            currentQuestion: 0,
            answers: [],
            completed: false
        };

        fullSlidesCount = slidesData.length;
        totalSlides = fullSlidesCount;
        classicalStartIndex = baseSlidesCount;
        newModelsStartIndex = classicalStartIndex + classicalModels.length;
        closingSlidesStartIndex = newModelsStartIndex + newModels.length;
        closingSlidesCount = fullSlidesCount - closingSlidesStartIndex;
        visibleSlides = Array.from({ length: fullSlidesCount }, (_, index) => index);
        visibleSlidesSet = new Set(visibleSlides);
        finalSlideIndex = fullSlidesCount - 1;
        modelsChartSlideIndex = findSlideIndexByKeyword('ландшафт');
        
        
        buildLearningPaths();
        visibleSlides = learningPaths.expert.slides.slice();
        visibleSlidesSet = new Set(visibleSlides);
        totalSlides = visibleSlides.length;
        buildSearchIndex();
        
        function initPresentation() {
            // Отладочная информация только в режиме разработки
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                console.log('=== initPresentation() вызвана ===');
                console.log('slidesData.length:', slidesData.length);
                console.log('fullSlidesCount:', fullSlidesCount);
                console.log('visibleSlides.length:', visibleSlides.length);
            }

            const container = document.getElementById('slideContainer');

            if (!container) {
                console.error('Критическая ошибка: Контейнер слайдов не найден в DOM. Проверьте структуру HTML.');
                showErrorMessage('Ошибка инициализации: контейнер слайдов не найден');
                return;
            }

            if (!slidesData || slidesData.length === 0) {
                console.error('Критическая ошибка: Данные слайдов отсутствуют или пусты');
                showErrorMessage('Ошибка инициализации: данные презентации не загружены');
                return;
            }

            // Отладочная информация только в режиме разработки
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                console.log('Начинаем создание', slidesData.length, 'слайдов...');
            }
            
            // Generate slides
            slidesData.forEach((slide, index) => {
                const slideDiv = document.createElement('div');
                slideDiv.className = 'slide';
                if (index === 0) slideDiv.classList.add('active');
                slideDiv.innerHTML = `
                    <div class="slide-header">
                        <h1 class="slide-title">${slide.title}</h1>
                        ${slide.subtitle ? `<div class="slide-subtitle">${slide.subtitle}</div>` : ''}
                    </div>
                    ${slide.content}
                `;
                container.appendChild(slideDiv);
                
                // Add to selector
                const option = document.createElement('option');
                option.value = String(index);
                option.dataset.index = String(index);
                option.textContent = `${index + 1}. ${slide.title.substring(0, 50)}${slide.title.length > 50 ? '...' : ''}`;
                modelSelectorEl.appendChild(option);
            });
            
            console.log('Создано слайдов:', container.querySelectorAll('.slide').length);
            console.log('Слайды в селекторе:', modelSelectorEl.options.length - 1); // -1 для placeholder
            
            updateNavigation();
            activateSlide(currentSlide);
        }
        
        function updateCircularProgress(ratio) {
            if (!progressCircleEl || !progressCountEl) return;
            const clamped = Math.min(Math.max(ratio, 0), 1);
            progressCircleEl.style.strokeDashoffset = PROGRESS_CIRCUMFERENCE * (1 - clamped);
            const position = getVisiblePosition(currentSlide);
            const totalVisible = visibleSlides.length || 1;
            progressCountEl.textContent = `${position + 1} / ${totalVisible}`;
        }
        
        function updateBookmarkUI() {
            if (!bookmarkToggleBtn) return;
            const isBookmarked = bookmarks.has(currentSlide);
            bookmarkToggleBtn.classList.toggle('active', isBookmarked);
            bookmarkToggleBtn.textContent = isBookmarked ? '★ В избранном' : '☆ Избранное';
            if (bookmarkPanelToggleBtn) {
                bookmarkPanelToggleBtn.textContent = bookmarks.size
                    ? `Список ⭐ (${bookmarks.size})`
                    : 'Список ⭐';
            }
        }
        
        function renderBookmarkList() {
            if (!bookmarkListEl || !bookmarkEmptyEl) return;
            bookmarkListEl.innerHTML = '';
            const sortedBookmarks = [...bookmarks].sort((a, b) => a - b);
            
            if (!sortedBookmarks.length) {
                bookmarkEmptyEl.style.display = 'block';
                highlightActiveBookmark();
                return;
            }
            
            bookmarkEmptyEl.style.display = 'none';
            sortedBookmarks.forEach((slideIndex) => {
                const listItem = document.createElement('li');
                listItem.className = 'bookmark-item';
                listItem.dataset.slide = slideIndex;
                
                const title = slidesData[slideIndex]?.title ?? `Слайд ${slideIndex + 1}`;
                listItem.innerHTML = `
                    <div>
                        <strong>${slideIndex + 1}</strong>
                        <span>${title}</span>
                    </div>
                    <button class="panel-button secondary" data-remove="${slideIndex}" type="button">Удалить</button>
                `;
                
                bookmarkListEl.appendChild(listItem);
            });
            
            highlightActiveBookmark();
        }
        
        function highlightActiveBookmark() {
            if (!bookmarkListEl) return;
            bookmarkListEl.querySelectorAll('.bookmark-item').forEach((item) => {
                const slideIndex = Number(item.dataset.slide);
                item.classList.toggle('active', slideIndex === currentSlide);
            });
        }
        
        function toggleBookmark() {
            if (bookmarks.has(currentSlide)) {
                bookmarks.delete(currentSlide);
            } else {
                bookmarks.add(currentSlide);
            }
            saveBookmarks();
            renderBookmarkList();
            updateBookmarkUI();
        }
        
        function toggleBookmarkPanel(forceState) {
            if (!bookmarkPanelEl || !bookmarkPanelToggleBtn) return;
            const shouldOpen = typeof forceState === 'boolean'
                ? forceState
                : !bookmarkPanelEl.classList.contains('active');
            bookmarkPanelEl.classList.toggle('active', shouldOpen);
            bookmarkPanelToggleBtn.classList.toggle('active', shouldOpen);
            if (shouldOpen) {
                renderBookmarkList();
                highlightActiveBookmark();
            }
        }
        
        function saveBookmarks() {
            const serialized = JSON.stringify([...bookmarks].sort((a, b) => a - b));
            localStorage.setItem(BOOKMARK_STORAGE_KEY, serialized);
        }
        
        function toggleNotesPanel(forceState) {
            if (!notesPanelEl || !notesToggleBtn) return;
            const shouldOpen = typeof forceState === 'boolean'
                ? forceState
                : !notesPanelEl.classList.contains('active');
            notesPanelEl.classList.toggle('active', shouldOpen);
            notesToggleBtn.classList.toggle('active', shouldOpen);
            if (shouldOpen) {
                syncNotesPanel();
                if (notesTextareaEl) {
                    notesTextareaEl.focus({ preventScroll: false });
                }
            }
        }
        
        function syncNotesPanel() {
            if (!notesTextareaEl) return;
            const noteValue = notesStore[currentSlide] ?? '';
            if (notesTextareaEl.value !== noteValue) {
                notesTextareaEl.value = noteValue;
            }
            updateNotesStatus(noteValue);
        }
        
        function updateNotesStatus(value) {
            if (!notesStatusEl) return;
            notesStatusEl.textContent = value && value.trim().length
                ? 'Сохранено'
                : 'Заметок пока нет';
        }
        
        function handleNotesInput() {
            if (!notesTextareaEl) return;
            if (notesStatusEl) {
                notesStatusEl.textContent = 'Сохраняю...';
            }
            if (notesSaveTimeout) {
                clearTimeout(notesSaveTimeout);
            }
            notesSaveTimeout = setTimeout(() => {
                const value = notesTextareaEl.value;
                if (value && value.trim().length) {
                    notesStore[currentSlide] = value;
                } else {
                    delete notesStore[currentSlide];
                }
                localStorage.setItem(NOTES_STORAGE_KEY, JSON.stringify(notesStore));
                updateNotesStatus(notesStore[currentSlide] ?? '');
            }, 400);
        }
        
        function clearNotes() {
            if (!notesTextareaEl) return;
            notesTextareaEl.value = '';
            delete notesStore[currentSlide];
            localStorage.setItem(NOTES_STORAGE_KEY, JSON.stringify(notesStore));
            updateNotesStatus('');
        }
        
        const achievementQueue = [];
        let achievementVisible = false;
        
        function checkAchievements(slideIndex) {
            const viewedCount = slidesVisited.size;

            for (const threshold of achievementThresholds) {
                // Специальный случай: финальное достижение при просмотре всех слайдов
                if (threshold.slidesCount === null) {
                    if (viewedCount >= fullSlidesCount && !unlockedAchievements.has(threshold.id)) {
                        unlockedAchievements.add(threshold.id);
                        localStorage.setItem(ACHIEVEMENT_STORAGE_KEY, JSON.stringify([...unlockedAchievements]));
                        queueAchievement(threshold);
                        break;
                    }
                    continue;
                }

                // Обычные достижения: проверяем количество просмотренных слайдов
                if (viewedCount >= threshold.slidesCount && !unlockedAchievements.has(threshold.id)) {
                    unlockedAchievements.add(threshold.id);
                    localStorage.setItem(ACHIEVEMENT_STORAGE_KEY, JSON.stringify([...unlockedAchievements]));
                    queueAchievement(threshold);
                    break;
                }
            }
        }
        
        function queueAchievement(threshold) {
            achievementQueue.push(threshold);
            showNextAchievement();
        }
        
        function showNextAchievement() {
            if (achievementVisible) return;
            const nextAchievement = achievementQueue.shift();
            if (!nextAchievement || !achievementModalEl || !achievementTitleEl || !achievementMessageEl) return;
            achievementVisible = true;
            achievementTitleEl.textContent = nextAchievement.title;
            achievementMessageEl.textContent = nextAchievement.message;
            achievementModalEl.classList.add('active');
        }
        
        function hideAchievementModal() {
            if (!achievementModalEl) return;
            achievementModalEl.classList.remove('active');
            achievementVisible = false;
            if (achievementQueue.length) {
                setTimeout(showNextAchievement, 200);
            }
        }
        
        function getVisiblePosition(slideIndex) {
            return visibleSlides.indexOf(slideIndex);
        }
        
        function findNextVisibleSlide(startIndex, direction) {
            if (!visibleSlides.length) return startIndex;
            const currentPos = getVisiblePosition(startIndex);
            if (currentPos === -1) {
                return visibleSlides[0];
            }
            let newPosition = currentPos + direction;
            newPosition = Math.max(0, Math.min(visibleSlides.length - 1, newPosition));
            return visibleSlides[newPosition];
        }
        
        function refreshModelSelector() {
            if (!modelSelectorEl) return;
            Array.from(modelSelectorEl.options).forEach((option) => {
                if (option.value === '') {
                    option.hidden = false;
                    return;
                }
                const slideIndex = Number(option.value);
                option.hidden = !visibleSlidesSet.has(slideIndex);
            });
        }
        
        function setLearningPath(pathId, options = {}) {
            const path = learningPaths[pathId] ?? learningPaths.expert;
            activeLearningPath = path.id;
            visibleSlides = path.slides.length ? path.slides.slice() : Array.from({ length: fullSlidesCount }, (_, index) => index);
            visibleSlidesSet = new Set(visibleSlides);
            totalSlides = visibleSlides.length;
            
            if (!visibleSlidesSet.has(currentSlide)) {
                currentSlide = visibleSlides[0] ?? 0;
            }
            
            if (pathMetaEl) {
                pathMetaEl.textContent = `${path.label} • ${path.description}`;
            }
            if (pathSelectorEl && !options.skipSelectorSync) {
                pathSelectorEl.value = activeLearningPath;
            }
            
            refreshModelSelector();
            
            if (!options.skipNavigationUpdate) {
                updateNavigation();
            }
        }
        
        function formatDuration(milliseconds) {
            const totalSeconds = Math.max(0, Math.floor(milliseconds / 1000));
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            return `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }
        
        function updateFinalStats() {
            const slidesValueEl = document.getElementById('ctaSlidesViewed');
            const bookmarksEl = document.getElementById('ctaBookmarksCount');
            const pathEl = document.getElementById('ctaActivePath');
            const timeEl = document.getElementById('ctaTimeSpent');
            const quizStatusEl = document.getElementById('ctaQuizStatus');
            
            if (slidesValueEl) {
                slidesValueEl.textContent = String(slidesVisited.size);
            }
            if (bookmarksEl) {
                bookmarksEl.textContent = String(bookmarks.size);
            }
            if (pathEl) {
                const path = learningPaths[activeLearningPath];
                pathEl.textContent = path ? path.label : 'Экспертный путь';
            }
            if (timeEl) {
                timeEl.textContent = formatDuration(Date.now() - startTime);
            }
            if (quizStatusEl) {
                quizStatusEl.textContent = quizCompleted
                    ? 'Мини-диагностика: пройдена 🎯'
                    : 'Мини-диагностика: ещё можно пройти на слайде 7';
            }
        }
        
        function findSlideIndexByKeyword(keyword) {
            if (!keyword) return -1;
            const lowerKeyword = keyword.toLowerCase();
            return slidesData.findIndex((slide) => {
                const title = (slide.title ?? '').toLowerCase();
                const subtitle = (slide.subtitle ?? '').toLowerCase();
                return title.includes(lowerKeyword) || subtitle.includes(lowerKeyword);
            });
        }
        
        function resolveQuizResult(answers) {
            // Получаем информацию по всем 5 категориям
            const scopeInfo = quizScopeMap[answers.scope] ?? quizScopeMap.small;
            const resistanceInfo = quizResistanceMap[answers.resistance] ?? quizResistanceMap.mixed;
            const paceInfo = quizPaceMap[answers.pace] ?? quizPaceMap.iterative;
            const cultureInfo = quizCultureMap[answers.culture] ?? quizCultureMap.hybrid;
            const resourcesInfo = quizResourcesMap[answers.resources] ?? quizResourcesMap.adequate;

            // Собираем все рекомендации из 5 категорий
            const combinedRecommendations = [
                ...scopeInfo.recommendations,
                ...resistanceInfo.recommendations,
                ...paceInfo.recommendations,
                ...cultureInfo.recommendations,
                ...resourcesInfo.recommendations
            ];

            // Группируем по ключевому слову и рассчитываем средний процент соответствия
            const recommendationsMap = new Map();
            combinedRecommendations.forEach((item) => {
                const key = item.keyword.toLowerCase();
                if (recommendationsMap.has(key)) {
                    const existing = recommendationsMap.get(key);
                    existing.totalMatch += item.baseMatch;
                    existing.count += 1;
                    existing.sources.add(item.label);
                } else {
                    recommendationsMap.set(key, {
                        ...item,
                        totalMatch: item.baseMatch,
                        count: 1,
                        sources: new Set([item.label])
                    });
                }
            });

            // Преобразуем в массив с рассчитанными процентами
            const uniqueRecommendations = Array.from(recommendationsMap.values())
                .map(item => ({
                    ...item,
                    matchPercent: Math.round(item.totalMatch / item.count),
                    sources: Array.from(item.sources)
                }))
                .sort((a, b) => b.matchPercent - a.matchPercent)
                .slice(0, 3); // Берем топ-3 по соответствию

            // Находим слайды для перехода
            const jumpTargets = uniqueRecommendations
                .map((item) => findSlideIndexByKeyword(item.keyword))
                .filter((index) => index >= 0);

            // Собираем описание профиля проекта
            const profileDescription = [
                scopeInfo.title,
                resistanceInfo.title,
                paceInfo.title,
                cultureInfo.title,
                resourcesInfo.title
            ].join(' • ');

            // Сохраняем профиль в localStorage
            const profileData = {
                answers,
                recommendations: uniqueRecommendations,
                profileDescription,
                timestamp: new Date().toISOString(),
                version: '2.0'
            };
            localStorage.setItem('quizProfile', JSON.stringify(profileData));

            return {
                title: 'Персональные рекомендации',
                profile: profileDescription,
                models: uniqueRecommendations,
                jumpTargets,
                profileData
            };
        }
        
        function setupQuiz() {
            const quizRoot = document.getElementById('quizApp');
            const quizProgressEl = document.getElementById('quizProgress');
            if (!quizRoot) return;
            
            const answers = {};
            let stepIndex = 0;
            
            renderStep();
            
            function renderStep() {
                const currentStep = quizSteps[stepIndex];
                if (!currentStep) {
                    renderResult();
                    return;
                }
                
                if (quizProgressEl) {
                    quizProgressEl.textContent = `Вопрос ${stepIndex + 1} из ${quizSteps.length}`;
                }
                
                quizRoot.innerHTML = '';
                
                const stepContainer = document.createElement('div');
                stepContainer.className = 'quiz-step';
                
                const titleEl = document.createElement('div');
                titleEl.className = 'quiz-step-title';
                titleEl.textContent = currentStep.question;
                stepContainer.appendChild(titleEl);
                
                const optionsEl = document.createElement('div');
                optionsEl.className = 'quiz-options';
                
                currentStep.options.forEach((option) => {
                    const optionButton = document.createElement('button');
                    optionButton.type = 'button';
                    optionButton.className = 'quiz-option';
                    optionButton.innerHTML = `
                        <div>
                            <strong>${option.label}</strong>
                            ${option.hint ? `<span>${option.hint}</span>` : ''}
                        </div>
                    `;
                    optionButton.addEventListener('click', () => {
                        answers[currentStep.id] = option.value;
                        stepIndex += 1;
                        if (stepIndex < quizSteps.length) {
                            renderStep();
                        } else {
                            renderResult();
                            quizCompleted = true;
                            // Синхронизируем результаты квиза с инструментом выбора моделей
                            syncQuizWithModelSelector();
                        }
                    });
                    optionsEl.appendChild(optionButton);
                });
                
                stepContainer.appendChild(optionsEl);
                quizRoot.appendChild(stepContainer);
            }
            
            function renderResult() {
                const quizResult = resolveQuizResult(answers);

                if (quizProgressEl) {
                    quizProgressEl.textContent = 'Ваши рекомендации готовы';
                }

                quizRoot.innerHTML = '';

                const resultContainer = document.createElement('div');
                resultContainer.className = 'quiz-result';

                // Заголовок
                const titleEl = document.createElement('h4');
                titleEl.textContent = quizResult.title;
                resultContainer.appendChild(titleEl);

                // Профиль проекта
                const profileEl = document.createElement('div');
                profileEl.className = 'quiz-profile';
                profileEl.innerHTML = `
                    <div class="quiz-profile-title">Ваш профиль проекта:</div>
                    <div class="quiz-profile-description">${quizResult.profile}</div>
                `;
                resultContainer.appendChild(profileEl);

                // Радар-чарт профиля
                const chartEl = document.createElement('div');
                chartEl.className = 'quiz-profile-chart';
                chartEl.id = 'quizProfileChart';
                resultContainer.appendChild(chartEl);

                // Рекомендации с процентами
                const recommendationsEl = document.createElement('div');
                recommendationsEl.className = 'quiz-recommendations';
                recommendationsEl.innerHTML = '<h5>Рекомендованные модели:</h5>';

                quizResult.models.forEach((model, index) => {
                    const modelEl = document.createElement('div');
                    modelEl.className = 'quiz-model-item';
                    modelEl.innerHTML = `
                        <div class="quiz-model-header">
                            <span class="quiz-model-number">${index + 1}</span>
                            <span class="quiz-model-name">${model.label}</span>
                            <span class="quiz-model-match">${model.matchPercent}%</span>
                        </div>
                        <div class="quiz-model-sources">
                            Рекомендовано: ${model.sources.join(', ')}
                        </div>
                    `;
                    recommendationsEl.appendChild(modelEl);
                });
                resultContainer.appendChild(recommendationsEl);

                // Действия
                const actionsEl = document.createElement('div');
                actionsEl.className = 'quiz-actions';

                // Экспорт профиля
                const exportButton = document.createElement('button');
                exportButton.type = 'button';
                exportButton.className = 'panel-button';
                exportButton.textContent = '📄 Экспорт профиля в PDF';
                exportButton.addEventListener('click', () => {
                    exportQuizProfileToPDF(quizResult);
                });
                actionsEl.appendChild(exportButton);

                // Переход к модели
                if (quizResult.jumpTargets.length) {
                    const jumpButton = document.createElement('button');
                    jumpButton.type = 'button';
                    jumpButton.className = 'panel-button';
                    jumpButton.textContent = 'Перейти к топ-модели';
                    jumpButton.addEventListener('click', () => {
                        toggleBookmarkPanel(false);
                        toggleNotesPanel(false);
                        jumpToSlide(quizResult.jumpTargets[0]);
                    });
                    actionsEl.appendChild(jumpButton);
                }

                // Перезапуск
                const restartButton = document.createElement('button');
                restartButton.type = 'button';
                restartButton.className = 'panel-button secondary';
                restartButton.textContent = 'Пройти квиз снова';
                restartButton.addEventListener('click', () => {
                    quizCompleted = false;
                    Object.keys(answers).forEach((key) => delete answers[key]);
                    stepIndex = 0;
                    renderStep();
                });
                actionsEl.appendChild(restartButton);

                resultContainer.appendChild(actionsEl);
                quizRoot.appendChild(resultContainer);

                // Рисуем радар-чарт после добавления в DOM
                setTimeout(() => renderQuizProfileChart(answers), 100);
            }
        }

        function renderQuizProfileChart(answers) {
            const chartContainer = document.getElementById('quizProfileChart');
            if (!chartContainer) return;

            // Преобразуем ответы в числовые значения для радара
            const radarValues = {
                scope: answers.scope === 'small' ? 20 : answers.scope === 'medium' ? 60 : 100,
                resistance: answers.resistance === 'low' ? 20 : answers.resistance === 'mixed' ? 60 : 100,
                pace: answers.pace === 'rapid' ? 20 : answers.pace === 'iterative' ? 60 : 100,
                culture: answers.culture === 'conservative' ? 20 : answers.culture === 'hybrid' ? 60 : 100,
                resources: answers.resources === 'limited' ? 20 : answers.resources === 'adequate' ? 60 : 100
            };

            // Координаты для 5-угольника
            const centerX = 150;
            const centerY = 150;
            const radius = 120;

            const angles = [0, 72, 144, 216, 288]; // Углы для 5 точек
            const labels = ['Масштаб', 'Сопротивление', 'Темп', 'Культура', 'Ресурсы'];

            let svg = `<svg width="300" height="300" viewBox="0 0 300 300">`;

            // Фоновая сетка (3 уровня)
            for (let level = 1; level <= 3; level++) {
                const r = (radius * level) / 3;
                let points = '';
                angles.forEach(angle => {
                    const x = centerX + r * Math.cos((angle - 90) * Math.PI / 180);
                    const y = centerY + r * Math.sin((angle - 90) * Math.PI / 180);
                    points += `${x},${y} `;
                });
                svg += `<polygon points="${points}" fill="none" stroke="#e0e0e0" stroke-width="1" opacity="0.5"/>`;
            }

            // Оси
            angles.forEach((angle, index) => {
                const x = centerX + radius * Math.cos((angle - 90) * Math.PI / 180);
                const y = centerY + radius * Math.sin((angle - 90) * Math.PI / 180);
                svg += `<line x1="${centerX}" y1="${centerY}" x2="${x}" y2="${y}" stroke="#ccc" stroke-width="1"/>`;

                // Метки
                const labelX = centerX + (radius + 20) * Math.cos((angle - 90) * Math.PI / 180);
                const labelY = centerY + (radius + 20) * Math.sin((angle - 90) * Math.PI / 180);
                const anchor = angle > 90 && angle < 270 ? 'end' : 'start';
                svg += `<text x="${labelX}" y="${labelY}" text-anchor="${anchor}" font-size="12" fill="#666">${labels[index]}</text>`;
            });

            // Данные пользователя
            let dataPoints = '';
            const values = Object.values(radarValues);
            angles.forEach((angle, index) => {
                const value = values[index] || 50;
                const r = (radius * value) / 100;
                const x = centerX + r * Math.cos((angle - 90) * Math.PI / 180);
                const y = centerY + r * Math.sin((angle - 90) * Math.PI / 180);
                dataPoints += `${x},${y} `;
            });

            svg += `<polygon points="${dataPoints}" fill="rgba(var(--color-teal-500-rgb), 0.3)" stroke="var(--color-primary)" stroke-width="3"/>`;

            // Точки на вершинах
            angles.forEach((angle, index) => {
                const value = values[index] || 50;
                const r = (radius * value) / 100;
                const x = centerX + r * Math.cos((angle - 90) * Math.PI / 180);
                const y = centerY + r * Math.sin((angle - 90) * Math.PI / 180);
                svg += `<circle cx="${x}" cy="${y}" r="5" fill="var(--color-primary)"/>`;
            });

            svg += `</svg>`;
            chartContainer.innerHTML = svg;
        }

        function exportQuizProfileToPDF(quizResult) {
            console.log('Экспорт профиля квиза в PDF...');

            const reportWindow = window.open('', '_blank');
            reportWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>Профиль проекта - ${new Date().toLocaleDateString('ru-RU')}</title>
                    <style>
                        body {
                            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                            line-height: 1.6;
                            padding: 40px;
                            max-width: 900px;
                            margin: 0 auto;
                        }
                        h1 { color: #2DB67D; border-bottom: 3px solid #2DB67D; padding-bottom: 10px; }
                        h2 { color: #333; margin-top: 30px; }
                        .profile { background: #f5f5f5; padding: 20px; border-radius: 8px; margin: 20px 0; }
                        .recommendations { margin: 20px 0; }
                        .model-item { background: white; padding: 15px; margin: 10px 0; border-radius: 6px; border-left: 4px solid #2DB67D; }
                        .match-percent { font-weight: bold; color: #2DB67D; font-size: 18px; }
                        .sources { color: #666; font-size: 14px; margin-top: 5px; }
                        .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; text-align: center; color: #666; }
                    </style>
                </head>
                <body>
                    <h1>Профиль проекта управления изменениями</h1>
                    <p><strong>Дата анализа:</strong> ${new Date().toLocaleDateString('ru-RU', { year: 'numeric', month: 'long', day: 'numeric' })}</p>

                    <div class="profile">
                        <h2>Ваш профиль проекта</h2>
                        <p><strong>${quizResult.profile}</strong></p>
                    </div>

                    <h2>Рекомендованные модели</h2>
                    <div class="recommendations">
                        ${quizResult.models.map((model, index) => `
                            <div class="model-item">
                                <h3>${index + 1}. ${model.label}</h3>
                                <div class="match-percent">Соответствие: ${model.matchPercent}%</div>
                                <div class="sources">Рекомендовано: ${model.sources.join(', ')}</div>
                            </div>
                        `).join('')}
                    </div>

                    <div class="footer">
                        <p>Автор: Dmitry Vladimirov | LinkedIn: www.linkedin.com/in/dmitry-vladimirov-cdto</p>
                        <p>Анализ создан с помощью интерактивного инструмента Prosci Change Triangle</p>
                    </div>
                </body>
                </html>
            `);
            reportWindow.document.close();

            setTimeout(() => {
                reportWindow.print();
            }, 500);
        }

        // ========== PCT Action Plan Generator ==========
        function generateActionPlan(pctResults) {
            const scores = {
                success: calculateCategoryScore('success'),
                leadership: calculateCategoryScore('leadership'),
                projectManagement: calculateCategoryScore('projectManagement'),
                changeManagement: calculateCategoryScore('changeManagement')
            };

            // Определяем приоритетные зоны (баллы < 20)
            const priorityAreas = [];
            if (scores.success < 20) priorityAreas.push('success');
            if (scores.leadership < 20) priorityAreas.push('leadership');
            if (scores.projectManagement < 20) priorityAreas.push('projectManagement');
            if (scores.changeManagement < 20) priorityAreas.push('changeManagement');

            // Если нет слабых зон, берем зону с минимальным баллом
            if (priorityAreas.length === 0) {
                const minScore = Math.min(...Object.values(scores));
                const minCategory = Object.keys(scores).find(key => scores[key] === minScore);
                priorityAreas.push(minCategory);
            }

            // Генерируем действия для каждой приоритетной зоны
            const actions = {};
            priorityAreas.forEach(area => {
                actions[area] = generateActionsForArea(area, scores[area]);
            });

            // Генерируем рекомендации по моделям
            const modelRecommendations = generateModelRecommendations(scores);

            return {
                scores,
                priorityAreas,
                actions,
                modelRecommendations,
                timeline: generateTimeline(actions),
                checklist: generateChecklist(actions)
            };
        }

        function generateActionsForArea(area, score) {
            const actionTemplates = {
                success: [
                    {
                        phase: 'Неделя 1-2',
                        title: 'Провести аудит целей и выгод',
                        description: 'Проанализировать бизнес-кейс проекта и четко сформулировать ожидаемые выгоды для всех стейкхолдеров',
                        type: 'analysis',
                        tools: ['Шаблон анализа выгод', 'Матрица стейкхолдеров']
                    },
                    {
                        phase: 'Неделя 3-4',
                        title: 'Установить метрики успеха',
                        description: 'Определить конкретные показатели для измерения достижения целей и выгод проекта',
                        type: 'planning',
                        tools: ['Шаблон метрик', 'Дашборд мониторинга']
                    },
                    {
                        phase: 'Неделя 5-6',
                        title: 'Назначить ответственных',
                        description: 'Четко распределить роли и ответственность за достижение целей между командой проекта',
                        type: 'governance',
                        tools: ['Матрица RACI', 'План коммуникаций']
                    }
                ],
                leadership: [
                    {
                        phase: 'Неделя 1-2',
                        title: 'Оценить текущий спонсорство',
                        description: 'Провести интервью с руководителями для оценки уровня поддержки и понимания целей проекта',
                        type: 'assessment',
                        tools: ['Опросник спонсорства', 'Карта влияния']
                    },
                    {
                        phase: 'Неделя 3-4',
                        title: 'Сформировать спонсорскую коалицию',
                        description: 'Определить ключевых спонсоров и разработать план их вовлечения в проект',
                        type: 'coalition',
                        tools: ['Шаблон коалиции', 'План коммуникаций']
                    },
                    {
                        phase: 'Неделя 5-6',
                        title: 'Организовать регулярные коммуникации',
                        description: 'Установить еженедельные встречи с спонсорами для обсуждения прогресса и решения проблем',
                        type: 'communication',
                        tools: ['Шаблон отчетности', 'Календарь встреч']
                    }
                ],
                projectManagement: [
                    {
                        phase: 'Неделя 1-2',
                        title: 'Определить объем проекта',
                        description: 'Четко документировать что входит и не входит в проект, кто будет затронут изменениями',
                        type: 'scope',
                        tools: ['Шаблон объема проекта', 'Карта заинтересованных сторон']
                    },
                    {
                        phase: 'Неделя 3-4',
                        title: 'Разработать план-график',
                        description: 'Создать детальный план с ключевыми вехами и зависимостями',
                        type: 'planning',
                        tools: ['Шаблон плана', 'Диаграмма Ганта']
                    },
                    {
                        phase: 'Неделя 5-6',
                        title: 'Организовать регулярные совещания',
                        description: 'Установить еженедельные встречи команды для отслеживания прогресса и решения проблем',
                        type: 'monitoring',
                        tools: ['Шаблон повестки', 'Система отслеживания рисков']
                    }
                ],
                changeManagement: [
                    {
                        phase: 'Неделя 1-2',
                        title: 'Провести оценку готовности',
                        description: 'Измерить текущий уровень компетенций команды и сопротивление изменениям',
                        type: 'assessment',
                        tools: ['Опросник готовности', 'Анализ сопротивления']
                    },
                    {
                        phase: 'Неделя 3-4',
                        title: 'Разработать стратегию коммуникаций',
                        description: 'Создать план информирования сотрудников о целях, прогрессе и поддержке изменений',
                        type: 'communication',
                        tools: ['Шаблон плана коммуникаций', 'Календарь мероприятий']
                    },
                    {
                        phase: 'Неделя 5-6',
                        title: 'Организовать обучение и поддержку',
                        description: 'Разработать программу обучения для затронутых сотрудников и систему поддержки',
                        type: 'training',
                        tools: ['План обучения', 'Система менторства']
                    }
                ]
            };

            return actionTemplates[area] || [];
        }

        function generateModelRecommendations(scores) {
            const recommendations = [];

            // Логика рекомендаций на основе баллов
            if (scores.success < 20) {
                recommendations.push({
                    model: 'ADKAR',
                    reason: 'Низкие баллы по успеху - нужна модель для управления индивидуальными переходами',
                    priority: 'high'
                });
            }

            if (scores.leadership < 20) {
                recommendations.push({
                    model: 'Модель Коттера',
                    reason: 'Слабое лидерство - необходима модель с акцентом на спонсорство и коалицию',
                    priority: 'high'
                });
            }

            if (scores.projectManagement < 20) {
                recommendations.push({
                    model: 'PDCA Цикл',
                    reason: 'Проблемы с управлением проектом - нужна итеративная модель',
                    priority: 'high'
                });
            }

            if (scores.changeManagement < 20) {
                recommendations.push({
                    model: 'Маур 3 уровня',
                    reason: 'Слабое управление изменениями - нужна модель для работы с сопротивлением',
                    priority: 'high'
                });
            }

            // Если все баллы хорошие, рекомендуем комплексную модель
            if (Object.values(scores).every(score => score >= 25)) {
                recommendations.push({
                    model: 'Гибридная модель',
                    reason: 'Все аспекты в хорошем состоянии - можно использовать комплексный подход',
                    priority: 'medium'
                });
            }

            return recommendations.slice(0, 3); // Максимум 3 рекомендации
        }

        function generateTimeline(actions) {
            const timeline = [];
            const phases = ['Неделя 1-2', 'Неделя 3-4', 'Неделя 5-6'];

            phases.forEach(phase => {
                const phaseActions = [];
                Object.values(actions).forEach(areaActions => {
                    const phaseAction = areaActions.find(action => action.phase === phase);
                    if (phaseAction) {
                        phaseActions.push(phaseAction);
                    }
                });

                if (phaseActions.length > 0) {
                    timeline.push({
                        phase,
                        actions: phaseActions
                    });
                }
            });

            return timeline;
        }

        function generateChecklist(actions) {
            const checklist = [];

            Object.values(actions).forEach(areaActions => {
                areaActions.forEach(action => {
                    checklist.push({
                        id: `${action.type}_${Date.now()}`,
                        title: action.title,
                        description: action.description,
                        phase: action.phase,
                        completed: false,
                        tools: action.tools
                    });
                });
            });

            return checklist;
        }

        function showActionPlanModal() {
            const pctResults = {
                // Получаем актуальные результаты PCT
            };

            const actionPlan = generateActionPlan(pctResults);

            const modal = document.createElement('div');
            modal.className = 'modal-overlay';
            modal.innerHTML = `
                <div class="modal-content action-plan-modal">
                    <div class="modal-header">
                        <h2>Персональный план действий</h2>
                        <button class="modal-close" onclick="this.closest('.modal-overlay').remove()">×</button>
                    </div>
                    <div class="modal-body">
                        ${generateActionPlanHTML(actionPlan)}
                    </div>
                    <div class="modal-footer">
                        <button class="panel-button secondary" onclick="this.closest('.modal-overlay').remove()">Закрыть</button>
                        <button class="panel-button" onclick="exportActionPlanToPDF(${JSON.stringify(actionPlan).replace(/"/g, '&quot;')})">📄 Скачать план (PDF)</button>
                    </div>
                </div>
            `;

            document.body.appendChild(modal);
        }

        function generateActionPlanHTML(plan) {
            return `
                <!-- Анализ текущего состояния -->
                <div class="action-plan-section">
                    <h3>📊 Анализ текущего состояния</h3>
                    <div class="scores-grid">
                        ${Object.entries(plan.scores).map(([area, score]) => `
                            <div class="score-item ${score < 20 ? 'critical' : score < 25 ? 'warning' : 'good'}">
                                <div class="score-label">${getAreaLabel(area)}</div>
                                <div class="score-value">${score}/30</div>
                                <div class="score-status">${getScoreStatus(score)}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <!-- Приоритетные действия -->
                <div class="action-plan-section">
                    <h3>🎯 Приоритетные действия на 30 дней</h3>
                    <div class="timeline">
                        ${plan.timeline.map(phase => `
                            <div class="timeline-phase">
                                <h4>${phase.phase}</h4>
                                <div class="phase-actions">
                                    ${phase.actions.map(action => `
                                        <div class="action-item">
                                            <h5>${action.title}</h5>
                                            <p>${action.description}</p>
                                            <div class="action-tools">
                                                <strong>Инструменты:</strong> ${action.tools.join(', ')}
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <!-- Рекомендованные модели -->
                <div class="action-plan-section">
                    <h3>📚 Рекомендованные модели для изучения</h3>
                    ${plan.modelRecommendations.map(rec => `
                        <div class="model-recommendation ${rec.priority}">
                            <div class="model-name">${rec.model}</div>
                            <div class="model-reason">${rec.reason}</div>
                        </div>
                    `).join('')}
                </div>

                <!-- Чек-лист -->
                <div class="action-plan-section">
                    <h3>✅ Чек-лист для отслеживания</h3>
                    <div class="checklist">
                        ${plan.checklist.map(item => `
                            <label class="checklist-item">
                                <input type="checkbox" onchange="updateChecklistItem('${item.id}', this.checked)">
                                <span class="checkmark"></span>
                                <div class="item-content">
                                    <div class="item-title">${item.title}</div>
                                    <div class="item-description">${item.description}</div>
                                    <div class="item-phase">${item.phase}</div>
                                </div>
                            </label>
                        `).join('')}
                    </div>
                </div>

                <!-- Напоминание о повторной оценке -->
                <div class="action-plan-section reminder">
                    <h3>🔄 Повторная оценка</h3>
                    <p>Через 30 дней рекомендуем пройти PCT оценку повторно, чтобы отследить прогресс и скорректировать план действий.</p>
                    <button class="panel-button" onclick="scheduleFollowUp()">📅 Напомнить через 30 дней</button>
                </div>
            `;
        }

        function getAreaLabel(area) {
            const labels = {
                success: 'Успех',
                leadership: 'Лидерство',
                projectManagement: 'Управление проектами',
                changeManagement: 'Управление изменениями'
            };
            return labels[area] || area;
        }

        function getScoreStatus(score) {
            if (score >= 25) return 'Сильная сторона';
            if (score >= 20) return 'Есть риски';
            return 'Требует внимания';
        }

        function updateChecklistItem(itemId, completed) {
            // Сохраняем состояние чек-листа в localStorage
            const checklistState = JSON.parse(localStorage.getItem('pct_checklist') || '{}');
            checklistState[itemId] = completed;
            localStorage.setItem('pct_checklist', JSON.stringify(checklistState));
        }

        function scheduleFollowUp() {
            // Создаем напоминание через 30 дней
            const followUpDate = new Date();
            followUpDate.setDate(followUpDate.getDate() + 30);

            // В реальном приложении здесь был бы код для создания напоминания
            // в календаре или отправки email
            alert(`Напоминание запланировано на ${followUpDate.toLocaleDateString('ru-RU')}`);
        }

        function exportActionPlanToPDF(plan) {
            console.log('Экспорт плана действий в PDF...');

            const reportWindow = window.open('', '_blank');
            reportWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>План действий - PCT ${new Date().toLocaleDateString('ru-RU')}</title>
                    <style>
                        body {
                            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                            line-height: 1.6;
                            padding: 40px;
                            max-width: 900px;
                            margin: 0 auto;
                        }
                        h1 { color: #2DB67D; border-bottom: 3px solid #2DB67D; padding-bottom: 10px; }
                        h2, h3 { color: #333; margin-top: 30px; }
                        .section { margin: 30px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
                        .scores-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin: 20px 0; }
                        .score-item { padding: 15px; border-radius: 6px; text-align: center; }
                        .score-item.critical { background: rgba(224, 30, 90, 0.1); border: 2px solid #E01E5A; }
                        .score-item.warning { background: rgba(244, 161, 0, 0.1); border: 2px solid #F4A100; }
                        .score-item.good { background: rgba(45, 182, 125, 0.1); border: 2px solid #2DB67D; }
                        .score-value { font-size: 24px; font-weight: bold; margin: 10px 0; }
                        .timeline-phase { margin: 20px 0; }
                        .action-item { background: #f9f9f9; padding: 15px; margin: 10px 0; border-radius: 6px; border-left: 4px solid #2DB67D; }
                        .model-recommendation { background: #f0f8f0; padding: 15px; margin: 10px 0; border-radius: 6px; border-left: 4px solid #2DB67D; }
                        .reminder { background: #fff3cd; border: 1px solid #f0c674; padding: 20px; border-radius: 8px; }
                        .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; text-align: center; color: #666; }
                    </style>
                </head>
                <body>
                    <h1>Персональный план действий</h1>
                    <p><strong>На основе оценки Prosci Change Triangle</strong></p>
                    <p><strong>Дата создания:</strong> ${new Date().toLocaleDateString('ru-RU', { year: 'numeric', month: 'long', day: 'numeric' })}</p>

                    <div class="section">
                        <h2>📊 Текущий анализ по категориям</h2>
                        <div class="scores-grid">
                            ${Object.entries(plan.scores).map(([area, score]) => `
                                <div class="score-item ${score < 20 ? 'critical' : score < 25 ? 'warning' : 'good'}">
                                    <div class="score-label">${getAreaLabel(area)}</div>
                                    <div class="score-value">${score}/30</div>
                                    <div class="score-status">${getScoreStatus(score)}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div class="section">
                        <h2>🎯 План действий на 30 дней</h2>
                        ${plan.timeline.map(phase => `
                            <h3>${phase.phase}</h3>
                            ${phase.actions.map(action => `
                                <div class="action-item">
                                    <h4>${action.title}</h4>
                                    <p>${action.description}</p>
                                    <p><strong>Инструменты:</strong> ${action.tools.join(', ')}</p>
                                </div>
                            `).join('')}
                        `).join('')}
                    </div>

                    <div class="section">
                        <h2>📚 Рекомендованные модели</h2>
                        ${plan.modelRecommendations.map(rec => `
                            <div class="model-recommendation">
                                <h4>${rec.model}</h4>
                                <p>${rec.reason}</p>
                            </div>
                        `).join('')}
                    </div>

                    <div class="section reminder">
                        <h2>🔄 Повторная оценка</h2>
                        <p>Через 30 дней рекомендуем пройти PCT оценку повторно, чтобы отследить прогресс и скорректировать план действий.</p>
                    </div>

                    <div class="footer">
                        <p>Автор: Dmitry Vladimirov | LinkedIn: www.linkedin.com/in/dmitry-vladimirov-cdto</p>
                        <p>План создан с помощью интерактивного инструмента Prosci Change Triangle</p>
                    </div>
                </body>
                </html>
            `);
            reportWindow.document.close();

            setTimeout(() => {
                reportWindow.print();
            }, 500);
        }

        // ========== ROI CALCULATOR ==========
        function calculateROI() {
            // Получаем значения из формы
            const budget = parseFloat(document.getElementById('projectBudget').value) || 0;
            const employees = parseInt(document.getElementById('employeeCount').value) || 0;
            const duration = parseInt(document.getElementById('projectDuration').value) || 0;
            const maturity = document.getElementById('maturityLevel').value;

            // Коэффициенты эффективности в зависимости от уровня зрелости
            const effectivenessFactors = {
                low: { reduction: 0.25, timeGain: 0.15, retentionGain: 0.05 },
                medium: { reduction: 0.40, timeGain: 0.25, retentionGain: 0.10 },
                high: { reduction: 0.55, timeGain: 0.35, retentionGain: 0.15 }
            };

            const factors = effectivenessFactors[maturity];

            // Расчёты
            const budgetInRubles = budget * 1000000; // Перевод в рубли

            // Потери без управления изменениями (63% бюджета)
            const lossesWithoutUI = budgetInRubles * 0.63;

            // Выгоды с управлением изменениями
            const riskReduction = budgetInRubles * factors.reduction; // Снижение рисков
            const timeSavings = budgetInRubles * factors.timeGain; // Экономия от сокращения сроков
            const retentionSavings = (employees * 50000) * factors.retentionGain; // Экономия от снижения текучести (средняя зарплата 50к/мес)

            const totalBenefits = riskReduction + timeSavings + retentionSavings;

            // Стоимость управления изменениями (5-15% бюджета в зависимости от зрелости)
            const uiCostPercent = maturity === 'high' ? 0.15 : maturity === 'medium' ? 0.10 : 0.05;
            const uiCost = budgetInRubles * uiCostPercent;

            // Чистая экономия
            const netSavings = totalBenefits - uiCost;

            // ROI через 2 года (учитывая накопительный эффект)
            const roi = uiCost > 0 ? ((netSavings * 2) / uiCost) * 100 : 0;

            // Процент сокращения сроков
            const timeReductionPercent = factors.timeGain * 100;

            return {
                budget: budgetInRubles,
                employees,
                duration,
                maturity,
                lossesWithoutUI,
                totalBenefits,
                uiCost,
                netSavings,
                roi: Math.round(roi),
                timeReduction: Math.round(timeReductionPercent),
                factors
            };
        }

        function renderROIResults(results) {
            // Отображаем результаты
            document.getElementById('roiValue').textContent = `${results.roi}%`;
            document.getElementById('savingsValue').textContent = formatCurrency(results.netSavings * 2);
            document.getElementById('timeReduction').textContent = `${results.timeReduction}%`;

            // Детальный анализ
            document.getElementById('lossesWithoutUI').textContent = formatCurrency(results.lossesWithoutUI);
            document.getElementById('benefitsWithUI').textContent = formatCurrency(results.totalBenefits);
            document.getElementById('uiCost').textContent = formatCurrency(results.uiCost);
            document.getElementById('netSavings').textContent = formatCurrency(results.netSavings);

            // Рекомендации
            const recommendationsEl = document.getElementById('roiRecommendations');
            let recommendationsHTML = '';

            if (results.roi > 200) {
                recommendationsHTML = `
                    <div class="roi-recommendation excellent">
                        <h5>🎉 Отличный результат!</h5>
                        <p>Внедрение управления изменениями принесёт значительную отдачу. Рекомендуем начать с пилотных проектов для демонстрации ценности.</p>
                    </div>
                `;
            } else if (results.roi > 100) {
                recommendationsHTML = `
                    <div class="roi-recommendation good">
                        <h5>👍 Хорошая инвестиция</h5>
                        <p>Управление изменениями окупится через 1-2 года. Фокус на ключевых рисках и вовлечённости персонала.</p>
                    </div>
                `;
            } else if (results.roi > 50) {
                recommendationsHTML = `
                    <div class="roi-recommendation moderate">
                        <h5>⚖️ Умеренная отдача</h5>
                        <p>ROI положительный, но требует оптимизации подходов. Начните с базовых практик и постепенно расширяйте.</p>
                    </div>
                `;
            } else {
                recommendationsHTML = `
                    <div class="roi-recommendation poor">
                        <h5>⚠️ Требует анализа</h5>
                        <p>Проверьте исходные данные и рассмотрите альтернативные подходы. Возможно, нужны более эффективные методы.</p>
                    </div>
                `;
            }

            recommendationsEl.innerHTML = recommendationsHTML;

            // Создаём диаграмму сравнения
            renderROIChart(results);

            // Показываем результаты
            document.getElementById('roiResults').style.display = 'block';
            document.getElementById('roiResults').scrollIntoView({ behavior: 'smooth' });
        }

        function renderROIChart(results) {
            const ctx = document.getElementById('roiChart').getContext('2d');

            // Данные для диаграммы
            const data = {
                labels: ['Без УИ', 'С УИ'],
                datasets: [{
                    label: 'Эффективность проекта',
                    data: [results.budget - results.lossesWithoutUI, results.budget + results.netSavings],
                    backgroundColor: [
                        'rgba(224, 30, 90, 0.8)',
                        'rgba(45, 182, 125, 0.8)'
                    ],
                    borderColor: [
                        '#E01E5A',
                        '#2DB67D'
                    ],
                    borderWidth: 2
                }]
            };

            const config = {
                type: 'bar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return formatCurrency(context.parsed.y);
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return formatCurrency(value, true);
                                }
                            }
                        }
                    }
                }
            };

            // Уничтожаем предыдущий график если существует
            if (window.roiChartInstance) {
                window.roiChartInstance.destroy();
            }

            window.roiChartInstance = new Chart(ctx, config);
        }

        function exportROIReportToPDF() {
            const results = calculateROI();

            const reportWindow = window.open('', '_blank');
            reportWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>ROI Отчёт - ${new Date().toLocaleDateString('ru-RU')}</title>
                    <style>
                        body {
                            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                            line-height: 1.6;
                            padding: 40px;
                            max-width: 900px;
                            margin: 0 auto;
                        }
                        h1 { color: #2DB67D; border-bottom: 3px solid #2DB67D; padding-bottom: 10px; }
                        h2, h3 { color: #333; margin-top: 30px; }
                        .section { margin: 30px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
                        .metrics { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin: 20px 0; }
                        .metric { text-align: center; padding: 20px; background: #f9f9f9; border-radius: 8px; }
                        .metric-value { font-size: 24px; font-weight: bold; color: #2DB67D; }
                        .metric-label { color: #666; font-size: 14px; }
                        .breakdown { margin: 20px 0; }
                        .breakdown-item { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #eee; }
                        .breakdown-label { font-weight: 500; }
                        .breakdown-value { font-weight: bold; color: #2DB67D; }
                        .recommendation { padding: 20px; border-radius: 8px; margin: 20px 0; }
                        .excellent { background: rgba(45, 182, 125, 0.1); border: 2px solid #2DB67D; }
                        .good { background: rgba(244, 161, 0, 0.1); border: 2px solid #F4A100; }
                        .moderate { background: rgba(255, 193, 7, 0.1); border: 2px solid #FFC107; }
                        .poor { background: rgba(224, 30, 90, 0.1); border: 2px solid #E01E5A; }
                        .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; text-align: center; color: #666; }
                    </style>
                </head>
                <body>
                    <h1>Отчёт ROI управления изменениями</h1>
                    <p><strong>Дата расчёта:</strong> ${new Date().toLocaleDateString('ru-RU', { year: 'numeric', month: 'long', day: 'numeric' })}</p>

                    <div class="section">
                        <h2>📊 Ключевые метрики</h2>
                        <div class="metrics">
                            <div class="metric">
                                <div class="metric-value">${results.roi}%</div>
                                <div class="metric-label">ROI через 2 года</div>
                            </div>
                            <div class="metric">
                                <div class="metric-value">${formatCurrency(results.netSavings * 2)}</div>
                                <div class="metric-label">Экономия за 2 года</div>
                            </div>
                            <div class="metric">
                                <div class="metric-value">${results.timeReduction}%</div>
                                <div class="metric-label">Сокращение сроков</div>
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <h2>💰 Детальный анализ</h2>
                        <div class="breakdown">
                            <div class="breakdown-item">
                                <span class="breakdown-label">Бюджет проекта:</span>
                                <span class="breakdown-value">${formatCurrency(results.budget)}</span>
                            </div>
                            <div class="breakdown-item">
                                <span class="breakdown-label">Потери без УИ:</span>
                                <span class="breakdown-value">${formatCurrency(results.lossesWithoutUI)}</span>
                            </div>
                            <div class="breakdown-item">
                                <span class="breakdown-label">Выгоды с УИ:</span>
                                <span class="breakdown-value">${formatCurrency(results.totalBenefits)}</span>
                            </div>
                            <div class="breakdown-item">
                                <span class="breakdown-label">Стоимость УИ:</span>
                                <span class="breakdown-value">${formatCurrency(results.uiCost)}</span>
                            </div>
                            <div class="breakdown-item">
                                <span class="breakdown-label">Чистая экономия:</span>
                                <span class="breakdown-value">${formatCurrency(results.netSavings)}</span>
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <h2>🎯 Рекомендации</h2>
                        <div class="recommendation ${results.roi > 200 ? 'excellent' : results.roi > 100 ? 'good' : results.roi > 50 ? 'moderate' : 'poor'}">
                            ${results.roi > 200 ?
                                '<h3>🎉 Отличный результат!</h3><p>Внедрение управления изменениями принесёт значительную отдачу. Рекомендуем начать с пилотных проектов для демонстрации ценности.</p>' :
                                results.roi > 100 ?
                                '<h3>👍 Хорошая инвестиция</h3><p>Управление изменениями окупится через 1-2 года. Фокус на ключевых рисках и вовлечённости персонала.</p>' :
                                results.roi > 50 ?
                                '<h3>⚖️ Умеренная отдача</h3><p>ROI положительный, но требует оптимизации подходов. Начните с базовых практик и постепенно расширяйте.</p>' :
                                '<h3>⚠️ Требует анализа</h3><p>Проверьте исходные данные и рассмотрите альтернативные подходы. Возможно, нужны более эффективные методы.</p>'
                            }
                        </div>
                    </div>

                    <div class="footer">
                        <p>Автор: Dmitry Vladimirov | LinkedIn: www.linkedin.com/in/dmitry-vladimirov-cdto</p>
                        <p>Расчёт выполнен с помощью интерактивного калькулятора ROI</p>
                    </div>
                </body>
                </html>
            `);
            reportWindow.document.close();

            setTimeout(() => {
                reportWindow.print();
            }, 500);
        }

        function resetROICalculator() {
            document.getElementById('roiResults').style.display = 'none';

            // Сбрасываем значения к дефолтным
            document.getElementById('projectBudget').value = '50';
            document.getElementById('employeeCount').value = '500';
            document.getElementById('projectDuration').value = '12';
            document.getElementById('maturityLevel').value = 'medium';

            // Уничтожаем график
            if (window.roiChartInstance) {
                window.roiChartInstance.destroy();
                window.roiChartInstance = null;
            }
        }

        function formatCurrency(amount, short = false) {
            if (short) {
                if (Math.abs(amount) >= 1000000000) {
                    return (amount / 1000000000).toFixed(1) + ' млрд ₽';
                } else if (Math.abs(amount) >= 1000000) {
                    return (amount / 1000000).toFixed(1) + ' млн ₽';
                } else if (Math.abs(amount) >= 1000) {
                    return (amount / 1000).toFixed(0) + ' тыс ₽';
                }
            }

            return new Intl.NumberFormat('ru-RU', {
                style: 'currency',
                currency: 'RUB',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        function initROICalculator() {
            const calculateBtn = document.getElementById('calculateROI');
            const exportBtn = document.getElementById('exportROIReport');

            if (calculateBtn) {
                calculateBtn.addEventListener('click', () => {
                    const results = calculateROI();
                    renderROIResults(results);
                });
            }

            if (exportBtn) {
                exportBtn.addEventListener('click', exportROIReportToPDF);
            }
        }

        // ========== READINESS ASSESSMENT ==========
        const readinessQuestions = [
            {
                id: 1,
                category: 'leadership',
                categoryName: 'Лидерство',
                question: 'Лидеры организации активно поддерживают изменения и демонстрируют приверженность.',
                weight: 1
            },
            {
                id: 2,
                category: 'leadership',
                categoryName: 'Лидерство',
                question: 'У нас есть спонсор изменений на высшем уровне руководства.',
                weight: 1
            },
            {
                id: 3,
                category: 'leadership',
                categoryName: 'Лидерство',
                question: 'Руководители понимают необходимость изменений и могут объяснить их сотрудникам.',
                weight: 1
            },
            {
                id: 4,
                category: 'culture',
                categoryName: 'Культура',
                question: 'Организационная культура поддерживает инновации и готовность к изменениям.',
                weight: 1
            },
            {
                id: 5,
                category: 'culture',
                categoryName: 'Культура',
                question: 'Сотрудники открыты к новым идеям и подходам.',
                weight: 1
            },
            {
                id: 6,
                category: 'culture',
                categoryName: 'Культура',
                question: 'В организации ценится обучение и развитие.',
                weight: 1
            },
            {
                id: 7,
                category: 'resources',
                categoryName: 'Ресурсы',
                question: 'У нас достаточно ресурсов (бюджет, время, персонал) для проведения изменений.',
                weight: 1
            },
            {
                id: 8,
                category: 'resources',
                categoryName: 'Ресурсы',
                question: 'Мы имеем необходимые навыки и компетенции для реализации изменений.',
                weight: 1
            },
            {
                id: 9,
                category: 'communication',
                categoryName: 'Коммуникация',
                question: 'Существуют эффективные каналы коммуникации между руководством и сотрудниками.',
                weight: 1
            },
            {
                id: 10,
                category: 'communication',
                categoryName: 'Коммуникация',
                question: 'Информация о целях и прогрессе изменений регулярно доводится до сотрудников.',
                weight: 1
            }
        ];

        let readinessCurrentQuestion = 0;
        let readinessAnswers = {};

        function initReadinessAssessment() {
            const questionsContainer = document.getElementById('readinessQuestions');
            const resultsContainer = document.getElementById('readinessResults');
            const exportBtn = document.getElementById('exportReadinessReport');

            if (!questionsContainer) return;

            // Скрываем результаты и показываем вопросы
            if (resultsContainer) resultsContainer.style.display = 'none';

            // Инициализируем состояние
            readinessCurrentQuestion = 0;
            readinessAnswers = {};

            // Рендерим первый вопрос
            renderReadinessQuestion();

            // Инициализируем кнопку экспорта
            if (exportBtn) {
                exportBtn.addEventListener('click', exportReadinessReportToPDF);
            }
        }

        function renderReadinessQuestion() {
            const questionsContainer = document.getElementById('readinessQuestions');
            const progressFill = document.getElementById('readinessProgressFill');
            const progressText = document.getElementById('readinessProgressText');

            if (!questionsContainer) return;

            const question = readinessQuestions[readinessCurrentQuestion];

            // Обновляем прогресс
            const progress = ((readinessCurrentQuestion + 1) / readinessQuestions.length) * 100;
            if (progressFill) progressFill.style.width = `${progress}%`;
            if (progressText) progressText.textContent = `Вопрос ${readinessCurrentQuestion + 1} из ${readinessQuestions.length}`;

            // Рендерим вопрос
            questionsContainer.innerHTML = `
                <div class="readiness-question">
                    <div class="readiness-category">${question.categoryName}</div>
                    <h4 class="readiness-question-text">${question.question}</h4>

                    <div class="readiness-scale">
                        <div class="readiness-scale-labels">
                            <span>1<br>Полностью не согласен</span>
                            <span>2</span>
                            <span>3<br>Затрудняюсь ответить</span>
                            <span>4</span>
                            <span>5<br>Полностью согласен</span>
                        </div>
                        <div class="readiness-scale-inputs">
                            ${[1, 2, 3, 4, 5].map(value => `
                                <label class="readiness-option">
                                    <input type="radio" name="readiness-q-${question.id}" value="${value}"
                                           onchange="selectReadinessAnswer(${question.id}, ${value})">
                                    <span class="readiness-radio">${value}</span>
                                </label>
                            `).join('')}
                        </div>
                    </div>

                    <div class="readiness-navigation">
                        ${readinessCurrentQuestion > 0 ? `<button class="panel-button secondary" onclick="prevReadinessQuestion()">← Назад</button>` : ''}
                        <div></div>
                        ${readinessCurrentQuestion < readinessQuestions.length - 1 ?
                            `<button class="panel-button" onclick="nextReadinessQuestion()" id="readinessNextBtn" disabled>Далее →</button>` :
                            `<button class="panel-button" onclick="showReadinessResults()" id="readinessFinishBtn" disabled>Показать результаты</button>`
                        }
                    </div>
                </div>
            `;
        }

        function selectReadinessAnswer(questionId, value) {
            readinessAnswers[questionId] = parseInt(value);

            // Включаем кнопку "Далее" или "Показать результаты"
            const nextBtn = document.getElementById('readinessNextBtn');
            const finishBtn = document.getElementById('readinessFinishBtn');

            if (nextBtn) nextBtn.disabled = false;
            if (finishBtn) finishBtn.disabled = false;
        }

        function nextReadinessQuestion() {
            readinessCurrentQuestion++;
            renderReadinessQuestion();
        }

        function prevReadinessQuestion() {
            readinessCurrentQuestion--;
            renderReadinessQuestion();
        }

        function showReadinessResults() {
            const results = assessReadiness(readinessAnswers);

            // Скрываем вопросы
            document.getElementById('readinessQuestions').style.display = 'none';

            // Показываем результаты
            const resultsContainer = document.getElementById('readinessResults');
            resultsContainer.style.display = 'block';

            renderReadinessResults(results);
        }

        // Делаем функцию глобально доступной
        window.showReadinessResults = showReadinessResults;

        function assessReadiness(answers) {
            // Группируем ответы по категориям
            const categoryScores = {
                leadership: [],
                culture: [],
                resources: [],
                communication: []
            };

            readinessQuestions.forEach(question => {
                const answer = answers[question.id];
                if (answer !== undefined) {
                    categoryScores[question.category].push(answer);
                }
            });

            // Считаем средние баллы по категориям
            const categoryAverages = {};
            let totalScore = 0;

            Object.keys(categoryScores).forEach(category => {
                const scores = categoryScores[category];
                if (scores.length > 0) {
                    categoryAverages[category] = scores.reduce((sum, score) => sum + score, 0) / scores.length;
                    totalScore += categoryAverages[category];
                } else {
                    categoryAverages[category] = 0;
                }
            });

            // Общий балл (максимум 50, по 5 баллов за категорию)
            const overallScore = totalScore;
            const maxScore = 5 * 4; // 4 категории по 5 баллов

            // Определяем уровень готовности
            let level, description;
            const percentage = (overallScore / maxScore) * 100;

            if (percentage >= 80) {
                level = 'Высокая готовность';
                description = 'Организация хорошо подготовлена к изменениям. Можно приступать к реализации с минимальными рисками.';
            } else if (percentage >= 60) {
                level = 'Средняя готовность';
                description = 'Есть хорошая основа, но требуются улучшения в отдельных областях перед запуском изменений.';
            } else if (percentage >= 40) {
                level = 'Низкая готовность';
                description = 'Необходимы значительные подготовительные работы перед запуском проекта изменений.';
            } else {
                level = 'Критически низкая готовность';
                description = 'Требуется фундаментальная подготовка организации к изменениям.';
            }

            // Генерируем рекомендации
            const recommendations = generateReadinessRecommendations(categoryAverages);

            return {
                overallScore: Math.round(overallScore * 10) / 10,
                maxScore,
                level,
                description,
                categoryScores: categoryAverages,
                percentage: Math.round(percentage),
                recommendations
            };
        }

        function generateReadinessRecommendations(categoryScores) {
            const recommendations = [];

            // Функция для определения уровня готовности
            function getReadinessLevel(score) {
                if (score >= 4) return 'good';
                if (score >= 3) return 'medium';
                if (score >= 2) return 'low';
                return 'critical';
            }

            // ЛИДЕРСТВО
            const leadershipLevel = getReadinessLevel(categoryScores.leadership);
            if (leadershipLevel !== 'good') {
                let rec = {
                    category: 'Лидерство',
                    score: categoryScores.leadership,
                    level: leadershipLevel
                };

                switch (leadershipLevel) {
                    case 'critical':
                        rec.title = 'Критическая нехватка лидерской поддержки';
                        rec.urgency = 'critical';
                        rec.complexity = 'hard';
                        rec.impact = 'high';
                        rec.timeframe = '1-2 недели';
                        rec.actions = [
                            'Срочно провести встречи с топ-менеджментом для получения поддержки',
                            'Назначить исполнительного спонсора изменений из высшего руководства',
                            'Разработать и представить бизнес-кейс изменений руководству',
                            'Создать коалицию поддержки из ключевых лидеров'
                        ];
                        break;
                    case 'low':
                        rec.title = 'Слабая вовлеченность руководства';
                        rec.urgency = 'high';
                        rec.complexity = 'medium';
                        rec.impact = 'high';
                        rec.timeframe = '2-4 недели';
                        rec.actions = [
                            'Организовать обучение руководителей по управлению изменениями',
                            'Создать рабочую группу по изменениям с участием лидеров',
                            'Регулярно информировать руководство о прогрессе',
                            'Назначить ответственных лиц за каждое направление изменений'
                        ];
                        break;
                    case 'medium':
                        rec.title = 'Частичная поддержка лидеров';
                        rec.urgency = 'medium';
                        rec.complexity = 'easy';
                        rec.impact = 'medium';
                        rec.timeframe = '1-2 месяца';
                        rec.actions = [
                            'Усилить видимость лидеров в коммуникациях об изменениях',
                            'Организовать регулярные встречи с сотрудниками для демонстрации поддержки',
                            'Разработать систему обратной связи от лидеров',
                            'Создать примеры успешных изменений под руководством лидеров'
                        ];
                        break;
                }
                recommendations.push(rec);
            }

            // КУЛЬТУРА
            const cultureLevel = getReadinessLevel(categoryScores.culture);
            if (cultureLevel !== 'good') {
                let rec = {
                    category: 'Культура',
                    score: categoryScores.culture,
                    level: cultureLevel
                };

                switch (cultureLevel) {
                    case 'critical':
                        rec.title = 'Сильное сопротивление изменениям';
                        rec.urgency = 'critical';
                        rec.complexity = 'hard';
                        rec.impact = 'high';
                        rec.timeframe = '1-3 месяца';
                        rec.actions = [
                            'Провести культурный аудит организации',
                            'Определить источники сопротивления и разработать план их преодоления',
                            'Создать программу работы с сопротивлением (коммуникация + вовлечение)',
                            'Организовать пилотные изменения в небольшой группе'
                        ];
                        break;
                    case 'low':
                        rec.title = 'Низкая адаптивность к изменениям';
                        rec.urgency = 'high';
                        rec.complexity = 'medium';
                        rec.impact = 'high';
                        rec.timeframe = '2-4 месяца';
                        rec.actions = [
                            'Запустить программу развития культуры изменений',
                            'Организовать обучение по преодолению сопротивления',
                            'Создать площадки для открытого обсуждения изменений',
                            'Внедрить практики непрерывного обучения и развития'
                        ];
                        break;
                    case 'medium':
                        rec.title = 'Умеренная открытость к изменениям';
                        rec.urgency = 'medium';
                        rec.complexity = 'medium';
                        rec.impact = 'medium';
                        rec.timeframe = '3-6 месяцев';
                        rec.actions = [
                            'Укрепить существующие позитивные практики культуры',
                            'Расширить вовлечение сотрудников в процесс изменений',
                            'Создать систему признания за участие в изменениях',
                            'Документировать и делиться уроками успешных изменений'
                        ];
                        break;
                }
                recommendations.push(rec);
            }

            // РЕСУРСЫ
            const resourcesLevel = getReadinessLevel(categoryScores.resources);
            if (resourcesLevel !== 'good') {
                let rec = {
                    category: 'Ресурсы',
                    score: categoryScores.resources,
                    level: resourcesLevel
                };

                switch (resourcesLevel) {
                    case 'critical':
                        rec.title = 'Критическая нехватка ресурсов';
                        rec.urgency = 'critical';
                        rec.complexity = 'hard';
                        rec.impact = 'high';
                        rec.timeframe = '1-2 недели';
                        rec.actions = [
                            'Срочно провести аудит всех доступных ресурсов',
                            'Приоритизировать изменения и выделить минимально необходимые ресурсы',
                            'Найти внешние источники финансирования или поддержки',
                            'Перераспределить ресурсы с менее приоритетных проектов'
                        ];
                        break;
                    case 'low':
                        rec.title = 'Недостаточные ресурсы для изменений';
                        rec.urgency = 'high';
                        rec.complexity = 'medium';
                        rec.impact = 'medium';
                        rec.timeframe = '2-4 недели';
                        rec.actions = [
                            'Разработать детальный план ресурсных потребностей',
                            'Найти внутренние резервы и возможности оптимизации',
                            'Подготовить бизнес-кейс для привлечения дополнительных ресурсов',
                            'Организовать обучение команды для повышения эффективности'
                        ];
                        break;
                    case 'medium':
                        rec.title = 'Достаточные ресурсы для базовых изменений';
                        rec.urgency = 'low';
                        rec.complexity = 'easy';
                        rec.impact = 'low';
                        rec.timeframe = '1-3 месяца';
                        rec.actions = [
                            'Оптимизировать использование существующих ресурсов',
                            'Создать систему мониторинга эффективности ресурсного использования',
                            'Разработать план поэтапного расширения ресурсной базы',
                            'Внедрить инструменты для повышения производительности'
                        ];
                        break;
                }
                recommendations.push(rec);
            }

            // КОММУНИКАЦИЯ
            const communicationLevel = getReadinessLevel(categoryScores.communication);
            if (communicationLevel !== 'good') {
                let rec = {
                    category: 'Коммуникация',
                    score: categoryScores.communication,
                    level: communicationLevel
                };

                switch (communicationLevel) {
                    case 'critical':
                        rec.title = 'Отсутствие системы коммуникаций';
                        rec.urgency = 'critical';
                        rec.complexity = 'medium';
                        rec.impact = 'high';
                        rec.timeframe = '1 неделя';
                        rec.actions = [
                            'Создать базовую систему коммуникаций (email, intranet, собрания)',
                            'Назначить ответственных за коммуникации на каждом уровне',
                            'Разработать ключевые сообщения об изменениях',
                            'Организовать первое информационное собрание для всех сотрудников'
                        ];
                        break;
                    case 'low':
                        rec.title = 'Слабые каналы коммуникации';
                        rec.urgency = 'high';
                        rec.complexity = 'easy';
                        rec.impact = 'medium';
                        rec.timeframe = '2-3 недели';
                        rec.actions = [
                            'Оценить эффективность существующих каналов коммуникации',
                            'Дополнить систему новыми каналами (чат, портал, рассылки)',
                            'Организовать регулярные информационные сессии',
                            'Создать обратную связь для вопросов и предложений'
                        ];
                        break;
                    case 'medium':
                        rec.title = 'Хорошая коммуникация, нужна двусторонность';
                        rec.urgency = 'medium';
                        rec.complexity = 'easy';
                        rec.impact = 'low';
                        rec.timeframe = '1-2 месяца';
                        rec.actions = [
                            'Внедрить систему регулярной обратной связи от сотрудников',
                            'Создать каналы для вопросов и предложений по изменениям',
                            'Организовать фокус-группы и опросы для оценки восприятия',
                            'Разработать план коммуникаций на весь период изменений'
                        ];
                        break;
                }
                recommendations.push(rec);
            }

            // Сортировка рекомендаций по приоритету срочности
            const urgencyOrder = { critical: 0, high: 1, medium: 2, low: 3 };
            recommendations.sort((a, b) => urgencyOrder[a.urgency] - urgencyOrder[b.urgency]);

            return recommendations;
        }

        function renderReadinessResults(results) {
            // Общий балл
            document.getElementById('readinessOverallScore').textContent = `${results.overallScore}/${results.maxScore}`;
            document.getElementById('readinessOverallLevel').textContent = results.level;
            document.getElementById('readinessOverallDescription').textContent = results.description;

            // Радар-чарт
            renderReadinessRadarChart(results.categoryScores);

            // Детальные результаты по категориям
            const categoriesContainer = document.getElementById('readinessCategories');
            categoriesContainer.innerHTML = Object.entries(results.categoryScores).map(([category, score]) => `
                <div class="readiness-category-result">
                    <div class="readiness-category-header">
                        <span class="readiness-category-name">${getReadinessCategoryName(category)}</span>
                        <span class="readiness-category-score">${score.toFixed(1)}/5</span>
                    </div>
                    <div class="readiness-category-bar">
                        <div class="readiness-category-fill" style="width: ${(score / 5) * 100}%"></div>
                    </div>
                </div>
            `).join('');

            // Рекомендации
            const recommendationsContainer = document.getElementById('readinessRecommendations');
            recommendationsContainer.innerHTML = results.recommendations.map(rec => `
                <div class="readiness-recommendation ${rec.urgency}">
                    <div class="readiness-recommendation-header">
                        <h5>${rec.title}</h5>
                        <div class="readiness-recommendation-meta">
                            <span class="readiness-urgency-badge ${rec.urgency}">${getUrgencyLabel(rec.urgency)}</span>
                            <span class="readiness-complexity-icon ${rec.complexity}" title="Сложность: ${getComplexityLabel(rec.complexity)}">${getComplexityIcon(rec.complexity)}</span>
                            <span class="readiness-impact-icon ${rec.impact}" title="Влияние: ${getImpactLabel(rec.impact)}">${getImpactIcon(rec.impact)}</span>
                            <span class="readiness-timeframe">${rec.timeframe}</span>
                        </div>
                    </div>
                    <div class="readiness-recommendation-content">
                        <p><strong>${rec.category}</strong> • Уровень: ${rec.score.toFixed(1)}/5</p>
                    </div>
                    <div class="readiness-recommendation-actions">
                        <h6>Рекомендуемые действия:</h6>
                        <ul>
                            ${rec.actions.map(action => `<li>${action}</li>`).join('')}
                        </ul>
                    </div>
                </div>
            `).join('');
        }

        // Вспомогательные функции для визуализации рекомендаций
        function getUrgencyLabel(urgency) {
            const labels = {
                critical: 'КРИТИЧНО',
                high: 'ВЫСОКИЙ',
                medium: 'СРЕДНИЙ',
                low: 'НИЗКИЙ'
            };
            return labels[urgency] || urgency;
        }

        function getComplexityLabel(complexity) {
            const labels = {
                easy: 'Легко',
                medium: 'Средне',
                hard: 'Сложно'
            };
            return labels[complexity] || complexity;
        }

        function getComplexityIcon(complexity) {
            const icons = {
                easy: '⚡',
                medium: '⚙️',
                hard: '🔧'
            };
            return icons[complexity] || '⚙️';
        }

        function getImpactLabel(impact) {
            const labels = {
                high: 'Высокое',
                medium: 'Среднее',
                low: 'Низкое'
            };
            return labels[impact] || impact;
        }

        function getImpactIcon(impact) {
            const icons = {
                high: '🎯',
                medium: '📊',
                low: '📌'
            };
            return icons[impact] || '📊';
        }

        function renderReadinessRadarChart(categoryScores) {
            const ctx = document.getElementById('readinessRadarChart').getContext('2d');

            const data = {
                labels: ['Лидерство', 'Культура', 'Ресурсы', 'Коммуникация'],
                datasets: [{
                    label: 'Уровень готовности',
                    data: [
                        categoryScores.leadership || 0,
                        categoryScores.culture || 0,
                        categoryScores.resources || 0,
                        categoryScores.communication || 0
                    ],
                    fill: true,
                    backgroundColor: 'rgba(45, 182, 125, 0.2)',
                    borderColor: 'rgba(45, 182, 125, 1)',
                    borderWidth: 2,
                    pointBackgroundColor: 'rgba(45, 182, 125, 1)',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: 'rgba(45, 182, 125, 1)'
                }]
            };

            const config = {
                type: 'radar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    elements: {
                        line: {
                            borderWidth: 2
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 5,
                            ticks: {
                                stepSize: 1
                            },
                            pointLabels: {
                                font: {
                                    size: 14
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            };

            // Уничтожаем предыдущий график если существует
            if (window.readinessRadarInstance) {
                window.readinessRadarInstance.destroy();
            }

            window.readinessRadarInstance = new Chart(ctx, config);
        }

        function getReadinessCategoryName(category) {
            const names = {
                leadership: 'Лидерство',
                culture: 'Культура',
                resources: 'Ресурсы',
                communication: 'Коммуникация'
            };
            return names[category] || category;
        }

        function exportReadinessReportToPDF() {
            const results = assessReadiness(readinessAnswers);

            const reportWindow = window.open('', '_blank');
            reportWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>Диагностика готовности - ${new Date().toLocaleDateString('ru-RU')}</title>
                    <style>
                        body {
                            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                            line-height: 1.6;
                            padding: 40px;
                            max-width: 900px;
                            margin: 0 auto;
                        }
                        h1 { color: #2DB67D; border-bottom: 3px solid #2DB67D; padding-bottom: 10px; }
                        h2, h3 { color: #333; margin-top: 30px; }
                        .section { margin: 30px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
                        .overall-score { text-align: center; background: #f9f9f9; padding: 30px; border-radius: 8px; margin: 20px 0; }
                        .score-number { font-size: 48px; font-weight: bold; color: #2DB67D; }
                        .score-level { font-size: 24px; font-weight: bold; margin: 10px 0; }
                        .categories { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; }
                        .category { padding: 15px; border: 1px solid #ddd; border-radius: 6px; }
                        .category-header { display: flex; justify-content: space-between; margin-bottom: 8px; }
                        .category-name { font-weight: bold; }
                        .category-score { color: #2DB67D; font-weight: bold; }
                        .recommendation { background: #f0f8f0; padding: 15px; margin: 10px 0; border-radius: 6px; border-left: 4px solid #2DB67D; }
                        .recommendation.high { background: rgba(224, 30, 90, 0.05); border-left-color: #E01E5A; }
                        .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; text-align: center; color: #666; }
                    </style>
                </head>
                <body>
                    <h1>Отчёт диагностики готовности к изменениям</h1>
                    <p><strong>Дата диагностики:</strong> ${new Date().toLocaleDateString('ru-RU', { year: 'numeric', month: 'long', day: 'numeric' })}</p>

                    <div class="section overall-score">
                        <div class="score-number">${results.overallScore}/${results.maxScore}</div>
                        <div class="score-level">${results.level}</div>
                        <div>${results.description}</div>
                    </div>

                    <div class="section">
                        <h2>Результаты по категориям</h2>
                        <div class="categories">
                            ${Object.entries(results.categoryScores).map(([category, score]) => `
                                <div class="category">
                                    <div class="category-header">
                                        <span class="category-name">${getReadinessCategoryName(category)}</span>
                                        <span class="category-score">${score.toFixed(1)}/5</span>
                                    </div>
                                    <div style="background: #eee; height: 8px; border-radius: 4px; overflow: hidden;">
                                        <div style="background: #2DB67D; height: 100%; width: ${(score / 5) * 100}%"></div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div class="section">
                        <h2>Рекомендации по улучшению</h2>
                        ${results.recommendations.map(rec => `
                            <div class="recommendation ${rec.priority}">
                                <h3>${rec.title} (${rec.category})</h3>
                                <ul>
                                    ${rec.actions.map(action => `<li>${action}</li>`).join('')}
                                </ul>
                            </div>
                        `).join('')}
                    </div>

                    <div class="footer">
                        <p>Автор: Dmitry Vladimirov | LinkedIn: www.linkedin.com/in/dmitry-vladimirov-cdto</p>
                        <p>Диагностика проведена с помощью интерактивного инструмента оценки готовности</p>
                    </div>
                </body>
                </html>
            `);
            reportWindow.document.close();

            setTimeout(() => {
                reportWindow.print();
            }, 500);
        }

        function resetReadinessAssessment() {
            readinessCurrentQuestion = 0;
            readinessAnswers = {};

            // Скрываем результаты
            document.getElementById('readinessResults').style.display = 'none';

            // Уничтожаем график
            if (window.readinessRadarInstance) {
                window.readinessRadarInstance.destroy();
                window.readinessRadarInstance = null;
            }

            // Показываем вопросы
            document.getElementById('readinessQuestions').style.display = 'block';

            // Запускаем заново
            initReadinessAssessment();
        }

        // ========== HYBRID MODEL CONSTRUCTOR ==========
        const hybridBaseModels = [
            {
                id: 'adkar',
                name: 'ADKAR',
                description: 'Фокус на индивидуальных переходах и готовности к изменениям',
                icon: '🎯',
                color: '#2DB67D',
                elements: ['Диагностика готовности', 'Создание видения', 'Обучение'],
                strengths: ['Простота реализации', 'Фокус на людях', 'Быстрые результаты'],
                weaknesses: ['Ограниченный охват', 'Мало внимания к системам']
            },
            {
                id: 'kotter',
                name: 'Модель Коттера',
                description: '8-шаговый процесс создания срочности и коалиции',
                icon: '👑',
                color: '#F4A100',
                elements: ['Создание коалиции', 'Стратегическое видение', 'Коммуникации'],
                strengths: ['Комплексный подход', 'Сильное лидерство', 'Организационные изменения'],
                weaknesses: ['Длительность', 'Сложность координации']
            },
            {
                id: 'satir',
                name: 'Модель Сатир',
                description: 'Работа с сопротивлением и эмоциональными аспектами',
                icon: '💝',
                color: '#E01E5A',
                elements: ['Работа с сопротивлением', 'Эмоциональная поддержка', 'Новый опыт'],
                strengths: ['Глубокая психологическая работа', 'Устранение сопротивления', 'Долгосрочные изменения'],
                weaknesses: ['Требует высокой квалификации', 'Длительность процесса']
            },
            {
                id: 'pdca',
                name: 'PDCA Цикл',
                description: 'Итеративный подход планирования и улучшения',
                icon: '🔄',
                color: '#4A90E2',
                elements: ['Планирование', 'Реализация', 'Проверка', 'Корректировка'],
                strengths: ['Быстрое получение результатов', 'Непрерывное улучшение', 'Адаптивность'],
                weaknesses: ['Требует дисциплины', 'Может быть хаотичным']
            },
            {
                id: 'acmp',
                name: 'ACMP Standard',
                description: 'Структурированный стандарт управления изменениями',
                icon: '📋',
                color: '#9B59B6',
                elements: ['Оценка воздействия', 'Стратегия коммуникаций', 'План обучения'],
                strengths: ['Комплексность', 'Профессионализм', 'Измеримость'],
                weaknesses: ['Сложность внедрения', 'Высокие требования к ресурсам']
            },
            {
                id: 'maur',
                name: 'Маур 3 уровня',
                description: 'Глубокая работа с сопротивлением на разных уровнях',
                icon: '🏔️',
                color: '#E74C3C',
                elements: ['Уровень 1: Я', 'Уровень 2: Мы', 'Уровень 3: Система'],
                strengths: ['Глубина анализа', 'Комплексное решение', 'Профилактика проблем'],
                weaknesses: ['Высокая сложность', 'Длительность', 'Требует экспертизы']
            }
        ];

        const hybridElements = [
            {
                id: 'vision',
                name: 'Создание общего видения',
                description: 'Разработка четкого образа будущего состояния',
                source: 'Коттер',
                category: 'planning'
            },
            {
                id: 'coalition',
                name: 'Формирование коалиции',
                description: 'Создание группы лидеров для поддержки изменений',
                source: 'Коттер',
                category: 'leadership'
            },
            {
                id: 'communication',
                name: 'Многоуровневая коммуникация',
                description: 'Комплексный план информирования заинтересованных сторон',
                source: 'ACMP',
                category: 'communication'
            },
            {
                id: 'training',
                name: 'Системное обучение',
                description: 'Программа подготовки для всех уровней организации',
                source: 'ACMP',
                category: 'training'
            },
            {
                id: 'resistance',
                name: 'Управление сопротивлением',
                description: 'Проактивная работа с барьерами и сомнениями',
                source: 'Сатир',
                category: 'change_management'
            },
            {
                id: 'emotional_support',
                name: 'Эмоциональная поддержка',
                description: 'Сопровождение через период неопределенности',
                source: 'Сатир',
                category: 'support'
            },
            {
                id: 'iteration',
                name: 'Итеративное внедрение',
                description: 'Пошаговое тестирование и корректировка подхода',
                source: 'PDCA',
                category: 'implementation'
            },
            {
                id: 'measurement',
                name: 'Измерение прогресса',
                description: 'Метрики и индикаторы успешности изменений',
                source: 'ADKAR',
                category: 'monitoring'
            },
            {
                id: 'system_analysis',
                name: 'Системный анализ',
                description: 'Понимание взаимосвязей и системных эффектов',
                source: 'Маур',
                category: 'analysis'
            },
            {
                id: 'culture_change',
                name: 'Изменение культуры',
                description: 'Работа с организационной культурой и ценностями',
                source: 'Маур',
                category: 'culture'
            },
            {
                id: 'stakeholder_engagement',
                name: 'Вовлечение стейкхолдеров',
                description: 'Активное участие ключевых заинтересованных сторон',
                source: 'Коттер',
                category: 'engagement'
            },
            {
                id: 'risk_management',
                name: 'Управление рисками',
                description: 'Идентификация и минимизация рисков изменений',
                source: 'ACMP',
                category: 'risk'
            }
        ];

        let hybridCurrentStep = 1;
        let hybridSelectedBase = null;
        let hybridSelectedElements = [];

        function initHybridConstructor() {
            const baseModelsContainer = document.getElementById('hybridBaseModels');
            const elementsContainer = document.getElementById('hybridElements');
            const exportBtn = document.getElementById('exportHybridModel');

            if (!baseModelsContainer) return;

            // Рендерим базовые модели
            renderHybridBaseModels();

            // Инициализируем кнопку экспорта
            if (exportBtn) {
                exportBtn.addEventListener('click', exportHybridModelToPDF);
            }

            // Сбрасываем состояние
            resetHybridState();
        }

        function renderHybridBaseModels() {
            const container = document.getElementById('hybridBaseModels');
            container.innerHTML = hybridBaseModels.map(model => `
                <div class="hybrid-base-model" onclick="selectHybridBase('${model.id}')">
                    <div class="hybrid-model-header">
                        <span class="hybrid-model-icon">${model.icon}</span>
                        <h4>${model.name}</h4>
                    </div>
                    <p class="hybrid-model-description">${model.description}</p>
                    <div class="hybrid-model-elements">
                        ${model.elements.map(element => `<span class="hybrid-element-tag">${element}</span>`).join('')}
                    </div>
                    <div class="hybrid-model-pros">
                        <strong>Сильные стороны:</strong> ${model.strengths.join(', ')}
                    </div>
                </div>
            `).join('');
        }

        function renderHybridElements() {
            const container = document.getElementById('hybridElements');
            const selectedBase = hybridBaseModels.find(m => m.id === hybridSelectedBase);

            container.innerHTML = `
                <div class="hybrid-selected-base">
                    <h4>Базовая модель: ${selectedBase.icon} ${selectedBase.name}</h4>
                    <p>${selectedBase.description}</p>
                </div>
                <div class="hybrid-elements-grid">
                    ${hybridElements.map(element => `
                        <label class="hybrid-element-option">
                            <input type="checkbox"
                                   onchange="toggleHybridElement('${element.id}')"
                                   ${hybridSelectedElements.includes(element.id) ? 'checked' : ''}>
                            <span class="hybrid-element-card">
                                <h5>${element.name}</h5>
                                <p>${element.description}</p>
                                <span class="hybrid-element-source">Из: ${element.source}</span>
                            </span>
                        </label>
                    `).join('')}
                </div>
            `;
        }

        function renderHybridPreview() {
            const container = document.getElementById('hybridPreview');
            const selectedBase = hybridBaseModels.find(m => m.id === hybridSelectedBase);
            const selectedElements = hybridElements.filter(e => hybridSelectedElements.includes(e.id));

            container.innerHTML = `
                <div class="hybrid-preview-header">
                    <h4>Ваша гибридная модель</h4>
                    <div class="hybrid-model-summary">
                        <div class="hybrid-summary-item">
                            <span class="hybrid-summary-label">Базовая модель:</span>
                            <span class="hybrid-summary-value">${selectedBase.icon} ${selectedBase.name}</span>
                        </div>
                        <div class="hybrid-summary-item">
                            <span class="hybrid-summary-label">Дополнительных элементов:</span>
                            <span class="hybrid-summary-value">${selectedElements.length}</span>
                        </div>
                    </div>
                </div>

                <div class="hybrid-model-visualization" id="hybridVisualization">
                    <!-- Визуализация будет создана функцией -->
                </div>

                <div class="hybrid-model-composition">
                    <h5>Состав модели:</h5>
                    <div class="hybrid-composition-base">
                        <strong>Базовые элементы (${selectedBase.name}):</strong>
                        <ul>
                            ${selectedBase.elements.map(element => `<li>${element}</li>`).join('')}
                        </ul>
                    </div>
                    ${selectedElements.length > 0 ? `
                        <div class="hybrid-composition-added">
                            <strong>Дополнительные элементы:</strong>
                            <ul>
                                ${selectedElements.map(element => `<li>${element.name} (${element.source})</li>`).join('')}
                            </ul>
                        </div>
                    ` : ''}
                </div>
            `;

            // Создаем визуализацию
            renderHybridVisualization(selectedBase, selectedElements);
        }

        function renderHybridVisualization(baseModel, elements) {
            const container = document.getElementById('hybridVisualization');

            // Создаем SVG диаграмму
            const svg = `
                <svg width="600" height="400" viewBox="0 0 600 400">
                    <!-- Центральный элемент - базовая модель -->
                    <circle cx="300" cy="200" r="80" fill="${baseModel.color}" opacity="0.8"/>
                    <text x="300" y="195" text-anchor="middle" fill="white" font-weight="bold" font-size="16">${baseModel.name}</text>
                    <text x="300" y="215" text-anchor="middle" fill="white" font-size="12">${baseModel.icon}</text>

                    <!-- Дополнительные элементы вокруг центра -->
                    ${elements.map((element, index) => {
                        const angle = (index * 360) / elements.length;
                        const radius = 150;
                        const x = 300 + radius * Math.cos((angle - 90) * Math.PI / 180);
                        const y = 200 + radius * Math.sin((angle - 90) * Math.PI / 180);

                        return `
                            <circle cx="${x}" cy="${y}" r="50" fill="#4A90E2" opacity="0.7"/>
                            <text x="${x}" y="${y-5}" text-anchor="middle" fill="white" font-size="10" font-weight="bold">${element.name.split(' ')[0]}</text>
                            <text x="${x}" y="${y+10}" text-anchor="middle" fill="white" font-size="12">${element.source}</text>
                        `;
                    }).join('')}

                    <!-- Линии связи -->
                    ${elements.map((element, index) => {
                        const angle = (index * 360) / elements.length;
                        const radius = 150;
                        const x = 300 + radius * Math.cos((angle - 90) * Math.PI / 180);
                        const y = 200 + radius * Math.sin((angle - 90) * Math.PI / 180);

                        return `<line x1="300" y1="200" x2="${x}" y2="${y}" stroke="#666" stroke-width="2" opacity="0.5"/>`;
                    }).join('')}
                </svg>
            `;

            container.innerHTML = svg;
        }

        function renderHybridPlan() {
            const container = document.getElementById('hybridPlan');
            const selectedBase = hybridBaseModels.find(m => m.id === hybridSelectedBase);
            const selectedElements = hybridElements.filter(e => hybridSelectedElements.includes(e.id));

            // Создаем план реализации
            const phases = [
                {
                    name: 'Подготовка (Неделя 1-2)',
                    activities: [
                        'Анализ текущего состояния',
                        'Определение целей гибридной модели',
                        'Оценка ресурсов и рисков'
                    ]
                },
                {
                    name: 'Проектирование (Неделя 3-4)',
                    activities: [
                        'Интеграция элементов базовой модели',
                        'Адаптация дополнительных элементов',
                        'Создание плана коммуникаций'
                    ]
                },
                {
                    name: 'Внедрение (Неделя 5-8)',
                    activities: [
                        'Пилотное тестирование',
                        'Обучение команды',
                        'Запуск основных процессов'
                    ]
                },
                {
                    name: 'Оптимизация (Неделя 9-12)',
                    activities: [
                        'Мониторинг результатов',
                        'Корректировка подхода',
                        'Масштабирование на всю организацию'
                    ]
                }
            ];

            container.innerHTML = `
                <h5>План реализации гибридной модели</h5>
                <div class="hybrid-plan-phases">
                    ${phases.map((phase, index) => `
                        <div class="hybrid-plan-phase">
                            <h6>${phase.name}</h6>
                            <ul>
                                ${phase.activities.map(activity => `<li>${activity}</li>`).join('')}
                            </ul>
                        </div>
                    `).join('')}
                </div>

                <div class="hybrid-plan-notes">
                    <h6>Важные замечания:</h6>
                    <ul>
                        <li>Регулярно оценивайте прогресс и корректируйте подход</li>
                        <li>Обеспечьте участие ключевых стейкхолдеров на всех этапах</li>
                        <li>Документируйте уроки и лучшие практики</li>
                        <li>Будьте готовы к итерациям и адаптации модели</li>
                    </ul>
                </div>
            `;
        }

        function selectHybridBase(baseId) {
            hybridSelectedBase = baseId;

            // Визуально выделяем выбранную модель
            document.querySelectorAll('.hybrid-base-model').forEach(model => {
                model.classList.remove('selected');
            });
            document.querySelector(`[onclick="selectHybridBase('${baseId}')"]`).classList.add('selected');
        }

        function toggleHybridElement(elementId) {
            if (hybridSelectedElements.includes(elementId)) {
                hybridSelectedElements = hybridSelectedElements.filter(id => id !== elementId);
            } else {
                hybridSelectedElements.push(elementId);
            }
        }

        function nextHybridStep() {
            if (hybridCurrentStep === 1) {
                if (!hybridSelectedBase) {
                    alert('Пожалуйста, выберите базовую модель');
                    return;
                }

                // Переходим к шагу 2
                document.getElementById('hybridStep1').style.display = 'none';
                document.getElementById('hybridStep2').style.display = 'block';
                document.getElementById('hybridPrevBtn').style.display = 'inline-block';

                renderHybridElements();
                hybridCurrentStep = 2;

            } else if (hybridCurrentStep === 2) {
                // Переходим к шагу 3
                document.getElementById('hybridStep2').style.display = 'none';
                document.getElementById('hybridStep3').style.display = 'block';
                document.getElementById('hybridNextBtn').style.display = 'none';

                renderHybridPreview();
                renderHybridPlan();
                hybridCurrentStep = 3;
            }
        }

        function prevHybridStep() {
            if (hybridCurrentStep === 2) {
                // Возвращаемся к шагу 1
                document.getElementById('hybridStep2').style.display = 'none';
                document.getElementById('hybridStep1').style.display = 'block';
                document.getElementById('hybridPrevBtn').style.display = 'none';

                hybridCurrentStep = 1;

            } else if (hybridCurrentStep === 3) {
                // Возвращаемся к шагу 2
                document.getElementById('hybridStep3').style.display = 'none';
                document.getElementById('hybridStep2').style.display = 'block';
                document.getElementById('hybridNextBtn').style.display = 'inline-block';

                hybridCurrentStep = 2;
            }
        }

        function resetHybridConstructor() {
            resetHybridState();
            initHybridConstructor();
        }

        function resetHybridState() {
            hybridCurrentStep = 1;
            hybridSelectedBase = null;
            hybridSelectedElements = [];

            // Скрываем все шаги кроме первого
            document.getElementById('hybridStep1').style.display = 'block';
            document.getElementById('hybridStep2').style.display = 'none';
            document.getElementById('hybridStep3').style.display = 'none';

            // Показываем/скрываем кнопки навигации
            document.getElementById('hybridPrevBtn').style.display = 'none';
            document.getElementById('hybridNextBtn').style.display = 'inline-block';
        }

        function exportHybridModelToPDF() {
            const selectedBase = hybridBaseModels.find(m => m.id === hybridSelectedBase);
            const selectedElements = hybridElements.filter(e => hybridSelectedElements.includes(e.id));

            const reportWindow = window.open('', '_blank');
            reportWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>Гибридная модель - ${new Date().toLocaleDateString('ru-RU')}</title>
                    <style>
                        body {
                            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                            line-height: 1.6;
                            padding: 40px;
                            max-width: 900px;
                            margin: 0 auto;
                        }
                        h1 { color: #2DB67D; border-bottom: 3px solid #2DB67D; padding-bottom: 10px; }
                        h2, h3 { color: #333; margin-top: 30px; }
                        .section { margin: 30px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
                        .model-summary { background: #f9f9f9; padding: 20px; border-radius: 8px; margin: 20px 0; }
                        .summary-item { display: flex; justify-content: space-between; margin: 10px 0; }
                        .elements-list { background: #f0f8f0; padding: 15px; border-radius: 6px; margin: 10px 0; }
                        .plan-phase { background: #fff3cd; padding: 15px; margin: 10px 0; border-radius: 6px; }
                        .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; text-align: center; color: #666; }
                    </style>
                </head>
                <body>
                    <h1>Гибридная модель управления изменениями</h1>
                    <p><strong>Дата создания:</strong> ${new Date().toLocaleDateString('ru-RU', { year: 'numeric', month: 'long', day: 'numeric' })}</p>

                    <div class="section model-summary">
                        <h2>Состав модели</h2>
                        <div class="summary-item">
                            <span><strong>Базовая модель:</strong></span>
                            <span>${selectedBase.icon} ${selectedBase.name}</span>
                        </div>
                        <div class="summary-item">
                            <span><strong>Дополнительных элементов:</strong></span>
                            <span>${selectedElements.length}</span>
                        </div>
                    </div>

                    <div class="section">
                        <h2>Базовые элементы</h2>
                        <div class="elements-list">
                            <ul>
                                ${selectedBase.elements.map(element => `<li>${element}</li>`).join('')}
                            </ul>
                        </div>
                    </div>

                    ${selectedElements.length > 0 ? `
                        <div class="section">
                            <h2>Дополнительные элементы</h2>
                            <div class="elements-list">
                                <ul>
                                    ${selectedElements.map(element => `<li><strong>${element.name}</strong> - ${element.description} (Источник: ${element.source})</li>`).join('')}
                                </ul>
                            </div>
                        </div>
                    ` : ''}

                    <div class="section">
                        <h2>План реализации</h2>
                        <div class="plan-phase">
                            <h3>Подготовка (Неделя 1-2)</h3>
                            <ul>
                                <li>Анализ текущего состояния</li>
                                <li>Определение целей гибридной модели</li>
                                <li>Оценка ресурсов и рисков</li>
                            </ul>
                        </div>

                        <div class="plan-phase">
                            <h3>Проектирование (Неделя 3-4)</h3>
                            <ul>
                                <li>Интеграция элементов базовой модели</li>
                                <li>Адаптация дополнительных элементов</li>
                                <li>Создание плана коммуникаций</li>
                            </ul>
                        </div>

                        <div class="plan-phase">
                            <h3>Внедрение (Неделя 5-8)</h3>
                            <ul>
                                <li>Пилотное тестирование</li>
                                <li>Обучение команды</li>
                                <li>Запуск основных процессов</li>
                            </ul>
                        </div>

                        <div class="plan-phase">
                            <h3>Оптимизация (Неделя 9-12)</h3>
                            <ul>
                                <li>Мониторинг результатов</li>
                                <li>Корректировка подхода</li>
                                <li>Масштабирование на всю организацию</li>
                            </ul>
                        </div>
                    </div>

                    <div class="footer">
                        <p>Автор: Dmitry Vladimirov | LinkedIn: www.linkedin.com/in/dmitry-vladimirov-cdto</p>
                        <p>Модель создана с помощью конструктора гибридных моделей</p>
                    </div>
                </body>
                </html>
            `);
            reportWindow.document.close();

            setTimeout(() => {
                reportWindow.print();
            }, 500);
        }

        function buildLearningPaths() {
            console.log('=== buildLearningPaths() вызвана ===');
            console.log('baseSlidesCount:', baseSlidesCount);
            console.log('fullSlidesCount:', fullSlidesCount);
            console.log('closingSlidesCount:', closingSlidesCount);
            
            try {
                const introSlides = Array.from({ length: baseSlidesCount }, (_, index) => index);
                const closingSlides = Array.from({ length: closingSlidesCount }, (_, index) => closingSlidesStartIndex + index);
                
                const quickKeywords = ['адкар', 'коттер', 'pdca', 'сатир', 'маур 3 уровня', 'гибридное управление'];
                const quickModels = quickKeywords
                    .map(findSlideIndexByKeyword)
                    .filter(index => index >= 0);
                // Найдем индексы слайдов инструментов
                const quizSlideIndex = slidesData.findIndex(slide =>
                    slide.title && slide.title.includes('Интерактивный квиз')
                );
                const roiSlideIndex = slidesData.findIndex(slide =>
                    slide.title && slide.title.includes('Калькулятор ROI')
                );
                const readinessSlideIndex = slidesData.findIndex(slide =>
                    slide.title && slide.title.includes('Диагностика готовности')
                );
                const constructorSlideIndex = slidesData.findIndex(slide =>
                    slide.title && slide.title.includes('Конструктор гибридной модели')
                );
                const pctSlideIndex = slidesData.findIndex(slide =>
                    slide.title && slide.title.includes('Prosci Change Triangle')
                );

                const quickSlidesSet = new Set([...introSlides, ...quickModels, ...closingSlides]);
                // Явно добавляем слайды инструментов в быстрый путь
                [quizSlideIndex, roiSlideIndex, readinessSlideIndex, constructorSlideIndex, pctSlideIndex]
                    .filter(index => index >= 0)
                    .forEach(index => quickSlidesSet.add(index));
                learningPaths.quick.slides = Array.from(quickSlidesSet).sort((a, b) => a - b);
                
                const standardClassicalCount = Math.min(18, classicalModels.length);
                const standardNewModelsCount = Math.min(6, newModels.length);
                const standardSlidesSet = new Set([
                    ...introSlides,
                    ...Array.from({ length: standardClassicalCount }, (_, index) => classicalStartIndex + index),
                    ...Array.from({ length: standardNewModelsCount }, (_, index) => newModelsStartIndex + index),
                    ...closingSlides
                ]);
                // Явно добавляем слайды инструментов в стандартный путь
                [quizSlideIndex, roiSlideIndex, readinessSlideIndex, constructorSlideIndex, pctSlideIndex]
                    .filter(index => index >= 0)
                    .forEach(index => standardSlidesSet.add(index));
                learningPaths.standard.slides = Array.from(standardSlidesSet).sort((a, b) => a - b);
                
                // Всегда устанавливаем expert путь как запасной вариант
                learningPaths.expert.slides = Array.from({ length: fullSlidesCount }, (_, index) => index);
                
                console.log('Построено путей обучения:');
                console.log('  quick:', learningPaths.quick.slides.length, 'слайдов');
                console.log('  standard:', learningPaths.standard.slides.length, 'слайдов');
                console.log('  expert:', learningPaths.expert.slides.length, 'слайдов');
                
                // Проверка: если какой-то путь остался пустым, копируем из expert
                if (learningPaths.quick.slides.length === 0) {
                    learningPaths.quick.slides = learningPaths.expert.slides.slice(0, 10);
                }
                if (learningPaths.standard.slides.length === 0) {
                    learningPaths.standard.slides = learningPaths.expert.slides.slice();
                }
            } catch (error) {
                console.error('Ошибка при построении путей обучения:', error);
                // Fallback: все пути получают все слайды
                const allSlides = Array.from({ length: fullSlidesCount }, (_, index) => index);
                learningPaths.quick.slides = allSlides;
                learningPaths.standard.slides = allSlides;
                learningPaths.expert.slides = allSlides;
            }
        }
        
        function updatePathSelectorOptions() {
            if (!pathSelectorEl) return;
            Array.from(pathSelectorEl.options).forEach((option) => {
                const path = learningPaths[option.value];
                if (path) {
                    option.textContent = `${path.label} (${path.slides.length})`;
                }
            });
            if (pathMetaEl) {
                const currentPath = learningPaths[activeLearningPath];
                pathMetaEl.textContent = `${currentPath.label} • ${currentPath.description}`;
            }
        }
        
        function initializeTheme() {
            if (!themeOrder.includes(currentTheme)) {
                currentTheme = 'auto';
            }
            applyTheme(currentTheme, { skipUpdateLabel: true });
            updateThemeToggleLabel();
        }
        
        function applyTheme(theme, options = {}) {
            document.body.classList.remove('theme-dark', 'theme-light');
            if (theme === 'dark') {
                document.body.classList.add('theme-dark');
            } else if (theme === 'light') {
                document.body.classList.add('theme-light');
            }
            currentTheme = theme;
            localStorage.setItem(THEME_STORAGE_KEY, theme);
            if (!options.skipUpdateLabel) {
                updateThemeToggleLabel();
            }
        }
        
        function cycleTheme() {
            const currentIndex = themeOrder.indexOf(currentTheme);
            const nextTheme = themeOrder[(currentIndex + 1) % themeOrder.length];
            applyTheme(nextTheme);
        }
        
        function updateThemeToggleLabel() {
            if (!themeToggleBtn) return;
            if (currentTheme === 'auto') {
                themeToggleBtn.textContent = '🌞 Тема';
                themeToggleBtn.title = 'Тема: системная. Нажмите для тёмной темы';
            } else if (currentTheme === 'dark') {
                themeToggleBtn.textContent = '🌚 Тема';
                themeToggleBtn.title = 'Тема: тёмная. Нажмите для светлой темы';
            } else {
                themeToggleBtn.textContent = '🌞 Тема';
                themeToggleBtn.title = 'Тема: светлая. Нажмите для системной темы';
            }
        }
        
        function renderTimeline() {
            const trackEl = document.getElementById('timelineTrack');
            if (!trackEl) return;
            trackEl.innerHTML = '';
            
            timelineData.forEach((item, index) => {
                const node = document.createElement('button');
                node.type = 'button';
                node.className = 'timeline-node';
                node.dataset.index = String(index);
                node.innerHTML = `
                    <span class="timeline-period">${item.period}</span>
                    <span class="timeline-headline">${item.headline}</span>
                `;
                node.addEventListener('click', () => updateTimelineDetails(index));
                trackEl.appendChild(node);
            });
            
            updateTimelineDetails(0);
        }
        
        function updateTimelineDetails(index) {
            const titleEl = document.getElementById('timelineTitle');
            const summaryEl = document.getElementById('timelineSummary');
            const highlightsEl = document.getElementById('timelineHighlights');
            if (!titleEl || !summaryEl || !highlightsEl) return;
            
            const data = timelineData[index] ?? timelineData[0];
            titleEl.textContent = `${data.period}: ${data.headline}`;
            summaryEl.textContent = data.summary;
            highlightsEl.innerHTML = '';
            data.highlights.forEach((point) => {
                const li = document.createElement('li');
                li.textContent = point;
                highlightsEl.appendChild(li);
            });
            
            const nodes = document.querySelectorAll('.timeline-node');
            nodes.forEach((node, nodeIndex) => {
                node.classList.toggle('active', nodeIndex === index);
            });
        }
        
        function renderBubbleLegend() {
            const legendEl = document.getElementById('bubbleChartLegend');
            if (!legendEl) return;
            legendEl.innerHTML = '';
            Object.entries(bubbleChartConfig.categories).forEach(([category, colors]) => {
                const item = document.createElement('div');
                item.className = 'chart-legend-item';
                item.innerHTML = `
                    <span class="chart-legend-swatch" style="background:${colors.backgroundColor}; border-color:${colors.borderColor};"></span>
                    ${category}
                `;
                legendEl.appendChild(item);
            });
        }
        
        function renderModelsBubbleChart() {
            const canvas = document.getElementById('modelsBubbleChart');
            if (!canvas || typeof Chart === 'undefined') return;
            if (modelsChartInstance) {
                modelsChartInstance.resize();
                return;
            }
            const ctx = canvas.getContext('2d');
            const datasets = Object.entries(bubbleChartConfig.categories).map(([category, colors]) => ({
                label: category,
                data: bubbleChartConfig.points
                    .filter(point => point.category === category)
                    .map(point => ({ x: point.x, y: point.y, r: point.r, label: point.label })),
                backgroundColor: colors.backgroundColor,
                borderColor: colors.borderColor,
                borderWidth: 1.5
            }));
            
            modelsChartInstance = new Chart(ctx, {
                type: 'bubble',
                data: { datasets },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: 'rgba(17, 24, 39, 0.85)',
                            padding: 12,
                            callbacks: {
                                label: (context) => {
                                    const { label, x, y } = context.raw;
                                    return `${label}: сложность ${x.toFixed(1)}, время ${y.toFixed(1)}`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: { display: true, text: 'Сложность внедрения' },
                            min: 0,
                            max: 10,
                            ticks: { stepSize: 1 }
                        },
                        y: {
                            title: { display: true, text: 'Время реализации' },
                            min: 0,
                            max: 10,
                            ticks: { stepSize: 1 }
                        }
                    }
                }
            });
            
            renderBubbleLegend();
        }
        
        function updateHistory(slideIndex) {
            const existingIndex = historyItems.indexOf(slideIndex);
            if (existingIndex !== -1) {
                historyItems.splice(existingIndex, 1);
            }
            historyItems.unshift(slideIndex);
            if (historyItems.length > HISTORY_LIMIT) {
                historyItems.pop();
            }
            renderHistoryPanel();
        }
        
        function renderHistoryPanel() {
            if (!historyListEl || !historyEmptyEl) return;
            historyListEl.innerHTML = '';
            if (!historyItems.length) {
                historyEmptyEl.style.display = 'block';
                return;
            }
            historyEmptyEl.style.display = 'none';
            historyItems.forEach((slideIndex) => {
                const li = document.createElement('li');
                li.className = 'history-item';
                if (slideIndex === currentSlide) {
                    li.classList.add('active');
                }
                li.dataset.slide = String(slideIndex);
                const title = slidesData[slideIndex]?.title ?? `Слайд ${slideIndex + 1}`;
                li.innerHTML = `<div><strong>${slideIndex + 1}</strong> <span>${title}</span></div>`;
                historyListEl.appendChild(li);
            });
        }
        
        function toggleHistoryPanel(forceState) {
            if (!historyPanelEl || !historyToggleBtn) return;
            const shouldOpen = typeof forceState === 'boolean'
                ? forceState
                : !historyPanelEl.classList.contains('active');
            if (shouldOpen) {
                toggleBookmarkPanel(false);
                toggleNotesPanel(false);
                historyPanelEl.classList.add('active');
                historyToggleBtn.classList.add('active');
            } else {
                historyPanelEl.classList.remove('active');
                historyToggleBtn.classList.remove('active');
            }
        }
        
        
        function stripHTML(html) {
            const temp = document.createElement('div');
            temp.innerHTML = html;
            return temp.textContent || temp.innerText || '';
        }
        
        // ========== PCT TOOL MANAGEMENT ==========
        const PCT_STORAGE_KEY = 'pct_assessment_scores';
        
        let pctState = {
            scores: {
                success: {},
                leadership: {},
                projectManagement: {},
                changeManagement: {}
            },
            currentCategory: 'success'
        };
        
        function loadPCTScores() {
            try {
                const saved = localStorage.getItem(PCT_STORAGE_KEY);
                if (saved) {
                    pctState.scores = JSON.parse(saved);
                }
            } catch (error) {
                console.warn('Не удалось загрузить оценки PCT:', error);
            }
        }
        
        function savePCTScores() {
            try {
                localStorage.setItem(PCT_STORAGE_KEY, JSON.stringify(pctState.scores));
            } catch (error) {
                console.warn('Не удалось сохранить оценки PCT:', error);
            }
        }
        
        function initPCT() {
            console.log('Инициализация PCT инструмента...');
            loadPCTScores();
            renderPCTCategory('success');
            setupPCTEventListeners();
            updatePCTResults();
        }
        
        function renderPCTCategory(categoryId) {
            const category = pctAssessment.categories[categoryId];
            const container = document.getElementById('pctContent');
            
            if (!container) {
                console.warn('PCT контейнер не найден');
                return;
            }
            
            let html = `
                <div class="pct-category">
                    <h3>${category.icon} ${category.label}</h3>
                    <p class="pct-category-desc">${category.description}</p>
                    <div class="pct-factors">
            `;
            
            category.factors.forEach(factor => {
                const savedScore = pctState.scores[categoryId][factor.id] || 0;
                html += `
                    <div class="pct-factor">
                        <div class="pct-factor-text">${factor.id}. ${factor.text}</div>
                        <div class="pct-rating">
                            <label>
                                <input type="radio" name="pct_${categoryId}_${factor.id}" value="1" 
                                       ${savedScore === 1 ? 'checked' : ''}
                                       onchange="handlePCTScore('${categoryId}', ${factor.id}, 1)">
                                <span>1 - Не применимо</span>
                            </label>
                            <label>
                                <input type="radio" name="pct_${categoryId}_${factor.id}" value="2"
                                       ${savedScore === 2 ? 'checked' : ''}
                                       onchange="handlePCTScore('${categoryId}', ${factor.id}, 2)">
                                <span>2 - Применимо</span>
                            </label>
                            <label>
                                <input type="radio" name="pct_${categoryId}_${factor.id}" value="3"
                                       ${savedScore === 3 ? 'checked' : ''}
                                       onchange="handlePCTScore('${categoryId}', ${factor.id}, 3)">
                                <span>3 - Превосходит ожидания</span>
                            </label>
                        </div>
                    </div>
                `;
            });
            
            html += `</div></div>`;
            container.innerHTML = html;
            pctState.currentCategory = categoryId;
        }
        
        function handlePCTScore(category, factorId, score) {
            pctState.scores[category][factorId] = score;
            savePCTScores();
            updatePCTProgress();
            updatePCTResults();
        }
        
        function calculateCategoryScore(categoryId) {
            const scores = pctState.scores[categoryId];
            return Object.values(scores).reduce((sum, val) => sum + val, 0);
        }
        
        function updatePCTProgress() {
            const totalFactors = 40;
            let completedFactors = 0;
            
            Object.values(pctState.scores).forEach(categoryScores => {
                completedFactors += Object.keys(categoryScores).length;
            });
            
            const progressPercent = (completedFactors / totalFactors) * 100;
            const progressFill = document.getElementById('pctProgressFill');
            const progressText = document.getElementById('pctProgressText');
            
            if (progressFill) {
                progressFill.style.width = `${progressPercent}%`;
            }
            if (progressText) {
                progressText.textContent = `Оценено: ${completedFactors} из ${totalFactors} факторов`;
            }
        }
        
        function updatePCTResults() {
            const categories = Object.keys(pctAssessment.categories);
            
            categories.forEach(catId => {
                const score = calculateCategoryScore(catId);
                const capitalizedId = catId.charAt(0).toUpperCase() + catId.slice(1);
                const scoreEl = document.getElementById(`pctScore${capitalizedId}`);
                
                if (scoreEl) {
                    const valueEl = scoreEl.querySelector('.pct-score-value');
                    if (valueEl) {
                        valueEl.textContent = `${score}/30`;
                    }
                    
                    // Цветовая индикация
                    scoreEl.className = 'pct-score-item';
                    if (score >= 25) scoreEl.classList.add('excellent');
                    else if (score >= 20) scoreEl.classList.add('moderate');
                    else if (score >= 10) scoreEl.classList.add('risk');
                }
            });
            
            renderPCTVisualization();
            generatePCTRecommendations();
        }
        
        function renderPCTVisualization() {
            const container = document.getElementById('pctVisualization');
            if (!container) return;
            
            const scores = {
                success: calculateCategoryScore('success'),
                leadership: calculateCategoryScore('leadership'),
                projectManagement: calculateCategoryScore('projectManagement'),
                changeManagement: calculateCategoryScore('changeManagement')
            };
            
            // Нормализация для радара (макс 30, конвертируем в радиус от 0 до 150)
            const normalize = (score) => (score / 30) * 150;
            
            const centerX = 200;
            const centerY = 200;
            
            // Координаты для четырех направлений (север, восток, юг, запад)
            const successY = centerY - normalize(scores.success);
            const leadershipX = centerX + normalize(scores.leadership);
            const projectManagementY = centerY + normalize(scores.projectManagement);
            const changeManagementX = centerX - normalize(scores.changeManagement);
            
            const svg = `
                <svg width="400" height="400" viewBox="0 0 400 400">
                    <!-- Фон и сетка -->
                    <circle cx="200" cy="200" r="150" fill="none" stroke="#e0e0e0" stroke-width="1"/>
                    <circle cx="200" cy="200" r="100" fill="none" stroke="#e0e0e0" stroke-width="1"/>
                    <circle cx="200" cy="200" r="50" fill="none" stroke="#e0e0e0" stroke-width="1"/>
                    
                    <!-- Оси для каждой категории -->
                    <line x1="200" y1="200" x2="200" y2="50" stroke="#999" stroke-width="2"/>
                    <text x="200" y="40" text-anchor="middle" font-size="14" fill="#333">Успех</text>
                    
                    <line x1="200" y1="200" x2="350" y2="200" stroke="#999" stroke-width="2"/>
                    <text x="360" y="205" text-anchor="start" font-size="14" fill="#333">Лидерство</text>
                    
                    <line x1="200" y1="200" x2="200" y2="350" stroke="#999" stroke-width="2"/>
                    <text x="200" y="370" text-anchor="middle" font-size="14" fill="#333">Проекты</text>
                    
                    <line x1="200" y1="200" x2="50" y2="200" stroke="#999" stroke-width="2"/>
                    <text x="35" y="205" text-anchor="end" font-size="14" fill="#333">Изменения</text>
                    
                    <!-- Данные пользователя (ромб) -->
                    <polygon 
                        points="${200},${successY} ${leadershipX},${200} ${200},${projectManagementY} ${changeManagementX},${200}"
                        fill="rgba(var(--color-teal-500-rgb), 0.3)"
                        stroke="var(--color-primary)"
                        stroke-width="3"/>
                    
                    <!-- Точки на вершинах -->
                    <circle cx="200" cy="${successY}" r="5" fill="var(--color-primary)"/>
                    <circle cx="${leadershipX}" cy="200" r="5" fill="var(--color-primary)"/>
                    <circle cx="200" cy="${projectManagementY}" r="5" fill="var(--color-primary)"/>
                    <circle cx="${changeManagementX}" cy="200" r="5" fill="var(--color-primary)"/>
                </svg>
            `;
            
            container.innerHTML = svg;
        }
        
        function generatePCTRecommendations() {
            const container = document.getElementById('pctRecommendations');
            if (!container) return;
            
            const scores = {
                success: calculateCategoryScore('success'),
                leadership: calculateCategoryScore('leadership'),
                projectManagement: calculateCategoryScore('projectManagement'),
                changeManagement: calculateCategoryScore('changeManagement')
            };
            
            const recommendations = [];
            const categoryNames = {
                success: 'Успех',
                leadership: 'Лидерство/Спонсорство',
                projectManagement: 'Управление проектами',
                changeManagement: 'Управление изменениями'
            };
            
            Object.keys(scores).forEach(key => {
                const score = scores[key];
                const name = categoryNames[key];
                
                if (score >= 25) {
                    recommendations.push(`<strong>${name}</strong>: Сильная сторона (${score}/30) — продолжайте поддерживать и использовать.`);
                } else if (score >= 20) {
                    recommendations.push(`<strong>${name}</strong>: Есть риски (${score}/30) — необходим дополнительный анализ.`);
                } else if (score >= 10) {
                    recommendations.push(`<strong>${name}</strong>: Высокий риск (${score}/30) — требуются немедленные меры.`);
                } else if (score > 0) {
                    recommendations.push(`<strong>${name}</strong>: Критический уровень (${score}/30) — срочно требуется вмешательство.`);
                }
            });
            
            if (recommendations.length === 0) {
                container.innerHTML = '<p>Начните оценку факторов, чтобы получить рекомендации.</p>';
            } else {
                container.innerHTML = `
                    <h4>Рекомендации на основе оценки:</h4>
                    <ul>
                        ${recommendations.map(rec => `<li>${rec}</li>`).join('')}
                    </ul>
                `;
            }
        }
        
        function setupPCTEventListeners() {
            // Табы для переключения категорий
            const tabs = document.querySelectorAll('.pct-tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const category = this.getAttribute('data-category');
                    
                    // Обновить активную кнопку
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Рендерить новую категорию
                    renderPCTCategory(category);
                });
            });
            
            // Кнопка сброса
            const resetBtn = document.getElementById('pctReset');
            if (resetBtn) {
                resetBtn.addEventListener('click', function() {
                    if (confirm('Вы уверены, что хотите сбросить все оценки? Это действие нельзя отменить.')) {
                        pctState.scores = {
                            success: {},
                            leadership: {},
                            projectManagement: {},
                            changeManagement: {}
                        };
                        savePCTScores();
                        renderPCTCategory(pctState.currentCategory);
                        updatePCTProgress();
                        updatePCTResults();
                    }
                });
            }
            
            // Кнопка плана действий
            const actionPlanBtn = document.getElementById('pctActionPlan');
            if (actionPlanBtn) {
                actionPlanBtn.addEventListener('click', function() {
                    // Проверяем, что оценка завершена
                    const totalFactors = 40;
                    const completedFactors = Object.values(pctState.scores).reduce((total, category) =>
                        total + Object.keys(category).length, 0);

                    if (completedFactors < totalFactors) {
                        alert(`Для генерации плана действий необходимо оценить все ${totalFactors} факторов. Сейчас оценено: ${completedFactors}`);
                        return;
                    }

                    showActionPlanModal();
                });
            }

            // Кнопка экспорта в PDF
            const exportBtn = document.getElementById('pctExportPdf');
            if (exportBtn) {
                exportBtn.addEventListener('click', exportPCTToPDF);
            }
        }
        
        function exportPCTToPDF() {
            console.log('Экспорт PCT в PDF...');
            
            // Создаем отчетную страницу
            const scores = {
                success: calculateCategoryScore('success'),
                leadership: calculateCategoryScore('leadership'),
                projectManagement: calculateCategoryScore('projectManagement'),
                changeManagement: calculateCategoryScore('changeManagement')
            };
            
            const reportWindow = window.open('', '_blank');
            reportWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>Отчёт PCT - ${new Date().toLocaleDateString('ru-RU')}</title>
                    <style>
                        body {
                            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
                            line-height: 1.6;
                            padding: 40px;
                            max-width: 900px;
                            margin: 0 auto;
                        }
                        h1 { color: #2DB67D; border-bottom: 3px solid #2DB67D; padding-bottom: 10px; }
                        h2 { color: #333; margin-top: 30px; }
                        .meta { color: #666; margin-bottom: 30px; }
                        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                        th, td { padding: 12px; text-align: left; border: 1px solid #ddd; }
                        th { background: #f5f5f5; font-weight: 600; }
                        .excellent { background: rgba(45, 182, 125, 0.1); }
                        .moderate { background: rgba(244, 161, 0, 0.1); }
                        .risk { background: rgba(224, 30, 90, 0.1); }
                        .recommendations { background: #f9f9f9; padding: 20px; border-left: 4px solid #2DB67D; margin: 20px 0; }
                        .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; text-align: center; color: #666; }
                    </style>
                </head>
                <body>
                    <h1>Отчёт оценки Prosci Change Triangle (PCT)</h1>
                    <div class="meta">
                        <p><strong>Дата оценки:</strong> ${new Date().toLocaleDateString('ru-RU', { year: 'numeric', month: 'long', day: 'numeric' })}</p>
                        <p><strong>Время:</strong> ${new Date().toLocaleTimeString('ru-RU')}</p>
                    </div>
                    
                    <h2>Результаты по категориям</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Категория</th>
                                <th>Баллы</th>
                                <th>Максимум</th>
                                <th>Оценка</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="${scores.success >= 25 ? 'excellent' : scores.success >= 20 ? 'moderate' : 'risk'}">
                                <td>🎯 Успех</td>
                                <td>${scores.success}</td>
                                <td>30</td>
                                <td>${scores.success >= 25 ? 'Сильная сторона' : scores.success >= 20 ? 'Есть риски' : 'Высокий риск'}</td>
                            </tr>
                            <tr class="${scores.leadership >= 25 ? 'excellent' : scores.leadership >= 20 ? 'moderate' : 'risk'}">
                                <td>👑 Лидерство/Спонсорство</td>
                                <td>${scores.leadership}</td>
                                <td>30</td>
                                <td>${scores.leadership >= 25 ? 'Сильная сторона' : scores.leadership >= 20 ? 'Есть риски' : 'Высокий риск'}</td>
                            </tr>
                            <tr class="${scores.projectManagement >= 25 ? 'excellent' : scores.projectManagement >= 20 ? 'moderate' : 'risk'}">
                                <td>📊 Управление проектами</td>
                                <td>${scores.projectManagement}</td>
                                <td>30</td>
                                <td>${scores.projectManagement >= 25 ? 'Сильная сторона' : scores.projectManagement >= 20 ? 'Есть риски' : 'Высокий риск'}</td>
                            </tr>
                            <tr class="${scores.changeManagement >= 25 ? 'excellent' : scores.changeManagement >= 20 ? 'moderate' : 'risk'}">
                                <td>🔄 Управление изменениями</td>
                                <td>${scores.changeManagement}</td>
                                <td>30</td>
                                <td>${scores.changeManagement >= 25 ? 'Сильная сторона' : scores.changeManagement >= 20 ? 'Есть риски' : 'Высокий риск'}</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="recommendations">
                        <h2>Рекомендации</h2>
                        ${document.getElementById('pctRecommendations').innerHTML}
                    </div>
                    
                    <div class="footer">
                        <p>Автор: Dmitry Vladimirov | LinkedIn: www.linkedin.com/in/dmitry-vladimirov-cdto</p>
                        <p>Треугольник изменений Prosci (PCT) © Prosci</p>
                    </div>
                </body>
                </html>
            `);
            reportWindow.document.close();
            
            // Даем время для загрузки стилей, затем печатаем
            setTimeout(() => {
                reportWindow.print();
            }, 500);
        }
        
        function buildSearchIndex() {
            searchIndex.length = 0;
            slidesData.forEach((slide, index) => {
                const title = slide.title || '';
                const subtitle = slide.subtitle || '';
                const contentText = stripHTML(slide.content || '');
                searchIndex.push({
                    index,
                title,
                    subtitle,
                    content: contentText,
                    titleLower: title.toLowerCase(),
                    subtitleLower: subtitle.toLowerCase(),
                    contentLower: contentText.toLowerCase()
                });
            });
        }
        
        function handleSearchInput(event) {
            const query = (event.target.value || '').trim().toLowerCase();
            if (!query) {
                searchResults = [];
                searchTerms = [];
                currentSearchTerm = '';
                activeSearchResultIndex = -1;
                renderSearchResults();
                clearSearchHighlight();
                return;
            }
            
            searchTerms = query.split(/\s+/).filter(Boolean);
            currentSearchTerm = query;
            const results = [];
            
            searchIndex.forEach((entry) => {
                let score = 0;
                searchTerms.forEach((term) => {
                    if (entry.titleLower.includes(term)) score += 6;
                    if (entry.subtitleLower.includes(term)) score += 4;
                    if (entry.contentLower.includes(term)) score += 1;
                });
                if (score > 0) {
                    results.push({
                        index: entry.index,
                        title: entry.title,
                        snippet: createSnippet(entry.content, searchTerms),
                        score
                    });
                }
            });
            
            results.sort((a, b) => b.score - a.score);
            searchResults = results.slice(0, 8);
            activeSearchResultIndex = searchResults.length ? 0 : -1;
            renderSearchResults();
        }
        
        function renderSearchResults() {
            if (!searchResultsEl) return;
            searchResultsEl.innerHTML = '';
            
            if (!searchResults.length) {
                searchResultsEl.classList.remove('active');
                return;
            }
            
            searchResultsEl.classList.add('active');
            searchResults.forEach((result, index) => {
                const item = document.createElement('li');
                item.className = 'search-result-item';
                item.dataset.slide = String(result.index);
                if (index === activeSearchResultIndex) {
                    item.classList.add('active');
                }
                item.innerHTML = `<strong>${result.index + 1}. ${result.title}</strong><span>${result.snippet}</span>`;
                item.addEventListener('mousedown', (event) => {
                    event.preventDefault();
                    selectSearchResult(index);
                });
                searchResultsEl.appendChild(item);
            });
        }
        
        function closeSearchResults() {
            if (!searchResultsEl) return;
            searchResultsEl.classList.remove('active');
            searchResultsEl.innerHTML = '';
            activeSearchResultIndex = -1;
        }
        
        function selectSearchResult(index) {
            if (index < 0 || index >= searchResults.length) return;
            const result = searchResults[index];
            const query = searchInputEl ? searchInputEl.value.trim() : '';
            if (query) {
                currentSearchTerm = query.toLowerCase();
                searchTerms = currentSearchTerm.split(/\s+/).filter(Boolean);
            } else {
                currentSearchTerm = result.title.toLowerCase();
                searchTerms = currentSearchTerm.split(/\s+/).filter(Boolean);
                if (searchInputEl) {
                    searchInputEl.value = result.title;
                }
            }
            closeSearchResults();
            if (searchInputEl) {
                searchInputEl.blur();
            }
            jumpToSlide(result.index);
        }
        
        function handleSearchKeyDown(event) {
            if (event.key === 'ArrowDown') {
                event.preventDefault();
                if (!searchResults.length) return;
                activeSearchResultIndex = (activeSearchResultIndex + 1) % searchResults.length;
                renderSearchResults();
            } else if (event.key === 'ArrowUp') {
                event.preventDefault();
                if (!searchResults.length) return;
                activeSearchResultIndex = (activeSearchResultIndex - 1 + searchResults.length) % searchResults.length;
                renderSearchResults();
            } else if (event.key === 'Enter') {
                if (activeSearchResultIndex >= 0) {
                    event.preventDefault();
                    selectSearchResult(activeSearchResultIndex);
                }
            } else if (event.key === 'Escape') {
                event.preventDefault();
                clearSearch();
                if (searchInputEl) {
                    searchInputEl.blur();
                }
            }
        }
        
        function clearSearch() {
            if (searchInputEl) {
                searchInputEl.value = '';
            }
            searchResults = [];
            searchTerms = [];
            currentSearchTerm = '';
            activeSearchResultIndex = -1;
            closeSearchResults();
            clearSearchHighlight();
        }
        
        function escapeRegExp(string) {
            return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        }
        
        function createSnippet(text, terms) {
            const lowerText = text.toLowerCase();
            let firstMatchIndex = -1;
            let matchedTerm = '';
            for (const term of terms) {
                const index = lowerText.indexOf(term);
                if (index !== -1) {
                    if (firstMatchIndex === -1 || index < firstMatchIndex) {
                        firstMatchIndex = index;
                        matchedTerm = term;
                    }
                }
            }
            if (firstMatchIndex === -1) {
                return text.length > 80 ? `${text.slice(0, 80)}…` : text;
            }
            const start = Math.max(0, firstMatchIndex - 30);
            const end = Math.min(text.length, firstMatchIndex + matchedTerm.length + 30);
            let snippet = text.slice(start, end);
            if (start > 0) snippet = `…${snippet}`;
            if (end < text.length) snippet += '…';
            const regex = new RegExp(`(${terms.map(escapeRegExp).join('|')})`, 'gi');
            return snippet.replace(regex, '<mark class="search-highlight">$1</mark>');
        }
        
        function clearSearchHighlight() {
            const activeSlide = document.querySelector('.slide.active');
            if (!activeSlide) return;
            const highlights = activeSlide.querySelectorAll('.search-highlight');
            highlights.forEach((highlight) => {
                const textNode = document.createTextNode(highlight.textContent || '');
                const parent = highlight.parentNode;
                if (!parent) return;
                parent.replaceChild(textNode, highlight);
                parent.normalize();
            });
        }
        
        function applySearchHighlight() {
            if (!currentSearchTerm || !searchTerms.length) return;
            const activeSlide = document.querySelector('.slide.active');
            if (!activeSlide) return;
            const regex = new RegExp(`(${searchTerms.map(escapeRegExp).join('|')})`, 'gi');
            const walker = document.createTreeWalker(activeSlide, NodeFilter.SHOW_TEXT, {
                acceptNode(node) {
                    if (!node.parentElement) return NodeFilter.FILTER_REJECT;
                    if (node.parentElement.closest('.search-highlight')) return NodeFilter.FILTER_REJECT;
                    if (!node.textContent.trim()) return NodeFilter.FILTER_SKIP;
                    return regex.test(node.textContent) ? NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_SKIP;
                }
            });
            
            const nodesToHighlight = [];
            let currentNode;
            while ((currentNode = walker.nextNode())) {
                nodesToHighlight.push(currentNode);
                regex.lastIndex = 0;
            }
            
            nodesToHighlight.forEach((node) => {
                const text = node.textContent;
                if (!text) return;
                regex.lastIndex = 0;
                const fragment = document.createDocumentFragment();
                let lastIndex = 0;
                let match;
                while ((match = regex.exec(text)) !== null) {
                    if (match.index > lastIndex) {
                        fragment.appendChild(document.createTextNode(text.slice(lastIndex, match.index)));
                    }
                    const mark = document.createElement('span');
                    mark.className = 'search-highlight';
                    mark.textContent = text.slice(match.index, regex.lastIndex);
                    fragment.appendChild(mark);
                    lastIndex = regex.lastIndex;
                }
                if (lastIndex < text.length) {
                    fragment.appendChild(document.createTextNode(text.slice(lastIndex)));
                }
                node.parentNode.replaceChild(fragment, node);
            });
        }
        
        if (bookmarkToggleBtn) {
            bookmarkToggleBtn.addEventListener('click', toggleBookmark);
        }
        if (bookmarkPanelToggleBtn) {
            bookmarkPanelToggleBtn.addEventListener('click', () => toggleBookmarkPanel());
        }
        if (bookmarkPanelCloseBtn) {
            bookmarkPanelCloseBtn.addEventListener('click', () => toggleBookmarkPanel(false));
        }
        if (bookmarkListEl) {
            bookmarkListEl.addEventListener('click', (event) => {
                const removeButton = event.target.closest('[data-remove]');
                if (removeButton) {
                    event.stopPropagation();
                    const slideIndex = Number(removeButton.dataset.remove);
                    bookmarks.delete(slideIndex);
                    saveBookmarks();
                    renderBookmarkList();
                    updateBookmarkUI();
                    return;
                }
                
                const item = event.target.closest('.bookmark-item');
                if (item) {
                    const slideIndex = Number(item.dataset.slide);
                    toggleBookmarkPanel(false);
                    jumpToSlide(slideIndex);
                }
            });
        }
        if (notesToggleBtn) {
            notesToggleBtn.addEventListener('click', () => toggleNotesPanel());
        }
        if (notesCloseBtn) {
            notesCloseBtn.addEventListener('click', () => toggleNotesPanel(false));
        }
        if (notesTextareaEl) {
            notesTextareaEl.addEventListener('input', handleNotesInput);
        }
        if (notesClearBtn) {
            notesClearBtn.addEventListener('click', clearNotes);
        }
        if (achievementCloseBtn) {
            achievementCloseBtn.addEventListener('click', hideAchievementModal);
        }
        if (pathSelectorEl) {
            pathSelectorEl.addEventListener('change', (event) => {
                setLearningPath(event.target.value);
            });
        }
        if (searchInputEl) {
            searchInputEl.addEventListener('input', handleSearchInput);
            searchInputEl.addEventListener('keydown', handleSearchKeyDown);
            searchInputEl.addEventListener('focus', () => {
                if (searchResultsEl && searchResults.length) {
                    searchResultsEl.classList.add('active');
                }
            });
        }
        if (historyToggleBtn) {
            historyToggleBtn.addEventListener('click', () => toggleHistoryPanel());
        }
        if (historyCloseBtn) {
            historyCloseBtn.addEventListener('click', () => toggleHistoryPanel(false));
        }
        if (historyListEl) {
            historyListEl.addEventListener('click', (event) => {
                const targetItem = event.target.closest('.history-item');
                if (!targetItem) return;
                const slideIndex = Number(targetItem.dataset.slide);
                if (Number.isNaN(slideIndex)) return;
                toggleHistoryPanel(false);
                jumpToSlide(slideIndex);
            });
        }
        if (themeToggleBtn) {
            themeToggleBtn.addEventListener('click', cycleTheme);
        }
        // ctaRestart и ctaDownload инициализируются ПОСЛЕ создания слайдов (см. строку после initPresentation())
        
        document.addEventListener('click', (event) => {
            if (searchContainerEl && !searchContainerEl.contains(event.target)) {
                closeSearchResults();
            }
            if (bookmarkPanelEl && bookmarkPanelEl.classList.contains('active')) {
                const toggleContains = bookmarkPanelToggleBtn ? bookmarkPanelToggleBtn.contains(event.target) : false;
                if (!bookmarkPanelEl.contains(event.target) && !toggleContains) {
                    toggleBookmarkPanel(false);
                }
            }
            if (notesPanelEl && notesPanelEl.classList.contains('active')) {
                const toggleContainsNotes = notesToggleBtn ? notesToggleBtn.contains(event.target) : false;
                if (!notesPanelEl.contains(event.target) && !toggleContainsNotes) {
                    toggleNotesPanel(false);
                }
            }
            if (historyPanelEl && historyPanelEl.classList.contains('active')) {
                const toggleContainsHistory = historyToggleBtn ? historyToggleBtn.contains(event.target) : false;
                if (!historyPanelEl.contains(event.target) && !toggleContainsHistory) {
                    toggleHistoryPanel(false);
                }
            }
        });
        
        // Fullscreen toggle
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.log(`Error attempting to enable fullscreen: ${err.message}`);
                });
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                }
            }
        }
        
        // Export to PDF - Print all slides
        function exportToPDF() {
            // Show instruction dialog
            const exportMessage = [
                `📄 ЭКСПОРТ ВСЕХ ${fullSlidesCount} СЛАЙДОВ В PDF`,
                '━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━',
                '📋 ИНСТРУКЦИЯ:',
                '1️⃣ Откроется диалог печати браузера',
                '2️⃣ В поле "Принтер" выберите:\n   • "Сохранить как PDF" (Chrome/Edge)\n   • "Microsoft Print to PDF" (Firefox)',
                '3️⃣ Настройки:\n   • Ориентация: АЛЬБОМНАЯ\n   • Страницы: ВСЕ\n   • Масштаб: По умолчанию',
                '4️⃣ Нажмите "Сохранить"',
                `✅ Результат: PDF со всеми ${fullSlidesCount} слайдами`,
                'Продолжить?'
            ].join('\n\n');
            
            const userConfirmed = confirm(exportMessage);
            
            if (!userConfirmed) {
                return;
            }
            
            // Prepare all slides for printing
            const slides = document.querySelectorAll('.slide');
            const navigation = document.querySelector('.navigation');
            const exportBtn = document.querySelector('.export-btn');
            const fullscreenBtn = document.querySelector('.fullscreen-btn');
            const progressBar = document.querySelector('.progress-bar-container');
            
            // Store original states
            const originalStates = Array.from(slides).map(s => s.style.display);
            
            // Prepare all slides for printing
            slides.forEach((slide, index) => {
                // Make all slides visible
                slide.style.display = 'block';
                slide.style.opacity = '1';
                slide.style.position = 'static';
                slide.style.pageBreakAfter = 'always';
                slide.style.pageBreakInside = 'avoid';
                slide.style.width = '100%';
                slide.style.maxWidth = '277mm';
                slide.style.height = 'auto';
                slide.style.maxHeight = '190mm';
                slide.style.padding = '15mm';
                slide.style.margin = '0 auto';
                slide.style.overflow = 'hidden';
                slide.style.boxSizing = 'border-box';
                
                // Remove active class from all
                slide.classList.remove('active');
                
                // Remove page break from last slide
                if (index === slides.length - 1) {
                    slide.style.pageBreakAfter = 'auto';
                }
            });
            
            // Hide navigation elements
            if (navigation) navigation.style.display = 'none';
            if (exportBtn) exportBtn.style.display = 'none';
            if (fullscreenBtn) fullscreenBtn.style.display = 'none';
            if (progressBar) progressBar.style.display = 'none';
            
            // Make container static for printing
            const container = document.querySelector('.slide-container');
            const presentation = document.querySelector('.presentation');
            const originalContainerPosition = container ? container.style.position : '';
            const originalPresentationHeight = presentation ? presentation.style.height : '';
            
            if (container) {
                container.style.position = 'static';
                container.style.overflow = 'visible';
                container.style.height = 'auto';
            }
            if (presentation) {
                presentation.style.height = 'auto';
            }
            
            // Small delay to ensure rendering
            setTimeout(() => {
                // Trigger print dialog
                window.print();
                
                // Restore original state after print dialog
                setTimeout(() => {
                    // Restore all slides
                    slides.forEach((slide, index) => {
                        slide.style.display = originalStates[index];
                        slide.style.opacity = '';
                        slide.style.position = '';
                        slide.style.pageBreakAfter = '';
                        slide.style.pageBreakInside = '';
                        slide.style.width = '';
                        slide.style.maxWidth = '';
                        slide.style.height = '';
                        slide.style.maxHeight = '';
                        slide.style.padding = '';
                        slide.style.margin = '';
                        slide.style.overflow = '';
                        slide.style.boxSizing = '';
                        
                        // Restore active class to current slide
                        if (index === currentSlide) {
                            slide.classList.add('active');
                        }
                    });
                    
                    // Restore container
                    if (container) {
                        container.style.position = originalContainerPosition;
                        container.style.overflow = '';
                        container.style.height = '';
                    }
                    if (presentation) {
                        presentation.style.height = originalPresentationHeight;
                    }
                    
                    // Restore navigation
                    if (navigation) navigation.style.display = '';
                    if (exportBtn) exportBtn.style.display = '';
                    if (fullscreenBtn) fullscreenBtn.style.display = '';
                    if (progressBar) progressBar.style.display = '';
                }, 500);
            }, 300);
        }
        
        // Fallback: Simple print function
        function printToPDF() {
            const slides = document.querySelectorAll('.slide');
            slides.forEach(slide => {
                slide.style.display = 'block';
                slide.style.opacity = '1';
            });
            
            window.print();
            
            setTimeout(() => {
                slides.forEach((slide, index) => {
                    if (index !== currentSlide) {
                        slide.style.display = '';
                        slide.style.opacity = '';
                    }
                });
            }, 100);
        }
        
        // Touch/Swipe navigation for mobile
        let touchStartX = 0;
        let touchEndX = 0;
        let touchStartY = 0;
        let touchEndY = 0;
        
        document.addEventListener('touchstart', (e) => {
            touchStartX = e.changedTouches[0].screenX;
            touchStartY = e.changedTouches[0].screenY;
        }, { passive: true });
        
        document.addEventListener('touchend', (e) => {
            touchEndX = e.changedTouches[0].screenX;
            touchEndY = e.changedTouches[0].screenY;
            handleSwipe();
        }, { passive: true });
        
        function handleSwipe() {
            const swipeThreshold = 50;
            const horizontalSwipe = Math.abs(touchEndX - touchStartX);
            const verticalSwipe = Math.abs(touchEndY - touchStartY);
            
            // Only trigger if horizontal swipe is more significant than vertical
            if (horizontalSwipe > verticalSwipe && horizontalSwipe > swipeThreshold) {
                if (touchEndX < touchStartX) {
                    // Swipe left - next slide
                    changeSlide(1);
                }
                if (touchEndX > touchStartX) {
                    // Swipe right - previous slide
                    changeSlide(-1);
                }
            }
        }
        
        // Show swipe hint on mobile devices
        function showSwipeHint() {
            if (window.innerWidth <= 768 && currentSlide === 0) {
                const hint = document.createElement('div');
                hint.className = 'swipe-hint';
                hint.textContent = '← Свайп для навигации →';
                document.body.appendChild(hint);
                
                setTimeout(() => {
                    hint.remove();
                }, 3000);
            }
        }
        
        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'k') {
                e.preventDefault();
                if (searchInputEl) {
                    searchInputEl.focus();
                    searchInputEl.select();
                }
                return;
            }
            if (e.key === 'Escape') {
                toggleBookmarkPanel(false);
                toggleNotesPanel(false);
                toggleHistoryPanel(false);
                clearSearch();
                hideAchievementModal();
            }
            if (e.key === 'ArrowRight') changeSlide(1);
            if (e.key === 'ArrowLeft') changeSlide(-1);
            if (e.key === 'f' || e.key === 'F') toggleFullscreen();
            if (e.key === 'p' || e.key === 'P') {
                e.preventDefault();
                exportToPDF();
            }
            // Ctrl+P for browser print as fallback
            if (e.ctrlKey && e.key === 'p') {
                e.preventDefault();
                printToPDF();
            }
        });
        
        // Initialize on load
        console.log('=== Начало инициализации презентации ===');
        console.log('DOM ready state:', document.readyState);
        console.log('Проверка наличия slideContainer:', !!document.getElementById('slideContainer'));
        console.log('Проверка наличия modelSelector:', !!document.getElementById('modelSelector'));
        
        initPresentation();
        renderTimeline();
        renderBookmarkList();
        updateBookmarkUI();
        syncNotesPanel();
        updatePathSelectorOptions();
        setLearningPath(activeLearningPath, { skipNavigationUpdate: true });
        updateNavigation();
        activateSlide(currentSlide);
        console.log('Текущий слайд после инициализации:', currentSlide);
        initializeTheme(); // Инициализация темы ПОСЛЕ объявления всех переменных
        
        // ========== Quiz Functions ==========
        function initQuiz() {
            console.log('Инициализация квиза...');
            renderQuizQuestion();
            setupQuizEventListeners();
        }

        function renderQuizQuestion() {
            const questionContainer = document.getElementById('quizQuestion');
            const progressText = document.getElementById('quizProgressText');
            const progressFill = document.getElementById('quizProgressFill');
            const prevBtn = document.getElementById('quizPrevBtn');
            const nextBtn = document.getElementById('quizNextBtn');

            if (!questionContainer || !progressText || !nextBtn) return;

            const question = quizData.questions[quizState.currentQuestion];
            const progressPercent = ((quizState.currentQuestion + 1) / quizData.questions.length) * 100;

            progressText.textContent = `Вопрос ${quizState.currentQuestion + 1} из ${quizData.questions.length}`;
            if (progressFill) {
                progressFill.style.width = `${progressPercent}%`;
            }

            questionContainer.innerHTML = `
                <div class="question-content">
                    <h3>${question.question}</h3>
                    <div class="question-options">
                        ${question.options.map((option, index) => `
                            <label class="option-item">
                                <input type="radio" name="quizOption" value="${option.value}" ${quizState.answers[quizState.currentQuestion] === option.value ? 'checked' : ''}>
                                <span class="option-number">${String.fromCharCode(65 + index)}</span>
                                <span class="option-text">${option.text}</span>
                            </label>
                        `).join('')}
                    </div>
                </div>
            `;

            // Управление кнопками
            if (prevBtn) {
                prevBtn.style.display = quizState.currentQuestion > 0 ? 'inline-block' : 'none';
            }

            if (nextBtn) {
                const selectedOption = document.querySelector('input[name="quizOption"]:checked');
                nextBtn.disabled = !selectedOption;
                nextBtn.textContent = quizState.currentQuestion === quizData.questions.length - 1 ? 'Завершить квиз' : 'Далее →';
            }
        }

        function setupQuizEventListeners() {
            const nextBtn = document.getElementById('quizNextBtn');
            const prevBtn = document.getElementById('quizPrevBtn');

            if (nextBtn) {
                nextBtn.addEventListener('click', nextQuizQuestion);
            }

            if (prevBtn) {
                prevBtn.addEventListener('click', prevQuizQuestion);
            }

            // Обработчик изменения выбора
            document.addEventListener('change', function(e) {
                if (e.target.name === 'quizOption') {
                    const nextBtn = document.getElementById('quizNextBtn');
                    if (nextBtn) {
                        nextBtn.disabled = false;
                    }
                }
            });
        }

        function nextQuizQuestion() {
            const selectedOption = document.querySelector('input[name="quizOption"]:checked');
            if (!selectedOption) return;

            // Сохраняем ответ
            quizState.answers[quizState.currentQuestion] = selectedOption.value;

            if (quizState.currentQuestion < quizData.questions.length - 1) {
                quizState.currentQuestion++;
                renderQuizQuestion();
            } else {
                showQuizResults();
            }
        }

        function prevQuizQuestion() {
            if (quizState.currentQuestion > 0) {
                quizState.currentQuestion--;
                renderQuizQuestion();
            }
        }

        function showQuizResults() {
            quizState.completed = true;

            const profile = analyzeQuizResults();
            const recommendations = generateQuizRecommendations(profile);

            const resultsContainer = document.getElementById('quizResults');
            const profileContainer = document.getElementById('quizProfile');
            const recommendationsContainer = document.getElementById('quizRecommendations');

            if (profileContainer) {
                profileContainer.innerHTML = `
                    <div class="quiz-profile-card">
                        <h4>${profile.name}</h4>
                        <p>${profile.description}</p>
                    </div>
                `;
            }

            if (recommendationsContainer) {
                recommendationsContainer.innerHTML = `
                    <h4>Рекомендованные модели для вас:</h4>
                    <div class="recommended-models">
                        ${recommendations.map((model, index) => `
                            <div class="model-recommendation">
                                <div class="model-number">${index + 1}</div>
                                <div class="model-info">
                                    <h5>${model.name}</h5>
                                    <p>Рекомендовано: ${model.sources.join(', ')}</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            // Скрываем вопросы и показываем результаты
            document.querySelector('.quiz-tool .quiz-question')?.style.setProperty('display', 'none');
            document.querySelector('.quiz-tool .quiz-navigation')?.style.setProperty('display', 'none');

            if (resultsContainer) {
                resultsContainer.style.display = 'block';
            }
        }

        function analyzeQuizResults() {
            const answers = quizState.answers;

            // Простая логика определения профиля на основе ответов
            const experience = answers[0]; // Опыт
            const approach = answers[2]; // Подход
            const focus = answers[3]; // Фокус

            if (experience === 'beginner' || experience === 'intermediate') {
                if (approach === 'structured' || approach === 'hybrid') {
                    return quizData.profiles.beginner_structured;
                } else {
                    return quizData.profiles.intermediate_hybrid;
                }
            } else {
                if (focus === 'technical') {
                    return quizData.profiles.technical_focused;
                } else {
                    return quizData.profiles.expert_situational;
                }
            }
        }

        function generateQuizRecommendations(profile) {
            return profile.recommendedModels.map(model => ({
                name: model.name,
                sources: model.sources
            }));
        }

        function confirmResetQuiz() {
            if (confirm('Вы уверены, что хотите сбросить результаты квиза и пройти его заново? Ваши предыдущие ответы и результаты будут удалены.')) {
                resetQuiz();
            }
        }

        function resetQuiz() {
            // Сбрасываем состояние квиза
            quizState.currentQuestion = 0;
            quizState.answers = [];
            quizState.completed = false;

            // Очищаем сохраненные результаты из localStorage
            localStorage.removeItem('quizProfile');

            // Скрываем результаты и показываем вопросы
            document.querySelector('.quiz-tool .quiz-results')?.style.setProperty('display', 'none');
            document.querySelector('.quiz-tool .quiz-question')?.style.setProperty('display', 'block');
            document.querySelector('.quiz-tool .quiz-navigation')?.style.setProperty('display', 'flex');

            // Очищаем содержимое результатов
            const resultsContainer = document.getElementById('quizResults');
            const profileContainer = document.getElementById('quizProfile');
            const recommendationsContainer = document.getElementById('quizRecommendations');

            if (profileContainer) profileContainer.innerHTML = '';
            if (recommendationsContainer) recommendationsContainer.innerHTML = '';
            if (resultsContainer) resultsContainer.style.display = 'none';

            // Перерисовываем первый вопрос
            renderQuizQuestion();
        }

        function exportQuizResults() {
            const profile = analyzeQuizResults();
            const recommendations = generateQuizRecommendations(profile);

            const reportWindow = window.open('', '_blank');
            reportWindow.document.write(`
                <!DOCTYPE html>
                <html lang="ru">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Результаты квиза - Профиль управления изменениями</title>
                    <style>
                        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
                        h1 { color: #2DB67D; border-bottom: 3px solid #2DB67D; padding-bottom: 10px; }
                        h2 { color: #333; margin-top: 30px; }
                        .profile { background: #f5f5f5; padding: 20px; border-radius: 8px; margin: 20px 0; }
                        .recommendations { margin: 20px 0; }
                        .model-item { background: white; padding: 15px; margin: 10px 0; border-radius: 6px; border-left: 4px solid #2DB67D; }
                        .sources { color: #666; font-size: 14px; margin-top: 5px; }
                        .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; text-align: center; color: #666; }
                    </style>
                </head>
                <body>
                    <h1>Результаты квиза: Профиль управления изменениями</h1>
                    <p><strong>Дата анализа:</strong> ${new Date().toLocaleDateString('ru-RU', { year: 'numeric', month: 'long', day: 'numeric' })}</p>

                    <div class="profile">
                        <h2>Ваш профиль</h2>
                        <p><strong>${profile.name}</strong></p>
                        <p>${profile.description}</p>
                    </div>

                    <h2>Рекомендованные модели</h2>
                    <div class="recommendations">
                        ${recommendations.map((model, index) => `
                            <div class="model-item">
                                <h3>${index + 1}. ${model.name}</h3>
                                <div class="sources">Рекомендовано: ${model.sources.join(', ')}</div>
                            </div>
                        `).join('')}
                    </div>

                    <div class="footer">
                        <p>Анализ создан с помощью интерактивного квиза</p>
                        <p>Автор: Dmitry Vladimirov | LinkedIn: www.linkedin.com/in/dmitry-vladimirov-cdto</p>
                    </div>
                </body>
                </html>
            `);
            reportWindow.document.close();

            setTimeout(() => {
                reportWindow.print();
            }, 500);
        }

        // Синхронизация результатов квиза с инструментом выбора моделей
        function syncQuizWithModelSelector() {
            try {
                const savedProfile = localStorage.getItem('quizProfile');
                if (savedProfile) {
                    const profileData = JSON.parse(savedProfile);
                    // Сохраняем рекомендации квиза для инструмента выбора
                    localStorage.setItem('quizRecommendations', JSON.stringify(profileData.recommendedModels || []));

                    console.log('✓ Результаты квиза синхронизированы с инструментом выбора моделей');
                }
            } catch (error) {
                console.warn('Не удалось синхронизировать результаты квиза:', error);
            }
        }

        // Инициализация PCT инструмента
        initPCT();
        console.log('✓ PCT инструмент инициализирован');

        // Инициализация ROI калькулятора
        initROICalculator();
        console.log('✓ ROI калькулятор инициализирован');

        // Инициализация диагностики готовности
        initReadinessAssessment();
        console.log('✓ Диагностика готовности инициализирована');

        // Инициализация конструктора гибридных моделей
        initHybridConstructor();
        console.log('✓ Конструктор гибридных моделей инициализирован');

        // Инициализация квиза
        initQuiz();
        console.log('✓ Квиз инициализирован');

        // ========== Model Selector Tool Functions ==========

        // Переменные состояния model selector
        let allModels = [];
        let filteredModels = [];
        let selectedModels = [];
        let currentSortColumn = 'name';
        let currentSortDirection = 'asc';
        let activeFilters = {};

        // Матрица выбора - состояние
        let matrixSelections = {
            scale: null,
            speed: null
        };

        // Инициализация model selector
        function initModelSelector() {
            console.log('Инициализация Model Selector...');

            // Собираем все модели
            allModels = [...classicalModels, ...newModels];
            filteredModels = [...allModels];

            // Инициализируем UI
            setupModelSelectorEventListeners();
            buildModelsComparisonTable();
            handleResponsiveTableView();

            // Добавляем обработчик изменения размера окна
            window.addEventListener('resize', handleResponsiveTableView);

            console.log('✓ Model Selector инициализирован');
        }

        // Настройка обработчиков событий
        function setupModelSelectorEventListeners() {
            // Табы режимов
            document.querySelectorAll('.mode-tab').forEach(tab => {
                tab.addEventListener('click', () => switchSelectorMode(tab.dataset.mode));
            });

            // Поиск
            const searchInput = document.getElementById('modelSearchInput');
            if (searchInput) {
                searchInput.addEventListener('input', (e) => {
                    searchModels(e.target.value);
                });
            }

            // Фильтры
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', () => toggleFilter(btn));
            });

            // Сброс фильтров
            const resetBtn = document.getElementById('resetFiltersBtn');
            if (resetBtn) {
                resetBtn.addEventListener('click', resetFilters);
            }

            // Сортировка по заголовкам таблицы
            document.querySelectorAll('.model-comparison-table th[data-sort]').forEach(th => {
                th.addEventListener('click', () => sortModelsTable(th.dataset.sort));
            });

            // Выбор моделей
            document.addEventListener('change', (e) => {
                if (e.target.classList.contains('model-select-checkbox')) {
                    toggleModelSelection(e.target.dataset.modelName, e.target.checked);
                }
            });

            // Управление выбранными моделями
            const clearBtn = document.getElementById('clearSelectionBtn');
            if (clearBtn) {
                clearBtn.addEventListener('click', clearModelSelection);
            }

            const compareBtn = document.getElementById('compareModelsBtn');
            if (compareBtn) {
                compareBtn.addEventListener('click', showDetailedComparison);
            }

            // Матрица выбора
            document.querySelectorAll('.matrix-parameter').forEach(param => {
                param.addEventListener('click', () => selectMatrixParameter(param));
                // Клавиатурная навигация
                param.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        selectMatrixParameter(param);
                    }
                });
                param.setAttribute('tabindex', '0');
            });

            const restartMatrixBtn = document.getElementById('restartMatrixBtn');
            if (restartMatrixBtn) {
                restartMatrixBtn.addEventListener('click', restartMatrixSelection);
            }

            // Добавляем обработчики для чекбоксов таблицы с клавиатурной поддержкой
            document.addEventListener('keydown', (e) => {
                if (e.target.classList.contains('model-select-checkbox')) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        e.target.click();
                    }
                }
            });

            // Добавляем обработчики для кнопок фильтров с клавиатурной поддержкой
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        btn.click();
                    }
                });
                btn.setAttribute('tabindex', '0');
            });
        }

        // Переключение режимов (Таблица/Матрица)
        function switchSelectorMode(mode) {
            // Обновляем активный таб
            document.querySelectorAll('.mode-tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.mode === mode);
            });

            // Показываем соответствующий контент
            const tableContent = document.getElementById('tableModeContent');
            const matrixContent = document.getElementById('matrixModeContent');

            if (mode === 'table') {
                tableContent.style.display = 'block';
                matrixContent.style.display = 'none';
            } else {
                tableContent.style.display = 'none';
                matrixContent.style.display = 'block';
                // Сбрасываем матрицу при переключении
                restartMatrixSelection();
            }

            // Сохраняем режим
            localStorage.setItem('modelSelectorMode', mode);
        }

        // Построение таблицы сравнения
        function buildModelsComparisonTable() {
            const tbody = document.getElementById('modelsTableBody');
            if (!tbody) return;

            tbody.innerHTML = '';

            filteredModels.forEach(model => {
                const isSelected = selectedModels.includes(model.name);

                const row = document.createElement('tr');
                row.className = isSelected ? 'selected' : '';

                row.innerHTML = `
                    <td>
                        <div class="model-name">${model.name}</div>
                        <div class="model-type ${model.type.replace(/\s+/g, '')}">${model.type}</div>
                    </td>
                    <td>${model.type}</td>
                    <td><span class="complexity-badge ${model.complexity}" title="${getComplexityTooltip(model.complexity)}">${model.complexity}</span></td>
                    <td><span class="scale-badge ${model.scale}" title="${getScaleTooltip(model.scale)}">${model.scale}</span></td>
                    <td><span class="duration-badge" title="Ориентировочный срок внедрения">${model.duration}</span></td>
                    <td><span class="focus-badge ${model.focus}" title="${getFocusTooltip(model.focus)}">${model.focus}</span></td>
                    <td>
                        <input type="checkbox"
                               class="model-select-checkbox"
                               data-model-name="${model.name}"
                               ${isSelected ? 'checked' : ''}
                               ${selectedModels.length >= 3 && !isSelected ? 'disabled' : ''}>
                    </td>
                `;

                tbody.appendChild(row);
            });

            // Обновляем счетчик в заголовке
            updateTableHeader();
        }

        // Обновление заголовка таблицы с информацией о фильтрах
        function updateTableHeader() {
            const header = document.querySelector('.comparison-table-wrapper');
            if (!header) return;

            let filterText = '';
            const activeFilterCount = Object.values(activeFilters).filter(arr => arr.length > 0).length;

            if (activeFilterCount > 0) {
                filterText = ` (применено ${activeFilterCount} фильтр${activeFilterCount === 1 ? '' : activeFilterCount < 5 ? 'а' : 'ов'})`;
            }

            // Можно добавить информационный текст в заголовок таблицы
            const infoText = `Показаны ${filteredModels.length} из ${allModels.length} моделей${filterText}`;
            // Для простоты оставим как есть, но в будущем можно добавить элемент для отображения
        }

        // Функции для генерации подсказок
        function getComplexityTooltip(complexity) {
            const tooltips = {
                'Низкая': 'Простая в реализации, минимум ресурсов, подходит для начинающих',
                'Средняя': 'Умеренная сложность, требует базовой подготовки команды',
                'Высокая': 'Сложная модель, требует экспертизы и значительных ресурсов'
            };
            return tooltips[complexity] || complexity;
        }

        function getScaleTooltip(scale) {
            const tooltips = {
                'Малый': 'Команда или отдел, локальные процессы',
                'Средний': 'Несколько отделов, кросс-функциональные процессы',
                'Крупный': 'Вся организация или холдинг'
            };
            return tooltips[scale] || scale;
        }

        function getFocusTooltip(focus) {
            const tooltips = {
                'Люди': 'Фокус на эмоциональном состоянии, сопротивлении изменениям',
                'Процессы': 'Фокус на оптимизации бизнес-процессов и рабочих процедур',
                'Стратегия': 'Фокус на видении, планировании и организационной структуре',
                'Культура': 'Фокус на ценностях, нормах и организационной культуре'
            };
            return tooltips[focus] || focus;
        }

        // Функция для создания мобильной карточной версии
        function buildMobileModelCards() {
            let container = document.querySelector('.comparison-cards-mobile');
            if (!container) {
                container = document.createElement('div');
                container.className = 'comparison-cards-mobile';
                document.querySelector('.comparison-table-wrapper').parentNode.insertBefore(container, document.querySelector('.comparison-table-wrapper').nextSibling);
            }

            container.innerHTML = '';

            filteredModels.forEach(model => {
                const isSelected = selectedModels.includes(model.name);

                const card = document.createElement('div');
                card.className = `mobile-model-card ${isSelected ? 'selected' : ''}`;

                card.innerHTML = `
                    <h4>${model.name}</h4>
                    <div class="mobile-model-card-row">
                        <span class="mobile-model-card-label">Тип:</span>
                        <span class="mobile-model-card-value">${model.type}</span>
                    </div>
                    <div class="mobile-model-card-row">
                        <span class="mobile-model-card-label">Сложность:</span>
                        <span class="mobile-model-card-value">${model.complexity}</span>
                    </div>
                    <div class="mobile-model-card-row">
                        <span class="mobile-model-card-label">Масштаб:</span>
                        <span class="mobile-model-card-value">${model.scale}</span>
                    </div>
                    <div class="mobile-model-card-row">
                        <span class="mobile-model-card-label">Срок:</span>
                        <span class="mobile-model-card-value">${model.duration}</span>
                    </div>
                    <div class="mobile-model-card-row">
                        <span class="mobile-model-card-label">Фокус:</span>
                        <span class="mobile-model-card-value">${model.focus}</span>
                    </div>
                `;

                card.addEventListener('click', () => {
                    toggleModelSelection(model.name, !selectedModels.includes(model.name));
                    // Обновляем карточку
                    buildMobileModelCards();
                });

                container.appendChild(card);
            });
        }

        // Адаптивное переключение между таблицей и карточками
        function handleResponsiveTableView() {
            const isMobile = window.innerWidth <= 640;
            const tableWrapper = document.querySelector('.comparison-table-wrapper');
            const cardsContainer = document.querySelector('.comparison-cards-mobile');

            if (isMobile) {
                if (tableWrapper) tableWrapper.style.display = 'none';
                if (cardsContainer) cardsContainer.style.display = 'block';
                buildMobileModelCards();
            } else {
                if (tableWrapper) tableWrapper.style.display = 'block';
                if (cardsContainer) cardsContainer.style.display = 'none';
            }
        }

        // Переключение фильтра
        function toggleFilter(button) {
            const filterType = button.dataset.filter;
            const filterValue = button.dataset.value;

            if (!activeFilters[filterType]) {
                activeFilters[filterType] = [];
            }

            const index = activeFilters[filterType].indexOf(filterValue);
            if (index > -1) {
                activeFilters[filterType].splice(index, 1);
            } else {
                activeFilters[filterType].push(filterValue);
            }

            button.classList.toggle('active');

            // Применяем фильтры
            applyFilters();

            // Сохраняем фильтры
            localStorage.setItem('modelSelectorFilters', JSON.stringify(activeFilters));
        }

        // Применение фильтров
        function applyFilters() {
            filteredModels = allModels.filter(model => {
                // Проверяем каждый активный фильтр
                for (const [filterType, values] of Object.entries(activeFilters)) {
                    if (values.length > 0 && !values.includes(model[filterType])) {
                        return false;
                    }
                }
                return true;
            });

            buildModelsComparisonTable();
        }

        // Поиск моделей
        function searchModels(query) {
            if (!query.trim()) {
                applyFilters();
                return;
            }

            const searchTerm = query.toLowerCase();
            filteredModels = allModels.filter(model =>
                model.name.toLowerCase().includes(searchTerm) ||
                model.type.toLowerCase().includes(searchTerm) ||
                model.description.toLowerCase().includes(searchTerm)
            );

            buildModelsComparisonTable();
        }

        // Сброс всех фильтров
        function resetFilters() {
            activeFilters = {};
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));

            const searchInput = document.getElementById('modelSearchInput');
            if (searchInput) searchInput.value = '';

            filteredModels = [...allModels];
            buildModelsComparisonTable();
        }

        // Сортировка таблицы
        function sortModelsTable(column) {
            if (currentSortColumn === column) {
                currentSortDirection = currentSortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                currentSortColumn = column;
                currentSortDirection = 'asc';
            }

            // Обновляем индикаторы сортировки
            document.querySelectorAll('.model-comparison-table th').forEach(th => {
                th.classList.remove('sort-asc', 'sort-desc');
            });

            const currentTh = document.querySelector(`.model-comparison-table th[data-sort="${column}"]`);
            if (currentTh) {
                currentTh.classList.add(`sort-${currentSortDirection}`);
            }

            // Сортируем модели
            filteredModels.sort((a, b) => {
                let aVal = a[column] || '';
                let bVal = b[column] || '';

                // Для некоторых колонок нужна специальная логика
                if (column === 'complexity') {
                    const order = { 'Низкая': 1, 'Средняя': 2, 'Высокая': 3 };
                    aVal = order[aVal] || 0;
                    bVal = order[bVal] || 0;
                } else if (column === 'scale') {
                    const order = { 'Малый': 1, 'Средний': 2, 'Крупный': 3 };
                    aVal = order[aVal] || 0;
                    bVal = order[bVal] || 0;
                }

                if (currentSortDirection === 'asc') {
                    return aVal > bVal ? 1 : aVal < bVal ? -1 : 0;
                } else {
                    return aVal < bVal ? 1 : aVal > bVal ? -1 : 0;
                }
            });

            buildModelsComparisonTable();
        }

        // Переключение выбора модели
        function toggleModelSelection(modelName, isSelected) {
            if (isSelected && selectedModels.length < 3) {
                selectedModels.push(modelName);
            } else if (!isSelected) {
                selectedModels = selectedModels.filter(name => name !== modelName);
            }

            // Обновляем чекбоксы (блокируем лишние)
            document.querySelectorAll('.model-select-checkbox').forEach(checkbox => {
                const isChecked = selectedModels.includes(checkbox.dataset.modelName);
                checkbox.checked = isChecked;
                checkbox.disabled = selectedModels.length >= 3 && !isChecked;
            });

            // Обновляем UI выбранных моделей
            updateSelectedModelsUI();

            // Сохраняем выбор
            localStorage.setItem('selectedModels', JSON.stringify(selectedModels));
        }

        // Обновление UI выбранных моделей
        function updateSelectedModelsUI() {
            const panel = document.getElementById('selectedModelsPanel');
            const list = document.getElementById('selectedModelsList');
            const compareBtn = document.getElementById('compareModelsBtn');

            if (selectedModels.length > 0) {
                panel.classList.add('show');

                list.innerHTML = selectedModels.map(modelName => {
                    const model = allModels.find(m => m.name === modelName);
                    return `
                        <div class="selected-model-item">
                            <div class="selected-model-name">${modelName}</div>
                            <button class="remove-model-btn" onclick="removeModelFromSelection('${modelName}')">×</button>
                        </div>
                    `;
                }).join('');

                if (selectedModels.length >= 2) {
                    compareBtn.style.display = 'block';
                } else {
                    compareBtn.style.display = 'none';
                }
            } else {
                panel.classList.remove('show');
                compareBtn.style.display = 'none';
            }
        }

        // Удаление модели из выбора
        function removeModelFromSelection(modelName) {
            selectedModels = selectedModels.filter(name => name !== modelName);
            updateSelectedModelsUI();

            // Обновляем чекбоксы
            const checkbox = document.querySelector(`.model-select-checkbox[data-model-name="${modelName}"]`);
            if (checkbox) {
                checkbox.checked = false;
                checkbox.disabled = false;
            }

            // Обновляем таблицу
            buildModelsComparisonTable();
        }

        // Очистка всего выбора
        function clearModelSelection() {
            selectedModels = [];
            updateSelectedModelsUI();

            // Снимаем все чекбоксы
            document.querySelectorAll('.model-select-checkbox').forEach(checkbox => {
                checkbox.checked = false;
                checkbox.disabled = false;
            });

            // Перестраиваем таблицу
            buildModelsComparisonTable();
        }

        // Показ детального сравнения выбранных моделей
        function showDetailedComparison() {
            if (selectedModels.length < 2) return;

            const models = selectedModels.map(name => allModels.find(m => m.name === name)).filter(Boolean);

            // Создаем модальное окно с детальным сравнением
            const modal = document.createElement('div');
            modal.className = 'modal-overlay';
            modal.innerHTML = `
                <div class="modal-content detailed-comparison-modal">
                    <div class="modal-header">
                        <h3>Детальное сравнение моделей</h3>
                        <button class="modal-close" onclick="this.closest('.modal-overlay').remove()">×</button>
                    </div>
                    <div class="modal-body">
                        <div class="comparison-grid">
                            ${models.map(model => `
                                <div class="comparison-card">
                                    <h4>${model.name}</h4>
                                    <div class="model-meta">
                                        <span class="model-type ${model.type.replace(/\s+/g, '')}">${model.type}</span>
                                        <span class="complexity-badge ${model.complexity}">${model.complexity}</span>
                                    </div>
                                    <div class="model-details">
                                        <p><strong>Масштаб:</strong> <span class="scale-badge ${model.scale}">${model.scale}</span></p>
                                        <p><strong>Срок:</strong> <span class="duration-badge">${model.duration}</span></p>
                                        <p><strong>Фокус:</strong> <span class="focus-badge ${model.focus}">${model.focus}</span></p>
                                        <p><strong>Разработчик:</strong> ${model.developer}</p>
                                        <p><strong>Применение:</strong> ${model.whenToUse}</p>
                                        <p><strong>Подходит для:</strong> ${model.bestFor}</p>
                                    </div>
                                    <button class="goto-model-btn" onclick="jumpToSlide(${findSlideIndexByKeyword(model.name.split(' ')[0].toLowerCase())}); this.closest('.modal-overlay').remove();">Перейти к модели</button>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;

            document.body.appendChild(modal);

            // Стили для модального окна (добавим в CSS выше)
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.remove();
            });
        }

        // Выбор параметра в матрице
        function selectMatrixParameter(param) {
            const step = parseInt(param.dataset.step);
            const value = param.dataset.value;

            // Снимаем выделение с других параметров в этом шаге
            document.querySelectorAll(`.matrix-parameter[data-step="${step}"]`).forEach(p => {
                p.classList.remove('selected');
            });

            // Выделяем выбранный параметр
            param.classList.add('selected');

            // Сохраняем выбор
            if (step === 1) {
                matrixSelections.scale = value;
            } else if (step === 2) {
                matrixSelections.speed = value;
            }

            // Если выбраны оба параметра, показываем рекомендации
            if (matrixSelections.scale && matrixSelections.speed) {
                const recommendations = calculateRecommendations(matrixSelections.scale, matrixSelections.speed);
                showMatrixRecommendations(recommendations);
            }

            // Сохраняем состояние матрицы
            localStorage.setItem('matrixSelections', JSON.stringify(matrixSelections));
        }

        // Расчет рекомендаций на основе выбранных параметров
        function calculateRecommendations(scale, speed) {
            const recommendationsMap = {
                // Малый масштаб
                'Малый-быстро': [
                    { name: 'PDCA Цикл', keyword: 'pdca', reason: 'Простой итеративный подход для быстрого тестирования идей' },
                    { name: 'Теория подталкивания', keyword: 'подталкивания', reason: 'Эффективные поведенческие изменения без сложных процессов' },
                    { name: 'R2P2', keyword: 'r2p2', reason: 'Быстрое вовлечение людей и получение результатов' }
                ],
                'Малый-средне': [
                    { name: 'ADKAR', keyword: 'адкар', reason: 'Структурированный подход к индивидуальным изменениям' },
                    { name: 'Модель Сатир', keyword: 'сатир', reason: 'Фокус на эмоциональном пути человека при изменениях' },
                    { name: 'Позитивное отклонение', keyword: 'отклонение', reason: 'Эксперименты с позитивными изменениями' }
                ],
                'Малый-долго': [
                    { name: 'Теория подталкивания', keyword: 'подталкивания', reason: 'Долгосрочные поведенческие изменения' },
                    { name: 'PDCA Цикл', keyword: 'pdca', reason: 'Постоянное улучшение с течением времени' },
                    { name: 'R2P2', keyword: 'r2p2', reason: 'Устойчивое вовлечение для долгосрочных изменений' }
                ],

                // Средний масштаб
                'Средний-быстро': [
                    { name: 'Модель Коттера', keyword: 'коттер', reason: 'Быстрое создание коалиции и видения изменений' },
                    { name: 'ADKAR', keyword: 'адкар', reason: 'Структурированная поддержка для команды среднего размера' },
                    { name: 'Переход Бриджеса', keyword: 'бриджес', reason: 'Помощь в эмоциональном переходе группы людей' }
                ],
                'Средний-средне': [
                    { name: 'Модель Коттера', keyword: 'коттер', reason: 'Комплексный подход к организационным изменениям' },
                    { name: 'ADKAR', keyword: 'адкар', reason: 'Индивидуальная готовность + организационная поддержка' },
                    { name: 'Переход Бриджеса', keyword: 'бриджес', reason: 'Эмоциональная поддержка в переходный период' }
                ],
                'Средний-долго': [
                    { name: 'Стандарт ACMP', keyword: 'acmp', reason: 'Профессиональный стандарт для комплексных изменений' },
                    { name: 'Гибридная модель', keyword: 'гибридная', reason: 'Комбинация подходов для устойчивых результатов' },
                    { name: 'Маур 3 уровня', keyword: 'маур', reason: 'Глубокие изменения в культуре и процессах' }
                ],

                // Крупный масштаб
                'Крупный-быстро': [
                    { name: 'Гибридная модель', keyword: 'гибридная', reason: 'Быстрая адаптация проверенных подходов' },
                    { name: 'Модель Коттера', keyword: 'коттер', reason: 'Создание мощной коалиции для быстрого старта' },
                    { name: 'Change Delta', keyword: 'delta', reason: 'Фокус на ключевых элементах для ускорения' }
                ],
                'Крупный-средне': [
                    { name: 'Стандарт ACMP', keyword: 'acmp', reason: 'Профессиональный подход к крупным изменениям' },
                    { name: 'Гибридная модель', keyword: 'гибридная', reason: 'Комбинированный подход для комплексности' },
                    { name: 'Маур 3 уровня', keyword: 'маур', reason: 'Системные изменения на всех уровнях организации' }
                ],
                'Крупный-долго': [
                    { name: 'Маур 3 уровня', keyword: 'маур', reason: 'Фундаментальные изменения в культуре и системах' },
                    { name: 'Гибридная модель', keyword: 'гибридная', reason: 'Долгосрочная трансформация с множеством элементов' },
                    { name: 'Стандарт ACMP', keyword: 'acmp', reason: 'Профессиональное управление комплексными изменениями' }
                ]
            };

            const key = `${scale}-${speed.charAt(0).toLowerCase()}${speed.slice(1).toLowerCase()}`;

            return recommendationsMap[key] || [
                { name: 'Модель Коттера', keyword: 'коттер', reason: 'Универсальный подход для большинства ситуаций' },
                { name: 'ADKAR', keyword: 'адкар', reason: 'Фокус на индивидуальной готовности к изменениям' },
                { name: 'Стандарт ACMP', keyword: 'acmp', reason: 'Профессиональный стандарт управления изменениями' }
            ];
        }

        // Отображение рекомендаций матрицы
        function showMatrixRecommendations(recommendations) {
            const container = document.getElementById('recommendedModelsList');
            if (!container) return;

            container.innerHTML = recommendations.map(rec => {
                const model = allModels.find(m => m.name.toLowerCase().includes(rec.keyword.toLowerCase()));
                const slideIndex = model ? findSlideIndexByKeyword(rec.keyword) : 65;

                return `
                    <div class="recommended-model">
                        <h5>${rec.name}</h5>
                        <p>${rec.reason}</p>
                        <span class="model-type ${model ? model.type.replace(/\s+/g, '') : 'Действенная'}">${model ? model.type : 'Рекомендованная'}</span>
                        <button class="goto-model-btn" onclick="jumpToSlide(${slideIndex})">Перейти к модели</button>
                    </div>
                `;
            }).join('');

            // Показываем панель рекомендаций
            const recommendationsPanel = document.getElementById('matrixRecommendations');
            if (recommendationsPanel) {
                recommendationsPanel.style.display = 'block';
                recommendationsPanel.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // Сброс выбора в матрице
        function restartMatrixSelection() {
            // Снимаем выделение со всех параметров
            document.querySelectorAll('.matrix-parameter').forEach(param => {
                param.classList.remove('selected');
            });

            // Сбрасываем состояние
            matrixSelections = { scale: null, speed: null };

            // Скрываем панель рекомендаций
            const recommendationsPanel = document.getElementById('matrixRecommendations');
            if (recommendationsPanel) {
                recommendationsPanel.style.display = 'none';
            }

            // Очищаем список рекомендаций
            const container = document.getElementById('recommendedModelsList');
            if (container) {
                container.innerHTML = '';
            }

            // Сохраняем пустое состояние
            localStorage.removeItem('matrixSelections');
        }

        // Восстановление состояния матрицы из localStorage
        function restoreMatrixState() {
            try {
                const saved = localStorage.getItem('matrixSelections');
                if (saved) {
                    matrixSelections = JSON.parse(saved);

                    // Восстанавливаем выделение параметров
                    if (matrixSelections.scale) {
                        const scaleParam = document.querySelector(`.matrix-parameter[data-step="1"][data-value="${matrixSelections.scale}"]`);
                        if (scaleParam) scaleParam.classList.add('selected');
                    }

                    if (matrixSelections.speed) {
                        const speedParam = document.querySelector(`.matrix-parameter[data-step="2"][data-value="${matrixSelections.speed}"]`);
                        if (speedParam) speedParam.classList.add('selected');
                    }

                    // Если выбраны оба параметра, показываем рекомендации
                    if (matrixSelections.scale && matrixSelections.speed) {
                        const recommendations = calculateRecommendations(matrixSelections.scale, matrixSelections.speed);
                        showMatrixRecommendations(recommendations);
                    }
                }
            } catch (error) {
                console.warn('Не удалось восстановить состояние матрицы:', error);
            }
        }

        // Восстановление состояния таблицы из localStorage
        function restoreTableState() {
            try {
                // Восстанавливаем фильтры
                const savedFilters = localStorage.getItem('modelSelectorFilters');
                if (savedFilters) {
                    activeFilters = JSON.parse(savedFilters);

                    // Применяем сохраненные фильтры к UI
                    Object.entries(activeFilters).forEach(([filterType, values]) => {
                        values.forEach(value => {
                            const btn = document.querySelector(`.filter-btn[data-filter="${filterType}"][data-value="${value}"]`);
                            if (btn) btn.classList.add('active');
                        });
                    });
                }

                // Восстанавливаем выбранные модели
                const savedModels = localStorage.getItem('selectedModels');
                if (savedModels) {
                    selectedModels = JSON.parse(savedModels);
                    updateSelectedModelsUI();
                }

                // Восстанавливаем режим
                const savedMode = localStorage.getItem('modelSelectorMode');
                if (savedMode && savedMode !== 'table') {
                    switchSelectorMode(savedMode);
                }
            } catch (error) {
                console.warn('Не удалось восстановить состояние таблицы:', error);
            }
        }

        // Показ рекомендаций из квиза
        function showQuizRecommendations() {
            try {
                const savedRecommendations = localStorage.getItem('quizRecommendations');
                if (savedRecommendations) {
                    const recommendations = JSON.parse(savedRecommendations);
                    if (recommendations.length > 0) {
                        // Создаем баннер с рекомендациями квиза
                        const banner = document.createElement('div');
                        banner.className = 'quiz-recommendations-banner';
                        banner.innerHTML = `
                            <div class="banner-header">
                                <h4>🎯 Рекомендации из вашего квиза</h4>
                                <button class="banner-close" onclick="this.closest('.quiz-recommendations-banner').remove()">×</button>
                            </div>
                            <div class="banner-content">
                                <p>На основе ваших ответов в квизе рекомендуем следующие модели:</p>
                                <div class="quiz-recommended-models">
                                    ${recommendations.slice(0, 3).map(model => `
                                        <div class="quiz-recommended-model" onclick="jumpToSlide(${findSlideIndexByKeyword(model.name.split(' ')[0].toLowerCase())})">
                                            <span class="model-name">${model.name}</span>
                                            <span class="model-sources">${model.sources.join(', ')}</span>
                                        </div>
                                    `).join('')}
                                </div>
                                <button class="panel-button" onclick="jumpToSlide(65)" style="margin-top: var(--space-12);">Пройти квиз заново →</button>
                            </div>
                        `;

                        // Добавляем баннер в начало инструмента
                        const toolContainer = document.querySelector('.model-selector-tool');
                        if (toolContainer) {
                            toolContainer.insertBefore(banner, toolContainer.firstChild);
                        }
                    }
                }
            } catch (error) {
                console.warn('Не удалось показать рекомендации квиза:', error);
            }
        }

        // Обновляем функцию initModelSelector для восстановления состояния
        function initModelSelector() {
            console.log('Инициализация Model Selector...');

            // Собираем все модели
            allModels = [...classicalModels, ...newModels];
            filteredModels = [...allModels];

            // Инициализируем UI
            setupModelSelectorEventListeners();
            buildModelsComparisonTable();

            // Восстанавливаем состояние
            restoreTableState();
            restoreMatrixState();

            // Показываем рекомендации из квиза
            showQuizRecommendations();

            console.log('✓ Model Selector инициализирован');
        }

        // Инициализация model selector
        initModelSelector();
        console.log('✓ Model Selector инструмент инициализирован');

        // Инициализация кнопок на последнем слайде (CTA) - ПОСЛЕ создания слайдов
        const ctaRestartBtn = document.getElementById('ctaRestart');
        if (ctaRestartBtn) {
            ctaRestartBtn.addEventListener('click', () => {
                console.log('Перезапуск презентации...');
                const slides = document.querySelectorAll('.slide');
                if (slides[currentSlide]) {
                    slides[currentSlide].classList.remove('active');
                }
                currentSlide = visibleSlides[0] ?? 0;
                if (slides[currentSlide]) {
                    slides[currentSlide].classList.add('active');
                    slides[currentSlide].scrollTop = 0;
                }
                toggleBookmarkPanel(false);
                toggleNotesPanel(false);
                toggleHistoryPanel(false);
                window.scrollTo({ top: 0, behavior: 'smooth' });
                updateNavigation();
            });
            console.log('✓ Кнопка "Перезапустить" инициализирована');
        } else {
            console.warn('⚠ Кнопка ctaRestart не найдена');
        }
        
        const ctaDownloadBtn = document.getElementById('ctaDownload');
        if (ctaDownloadBtn) {
            ctaDownloadBtn.addEventListener('click', () => {
                console.log('Запуск экспорта в PDF...');
                exportToPDF();
            });
            console.log('✓ Кнопка "Скачать PDF" инициализирована');
        } else {
            console.warn('⚠ Кнопка ctaDownload не найдена');
        }
        
        console.log('=== Инициализация завершена ===');
        
        // Show swipe hint after a short delay
        setTimeout(showSwipeHint, 1000);
    </script>
</body>
</html>